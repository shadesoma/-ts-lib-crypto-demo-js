!function(){var e=function(e){var t;return function(r){return t||e(t={exports:{},parent:r},t.exports),t.exports}},t=e(function(e,r){(function(e){"use strict";r.Buffer=e,r.INSPECT_MAX_BYTES=50;var t=2147483647;function n(r){if(r>t)throw new RangeError('The value "'+r+'" is invalid for option "size"');var n=new Uint8Array(r);return n.__proto__=e.prototype,n}function e(e,t,r){if("number"==typeof e){if("string"==typeof t)throw new TypeError('The "string" argument must be of type string. Received type number');return s(e)}return a(e,t,r)}function a(t,r,a){if("string"==typeof t)return function(t,r){if("string"==typeof r&&""!==r||(r="utf8"),!e.isEncoding(r))throw new TypeError("Unknown encoding: "+r);var a=0|c(t,r),i=n(a),s=i.write(t,r);return s!==a&&(i=i.slice(0,s)),i}(t,r);if(ArrayBuffer.isView(t))return o(t);if(null==t)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t);if(D(t,ArrayBuffer)||t&&D(t.buffer,ArrayBuffer))return function(t,r,n){if(r<0||t.byteLength<r)throw new RangeError('"offset" is outside of buffer bounds');if(t.byteLength<r+(n||0))throw new RangeError('"length" is outside of buffer bounds');var a;return(a=void 0===r&&void 0===n?new Uint8Array(t):void 0===n?new Uint8Array(t,r):new Uint8Array(t,r,n)).__proto__=e.prototype,a}(t,r,a);if("number"==typeof t)throw new TypeError('The "value" argument must not be of type number. Received type number');var i=t.valueOf&&t.valueOf();if(null!=i&&i!==t)return e.from(i,r,a);var s=function(t){if(e.isBuffer(t)){var r=0|u(t.length),a=n(r);return 0===a.length?a:(t.copy(a,0,0,r),a)}return void 0!==t.length?"number"!=typeof t.length||O(t.length)?n(0):o(t):"Buffer"===t.type&&Array.isArray(t.data)?o(t.data):void 0}(t);if(s)return s;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof t[Symbol.toPrimitive])return e.from(t[Symbol.toPrimitive]("string"),r,a);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t)}function i(e){if("number"!=typeof e)throw new TypeError('"size" argument must be of type number');if(e<0)throw new RangeError('The value "'+e+'" is invalid for option "size"')}function s(e){return i(e),n(e<0?0:0|u(e))}function o(e){for(var t=e.length<0?0:0|u(e.length),r=n(t),a=0;a<t;a+=1)r[a]=255&e[a];return r}function u(e){if(e>=t)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+t.toString(16)+" bytes");return 0|e}function c(t,r){if(e.isBuffer(t))return t.length;if(ArrayBuffer.isView(t)||D(t,ArrayBuffer))return t.byteLength;if("string"!=typeof t)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof t);var n=t.length,a=arguments.length>2&&!0===arguments[2];if(!a&&0===n)return 0;for(var i=!1;;)switch(r){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":return L(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return _(t).length;default:if(i)return a?-1:L(t).length;r=(""+r).toLowerCase(),i=!0}}function l(e,t,r){var n=e[t];e[t]=e[r],e[r]=n}function f(t,r,n,a,i){if(0===t.length)return-1;if("string"==typeof n?(a=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),O(n=+n)&&(n=i?0:t.length-1),n<0&&(n=t.length+n),n>=t.length){if(i)return-1;n=t.length-1}else if(n<0){if(!i)return-1;n=0}if("string"==typeof r&&(r=e.from(r,a)),e.isBuffer(r))return 0===r.length?-1:h(t,r,n,a,i);if("number"==typeof r)return r&=255,"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(t,r,n):Uint8Array.prototype.lastIndexOf.call(t,r,n):h(t,[r],n,a,i);throw new TypeError("val must be string, number or Buffer")}function h(e,t,r,n,a){var i,s=1,o=e.length,u=t.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(e.length<2||t.length<2)return-1;s=2,o/=2,u/=2,r/=2}function c(e,t){return 1===s?e[t]:e.readUInt16BE(t*s)}if(a){var l=-1;for(i=r;i<o;i++)if(c(e,i)===c(t,-1===l?0:i-l)){if(-1===l&&(l=i),i-l+1===u)return l*s}else-1!==l&&(i-=i-l),l=-1}else for(r+u>o&&(r=o-u),i=r;i>=0;i--){for(var f=!0,h=0;h<u;h++)if(c(e,i+h)!==c(t,h)){f=!1;break}if(f)return i}return-1}function p(e,t,r,n){r=Number(r)||0;var a=e.length-r;n?(n=Number(n))>a&&(n=a):n=a;var i=t.length;n>i/2&&(n=i/2);for(var s=0;s<n;++s){var o=parseInt(t.substr(2*s,2),16);if(O(o))return s;e[r+s]=o}return s}function d(e,t,r,n){return P(L(t,e.length-r),e,r,n)}function y(e,t,r,n){return P(function(e){for(var t=[],r=0;r<e.length;++r)t.push(255&e.charCodeAt(r));return t}(t),e,r,n)}function g(e,t,r,n){return y(e,t,r,n)}function m(e,t,r,n){return P(_(t),e,r,n)}function v(e,t,r,n){return P(function(e,t){for(var r,n,a,i=[],s=0;s<e.length&&!((t-=2)<0);++s)n=(r=e.charCodeAt(s))>>8,a=r%256,i.push(a),i.push(n);return i}(t,e.length-r),e,r,n)}function E(e,t,r){return 0===t&&r===e.length?le.fromByteArray(e):le.fromByteArray(e.slice(t,r))}function C(e,t,r){r=Math.min(e.length,r);for(var n=[],a=t;a<r;){var i,s,o,u,c=e[a],l=null,f=c>239?4:c>223?3:c>191?2:1;if(a+f<=r)switch(f){case 1:c<128&&(l=c);break;case 2:128==(192&(i=e[a+1]))&&(u=(31&c)<<6|63&i)>127&&(l=u);break;case 3:i=e[a+1],s=e[a+2],128==(192&i)&&128==(192&s)&&(u=(15&c)<<12|(63&i)<<6|63&s)>2047&&(u<55296||u>57343)&&(l=u);break;case 4:i=e[a+1],s=e[a+2],o=e[a+3],128==(192&i)&&128==(192&s)&&128==(192&o)&&(u=(15&c)<<18|(63&i)<<12|(63&s)<<6|63&o)>65535&&u<1114112&&(l=u)}null===l?(l=65533,f=1):l>65535&&(l-=65536,n.push(l>>>10&1023|55296),l=56320|1023&l),n.push(l),a+=f}return function(e){var t=e.length;if(t<=b)return String.fromCharCode.apply(String,e);for(var r="",n=0;n<t;)r+=String.fromCharCode.apply(String,e.slice(n,n+=b));return r}(n)}e.TYPED_ARRAY_SUPPORT=function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()}catch(t){return!1}}(),e.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(e.prototype,"parent",{enumerable:!0,get:function(){if(e.isBuffer(this))return this.buffer}}),Object.defineProperty(e.prototype,"offset",{enumerable:!0,get:function(){if(e.isBuffer(this))return this.byteOffset}}),"undefined"!=typeof Symbol&&null!=Symbol.species&&e[Symbol.species]===e&&Object.defineProperty(e,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),e.poolSize=8192,e.from=function(e,t,r){return a(e,t,r)},e.prototype.__proto__=Uint8Array.prototype,e.__proto__=Uint8Array,e.alloc=function(e,t,r){return function(e,t,r){return i(e),e<=0?n(e):void 0!==t?"string"==typeof r?n(e).fill(t,r):n(e).fill(t):n(e)}(e,t,r)},e.allocUnsafe=function(e){return s(e)},e.allocUnsafeSlow=function(e){return s(e)},e.isBuffer=function(t){return null!=t&&!0===t._isBuffer&&t!==e.prototype},e.compare=function(t,r){if(D(t,Uint8Array)&&(t=e.from(t,t.offset,t.byteLength)),D(r,Uint8Array)&&(r=e.from(r,r.offset,r.byteLength)),!e.isBuffer(t)||!e.isBuffer(r))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(t===r)return 0;for(var n=t.length,a=r.length,i=0,s=Math.min(n,a);i<s;++i)if(t[i]!==r[i]){n=t[i],a=r[i];break}return n<a?-1:a<n?1:0},e.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},e.concat=function(t,r){if(!Array.isArray(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return e.alloc(0);var n;if(void 0===r)for(r=0,n=0;n<t.length;++n)r+=t[n].length;var a=e.allocUnsafe(r),i=0;for(n=0;n<t.length;++n){var s=t[n];if(D(s,Uint8Array)&&(s=e.from(s)),!e.isBuffer(s))throw new TypeError('"list" argument must be an Array of Buffers');s.copy(a,i),i+=s.length}return a},e.byteLength=c,e.prototype._isBuffer=!0,e.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)l(this,t,t+1);return this},e.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)l(this,t,t+3),l(this,t+1,t+2);return this},e.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)l(this,t,t+7),l(this,t+1,t+6),l(this,t+2,t+5),l(this,t+3,t+4);return this},e.prototype.toString=function(){var e=this.length;return 0===e?"":0===arguments.length?C(this,0,e):function(e,t,r){var n=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===r||r>this.length)&&(r=this.length),r<=0)return"";if((r>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return I(this,t,r);case"utf8":case"utf-8":return C(this,t,r);case"ascii":return S(this,t,r);case"latin1":case"binary":return T(this,t,r);case"base64":return E(this,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return A(this,t,r);default:if(n)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),n=!0}}.apply(this,arguments)},e.prototype.toLocaleString=e.prototype.toString,e.prototype.equals=function(t){if(!e.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===e.compare(this,t)},e.prototype.inspect=function(){var e="",t=r.INSPECT_MAX_BYTES;return e=this.toString("hex",0,t).replace(/(.{2})/g,"$1 ").trim(),this.length>t&&(e+=" ... "),"<Buffer "+e+">"},e.prototype.compare=function(t,r,n,a,i){if(D(t,Uint8Array)&&(t=e.from(t,t.offset,t.byteLength)),!e.isBuffer(t))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof t);if(void 0===r&&(r=0),void 0===n&&(n=t?t.length:0),void 0===a&&(a=0),void 0===i&&(i=this.length),r<0||n>t.length||a<0||i>this.length)throw new RangeError("out of range index");if(a>=i&&r>=n)return 0;if(a>=i)return-1;if(r>=n)return 1;if(this===t)return 0;for(var s=(i>>>=0)-(a>>>=0),o=(n>>>=0)-(r>>>=0),u=Math.min(s,o),c=this.slice(a,i),l=t.slice(r,n),f=0;f<u;++f)if(c[f]!==l[f]){s=c[f],o=l[f];break}return s<o?-1:o<s?1:0},e.prototype.includes=function(e,t,r){return-1!==this.indexOf(e,t,r)},e.prototype.indexOf=function(e,t,r){return f(this,e,t,r,!0)},e.prototype.lastIndexOf=function(e,t,r){return f(this,e,t,r,!1)},e.prototype.write=function(e,t,r,n){if(void 0===t)n="utf8",r=this.length,t=0;else if(void 0===r&&"string"==typeof t)n=t,r=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t>>>=0,isFinite(r)?(r>>>=0,void 0===n&&(n="utf8")):(n=r,r=void 0)}var a=this.length-t;if((void 0===r||r>a)&&(r=a),e.length>0&&(r<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");for(var i=!1;;)switch(n){case"hex":return p(this,e,t,r);case"utf8":case"utf-8":return d(this,e,t,r);case"ascii":return y(this,e,t,r);case"latin1":case"binary":return g(this,e,t,r);case"base64":return m(this,e,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return v(this,e,t,r);default:if(i)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),i=!0}},e.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var b=4096;function S(e,t,r){var n="";r=Math.min(e.length,r);for(var a=t;a<r;++a)n+=String.fromCharCode(127&e[a]);return n}function T(e,t,r){var n="";r=Math.min(e.length,r);for(var a=t;a<r;++a)n+=String.fromCharCode(e[a]);return n}function I(e,t,r){var n,a=e.length;(!t||t<0)&&(t=0),(!r||r<0||r>a)&&(r=a);for(var i="",s=t;s<r;++s)i+=(n=e[s])<16?"0"+n.toString(16):n.toString(16);return i}function A(e,t,r){for(var n=e.slice(t,r),a="",i=0;i<n.length;i+=2)a+=String.fromCharCode(n[i]+256*n[i+1]);return a}function w(e,t,r){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>r)throw new RangeError("Trying to access beyond buffer length")}function B(t,r,n,a,i,s){if(!e.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(r>i||r<s)throw new RangeError('"value" argument is out of bounds');if(n+a>t.length)throw new RangeError("Index out of range")}function N(e,t,r,n,a,i){if(r+n>e.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function k(e,t,r,n,a){return t=+t,r>>>=0,a||N(e,0,r,4),Ee.write(e,t,r,n,23,4),r+4}function R(e,t,r,n,a){return t=+t,r>>>=0,a||N(e,0,r,8),Ee.write(e,t,r,n,52,8),r+8}e.prototype.slice=function(t,r){var n=this.length;(t=~~t)<0?(t+=n)<0&&(t=0):t>n&&(t=n),(r=void 0===r?n:~~r)<0?(r+=n)<0&&(r=0):r>n&&(r=n),r<t&&(r=t);var a=this.subarray(t,r);return a.__proto__=e.prototype,a},e.prototype.readUIntLE=function(e,t,r){e>>>=0,t>>>=0,r||w(e,t,this.length);for(var n=this[e],a=1,i=0;++i<t&&(a*=256);)n+=this[e+i]*a;return n},e.prototype.readUIntBE=function(e,t,r){e>>>=0,t>>>=0,r||w(e,t,this.length);for(var n=this[e+--t],a=1;t>0&&(a*=256);)n+=this[e+--t]*a;return n},e.prototype.readUInt8=function(e,t){return e>>>=0,t||w(e,1,this.length),this[e]},e.prototype.readUInt16LE=function(e,t){return e>>>=0,t||w(e,2,this.length),this[e]|this[e+1]<<8},e.prototype.readUInt16BE=function(e,t){return e>>>=0,t||w(e,2,this.length),this[e]<<8|this[e+1]},e.prototype.readUInt32LE=function(e,t){return e>>>=0,t||w(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},e.prototype.readUInt32BE=function(e,t){return e>>>=0,t||w(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},e.prototype.readIntLE=function(e,t,r){e>>>=0,t>>>=0,r||w(e,t,this.length);for(var n=this[e],a=1,i=0;++i<t&&(a*=256);)n+=this[e+i]*a;return n>=(a*=128)&&(n-=Math.pow(2,8*t)),n},e.prototype.readIntBE=function(e,t,r){e>>>=0,t>>>=0,r||w(e,t,this.length);for(var n=t,a=1,i=this[e+--n];n>0&&(a*=256);)i+=this[e+--n]*a;return i>=(a*=128)&&(i-=Math.pow(2,8*t)),i},e.prototype.readInt8=function(e,t){return e>>>=0,t||w(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},e.prototype.readInt16LE=function(e,t){e>>>=0,t||w(e,2,this.length);var r=this[e]|this[e+1]<<8;return 32768&r?4294901760|r:r},e.prototype.readInt16BE=function(e,t){e>>>=0,t||w(e,2,this.length);var r=this[e+1]|this[e]<<8;return 32768&r?4294901760|r:r},e.prototype.readInt32LE=function(e,t){return e>>>=0,t||w(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},e.prototype.readInt32BE=function(e,t){return e>>>=0,t||w(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},e.prototype.readFloatLE=function(e,t){return e>>>=0,t||w(e,4,this.length),Ee.read(this,e,!0,23,4)},e.prototype.readFloatBE=function(e,t){return e>>>=0,t||w(e,4,this.length),Ee.read(this,e,!1,23,4)},e.prototype.readDoubleLE=function(e,t){return e>>>=0,t||w(e,8,this.length),Ee.read(this,e,!0,52,8)},e.prototype.readDoubleBE=function(e,t){return e>>>=0,t||w(e,8,this.length),Ee.read(this,e,!1,52,8)},e.prototype.writeUIntLE=function(e,t,r,n){e=+e,t>>>=0,r>>>=0,n||B(this,e,t,r,Math.pow(2,8*r)-1,0);var a=1,i=0;for(this[t]=255&e;++i<r&&(a*=256);)this[t+i]=e/a&255;return t+r},e.prototype.writeUIntBE=function(e,t,r,n){e=+e,t>>>=0,r>>>=0,n||B(this,e,t,r,Math.pow(2,8*r)-1,0);var a=r-1,i=1;for(this[t+a]=255&e;--a>=0&&(i*=256);)this[t+a]=e/i&255;return t+r},e.prototype.writeUInt8=function(e,t,r){return e=+e,t>>>=0,r||B(this,e,t,1,255,0),this[t]=255&e,t+1},e.prototype.writeUInt16LE=function(e,t,r){return e=+e,t>>>=0,r||B(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},e.prototype.writeUInt16BE=function(e,t,r){return e=+e,t>>>=0,r||B(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},e.prototype.writeUInt32LE=function(e,t,r){return e=+e,t>>>=0,r||B(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},e.prototype.writeUInt32BE=function(e,t,r){return e=+e,t>>>=0,r||B(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},e.prototype.writeIntLE=function(e,t,r,n){if(e=+e,t>>>=0,!n){var a=Math.pow(2,8*r-1);B(this,e,t,r,a-1,-a)}var i=0,s=1,o=0;for(this[t]=255&e;++i<r&&(s*=256);)e<0&&0===o&&0!==this[t+i-1]&&(o=1),this[t+i]=(e/s>>0)-o&255;return t+r},e.prototype.writeIntBE=function(e,t,r,n){if(e=+e,t>>>=0,!n){var a=Math.pow(2,8*r-1);B(this,e,t,r,a-1,-a)}var i=r-1,s=1,o=0;for(this[t+i]=255&e;--i>=0&&(s*=256);)e<0&&0===o&&0!==this[t+i+1]&&(o=1),this[t+i]=(e/s>>0)-o&255;return t+r},e.prototype.writeInt8=function(e,t,r){return e=+e,t>>>=0,r||B(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=255&e,t+1},e.prototype.writeInt16LE=function(e,t,r){return e=+e,t>>>=0,r||B(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},e.prototype.writeInt16BE=function(e,t,r){return e=+e,t>>>=0,r||B(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},e.prototype.writeInt32LE=function(e,t,r){return e=+e,t>>>=0,r||B(this,e,t,4,2147483647,-2147483648),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},e.prototype.writeInt32BE=function(e,t,r){return e=+e,t>>>=0,r||B(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},e.prototype.writeFloatLE=function(e,t,r){return k(this,e,t,!0,r)},e.prototype.writeFloatBE=function(e,t,r){return k(this,e,t,!1,r)},e.prototype.writeDoubleLE=function(e,t,r){return R(this,e,t,!0,r)},e.prototype.writeDoubleBE=function(e,t,r){return R(this,e,t,!1,r)},e.prototype.copy=function(t,r,n,a){if(!e.isBuffer(t))throw new TypeError("argument should be a Buffer");if(n||(n=0),a||0===a||(a=this.length),r>=t.length&&(r=t.length),r||(r=0),a>0&&a<n&&(a=n),a===n)return 0;if(0===t.length||0===this.length)return 0;if(r<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("Index out of range");if(a<0)throw new RangeError("sourceEnd out of bounds");a>this.length&&(a=this.length),t.length-r<a-n&&(a=t.length-r+n);var i=a-n;if(this===t&&"function"==typeof Uint8Array.prototype.copyWithin)this.copyWithin(r,n,a);else if(this===t&&n<r&&r<a)for(var s=i-1;s>=0;--s)t[s+r]=this[s+n];else Uint8Array.prototype.set.call(t,this.subarray(n,a),r);return i},e.prototype.fill=function(t,r,n,a){if("string"==typeof t){if("string"==typeof r?(a=r,r=0,n=this.length):"string"==typeof n&&(a=n,n=this.length),void 0!==a&&"string"!=typeof a)throw new TypeError("encoding must be a string");if("string"==typeof a&&!e.isEncoding(a))throw new TypeError("Unknown encoding: "+a);if(1===t.length){var i=t.charCodeAt(0);("utf8"===a&&i<128||"latin1"===a)&&(t=i)}}else"number"==typeof t&&(t&=255);if(r<0||this.length<r||this.length<n)throw new RangeError("Out of range index");if(n<=r)return this;var s;if(r>>>=0,n=void 0===n?this.length:n>>>0,t||(t=0),"number"==typeof t)for(s=r;s<n;++s)this[s]=t;else{var o=e.isBuffer(t)?t:e.from(t,a),u=o.length;if(0===u)throw new TypeError('The value "'+t+'" is invalid for argument "value"');for(s=0;s<n-r;++s)this[s+r]=o[s%u]}return this};var U=/[^+/0-9A-Za-z-_]/g;function L(e,t){var r;t=t||1/0;for(var n=e.length,a=null,i=[],s=0;s<n;++s){if((r=e.charCodeAt(s))>55295&&r<57344){if(!a){if(r>56319){(t-=3)>-1&&i.push(239,191,189);continue}if(s+1===n){(t-=3)>-1&&i.push(239,191,189);continue}a=r;continue}if(r<56320){(t-=3)>-1&&i.push(239,191,189),a=r;continue}r=65536+(a-55296<<10|r-56320)}else a&&(t-=3)>-1&&i.push(239,191,189);if(a=null,r<128){if((t-=1)<0)break;i.push(r)}else if(r<2048){if((t-=2)<0)break;i.push(r>>6|192,63&r|128)}else if(r<65536){if((t-=3)<0)break;i.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;i.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return i}function _(e){return le.toByteArray(function(e){if((e=(e=e.split("=")[0]).trim().replace(U,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function P(e,t,r,n){for(var a=0;a<n&&!(a+r>=t.length||a>=e.length);++a)t[a+r]=e[a];return a}function D(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}function O(e){return e!=e}}).call(this,t({}).Buffer)}),r=e(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n({}),i=a({}),s=function(e){return"string"==typeof e||e instanceof String},o=function(e){return e instanceof Uint8Array};t._fromIn=function(e){return s(e)?r.base58Decode(e):o(e)?e:Uint8Array.from(e)},t._fromRawIn=function(e){return s(e)?i.stringToBytes(e):o(e)?e:Uint8Array.from(e)}}),n=e(function(e,t){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var i=n(N),s=r({}),o=a({});t.base64Decode=function(e){return o.stringToBytes(B.decode64(e),"raw")},t.base64Encode=function(e){return B.encode64(o.bytesToString(s._fromIn(e),"raw"))},t.base58Decode=function(e){return i.default.decode(e)},t.base58Encode=function(e){return i.default.encode(s._fromIn(e))},t.base16Decode=function(e){return o.stringToBytes(B.hexToBytes(e),"raw")},t.base16Encode=function(e){return B.bytesToHex(o.bytesToString(s._fromIn(e),"raw"))}}),a=e(function(e,t){"use strict";var n=this&&this.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,a,i=r.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)s.push(n.value)}catch(o){a={error:o}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(a)throw a.error}}return s},a=this&&this.__spread||function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(n(arguments[t]));return e};Object.defineProperty(t,"__esModule",{value:!0});var i=r({});t.stringToBytes=function(e,t){if(void 0===t&&(t="utf8"),"utf8"===t)return P.strToUtf8Array(e);if("raw"===t)return Uint8Array.from(a(e).map(function(e){return e.charCodeAt(0)}));throw new Error("Unsupported encoding "+t)},t.bytesToString=function(e,t){if(void 0===t&&(t="utf8"),"utf8"===t)return P.utf8ArrayToStr(Array.from(i._fromIn(e)));if("raw"===t)return Array.from(i._fromIn(e)).map(function(e){return String.fromCharCode(e)}).join("");throw new Error("Unsupported encoding "+t)}}),i=e(function(e,t){(function(e,r){var n=d.nextTick,a=(Function.prototype.apply,Array.prototype.slice),i={},s=0;function o(e,t){this._id=e,this._clearFn=t}o.prototype.unref=o.prototype.ref=function(){},o.prototype.close=function(){this._clearFn.call(window,this._id)},t.setImmediate="function"==typeof e?e:function(e){var r=s++,o=!(arguments.length<2)&&a.call(arguments,1);return i[r]=!0,n(function(){i[r]&&(o?e.apply(null,o):e.call(null),t.clearImmediate(r))}),r},t.clearImmediate="function"==typeof r?r:function(e){delete i[e]}}).call(this,i({}).setImmediate,i({}).clearImmediate)}),s={};Object.defineProperty(s,"__esModule",{value:!0}),s.seedWordsList=["abandon","ability","able","about","above","absent","absorb","abstract","absurd","abuse","access","accident","account","accuse","achieve","acid","acoustic","acquire","across","act","action","actor","actress","actual","adapt","add","addict","address","adjust","admit","adult","advance","advice","aerobic","affair","afford","afraid","again","age","agent","agree","ahead","aim","air","airport","aisle","alarm","album","alcohol","alert","alien","all","alley","allow","almost","alone","alpha","already","also","alter","always","amateur","amazing","among","amount","amused","analyst","anchor","ancient","anger","angle","angry","animal","ankle","announce","annual","another","answer","antenna","antique","anxiety","any","apart","apology","appear","apple","approve","april","arch","arctic","area","arena","argue","arm","armed","armor","army","around","arrange","arrest","arrive","arrow","art","artefact","artist","artwork","ask","aspect","assault","asset","assist","assume","asthma","athlete","atom","attack","attend","attitude","attract","auction","audit","august","aunt","author","auto","autumn","average","avocado","avoid","awake","aware","away","awesome","awful","awkward","axis","baby","bachelor","bacon","badge","bag","balance","balcony","ball","bamboo","banana","banner","bar","barely","bargain","barrel","base","basic","basket","battle","beach","bean","beauty","because","become","beef","before","begin","behave","behind","believe","below","belt","bench","benefit","best","betray","better","between","beyond","bicycle","bid","bike","bind","biology","bird","birth","bitter","black","blade","blame","blanket","blast","bleak","bless","blind","blood","blossom","blouse","blue","blur","blush","board","boat","body","boil","bomb","bone","bonus","book","boost","border","boring","borrow","boss","bottom","bounce","box","boy","bracket","brain","brand","brass","brave","bread","breeze","brick","bridge","brief","bright","bring","brisk","broccoli","broken","bronze","broom","brother","brown","brush","bubble","buddy","budget","buffalo","build","bulb","bulk","bullet","bundle","bunker","burden","burger","burst","bus","business","busy","butter","buyer","buzz","cabbage","cabin","cable","cactus","cage","cake","call","calm","camera","camp","can","canal","cancel","candy","cannon","canoe","canvas","canyon","capable","capital","captain","car","carbon","card","cargo","carpet","carry","cart","case","cash","casino","castle","casual","cat","catalog","catch","category","cattle","caught","cause","caution","cave","ceiling","celery","cement","census","century","cereal","certain","chair","chalk","champion","change","chaos","chapter","charge","chase","chat","cheap","check","cheese","chef","cherry","chest","chicken","chief","child","chimney","choice","choose","chronic","chuckle","chunk","churn","cigar","cinnamon","circle","citizen","city","civil","claim","clap","clarify","claw","clay","clean","clerk","clever","click","client","cliff","climb","clinic","clip","clock","clog","close","cloth","cloud","clown","club","clump","cluster","clutch","coach","coast","coconut","code","coffee","coil","coin","collect","color","column","combine","come","comfort","comic","common","company","concert","conduct","confirm","congress","connect","consider","control","convince","cook","cool","copper","copy","coral","core","corn","correct","cost","cotton","couch","country","couple","course","cousin","cover","coyote","crack","cradle","craft","cram","crane","crash","crater","crawl","crazy","cream","credit","creek","crew","cricket","crime","crisp","critic","crop","cross","crouch","crowd","crucial","cruel","cruise","crumble","crunch","crush","cry","crystal","cube","culture","cup","cupboard","curious","current","curtain","curve","cushion","custom","cute","cycle","dad","damage","damp","dance","danger","daring","dash","daughter","dawn","day","deal","debate","debris","decade","december","decide","decline","decorate","decrease","deer","defense","define","defy","degree","delay","deliver","demand","demise","denial","dentist","deny","depart","depend","deposit","depth","deputy","derive","describe","desert","design","desk","despair","destroy","detail","detect","develop","device","devote","diagram","dial","diamond","diary","dice","diesel","diet","differ","digital","dignity","dilemma","dinner","dinosaur","direct","dirt","disagree","discover","disease","dish","dismiss","disorder","display","distance","divert","divide","divorce","dizzy","doctor","document","dog","doll","dolphin","domain","donate","donkey","donor","door","dose","double","dove","draft","dragon","drama","drastic","draw","dream","dress","drift","drill","drink","drip","drive","drop","drum","dry","duck","dumb","dune","during","dust","dutch","duty","dwarf","dynamic","eager","eagle","early","earn","earth","easily","east","easy","echo","ecology","economy","edge","edit","educate","effort","egg","eight","either","elbow","elder","electric","elegant","element","elephant","elevator","elite","else","embark","embody","embrace","emerge","emotion","employ","empower","empty","enable","enact","end","endless","endorse","enemy","energy","enforce","engage","engine","enhance","enjoy","enlist","enough","enrich","enroll","ensure","enter","entire","entry","envelope","episode","equal","equip","era","erase","erode","erosion","error","erupt","escape","essay","essence","estate","eternal","ethics","evidence","evil","evoke","evolve","exact","example","excess","exchange","excite","exclude","excuse","execute","exercise","exhaust","exhibit","exile","exist","exit","exotic","expand","expect","expire","explain","expose","express","extend","extra","eye","eyebrow","fabric","face","faculty","fade","faint","faith","fall","false","fame","family","famous","fan","fancy","fantasy","farm","fashion","fat","fatal","father","fatigue","fault","favorite","feature","february","federal","fee","feed","feel","female","fence","festival","fetch","fever","few","fiber","fiction","field","figure","file","film","filter","final","find","fine","finger","finish","fire","firm","first","fiscal","fish","fit","fitness","fix","flag","flame","flash","flat","flavor","flee","flight","flip","float","flock","floor","flower","fluid","flush","fly","foam","focus","fog","foil","fold","follow","food","foot","force","forest","forget","fork","fortune","forum","forward","fossil","foster","found","fox","fragile","frame","frequent","fresh","friend","fringe","frog","front","frost","frown","frozen","fruit","fuel","fun","funny","furnace","fury","future","gadget","gain","galaxy","gallery","game","gap","garage","garbage","garden","garlic","garment","gas","gasp","gate","gather","gauge","gaze","general","genius","genre","gentle","genuine","gesture","ghost","giant","gift","giggle","ginger","giraffe","girl","give","glad","glance","glare","glass","glide","glimpse","globe","gloom","glory","glove","glow","glue","goat","goddess","gold","good","goose","gorilla","gospel","gossip","govern","gown","grab","grace","grain","grant","grape","grass","gravity","great","green","grid","grief","grit","grocery","group","grow","grunt","guard","guess","guide","guilt","guitar","gun","gym","habit","hair","half","hammer","hamster","hand","happy","harbor","hard","harsh","harvest","hat","have","hawk","hazard","head","health","heart","heavy","hedgehog","height","hello","helmet","help","hen","hero","hidden","high","hill","hint","hip","hire","history","hobby","hockey","hold","hole","holiday","hollow","home","honey","hood","hope","horn","horror","horse","hospital","host","hotel","hour","hover","hub","huge","human","humble","humor","hundred","hungry","hunt","hurdle","hurry","hurt","husband","hybrid","ice","icon","idea","identify","idle","ignore","ill","illegal","illness","image","imitate","immense","immune","impact","impose","improve","impulse","inch","include","income","increase","index","indicate","indoor","industry","infant","inflict","inform","inhale","inherit","initial","inject","injury","inmate","inner","innocent","input","inquiry","insane","insect","inside","inspire","install","intact","interest","into","invest","invite","involve","iron","island","isolate","issue","item","ivory","jacket","jaguar","jar","jazz","jealous","jeans","jelly","jewel","job","join","joke","journey","joy","judge","juice","jump","jungle","junior","junk","just","kangaroo","keen","keep","ketchup","key","kick","kid","kidney","kind","kingdom","kiss","kit","kitchen","kite","kitten","kiwi","knee","knife","knock","know","lab","label","labor","ladder","lady","lake","lamp","language","laptop","large","later","latin","laugh","laundry","lava","law","lawn","lawsuit","layer","lazy","leader","leaf","learn","leave","lecture","left","leg","legal","legend","leisure","lemon","lend","length","lens","leopard","lesson","letter","level","liar","liberty","library","license","life","lift","light","like","limb","limit","link","lion","liquid","list","little","live","lizard","load","loan","lobster","local","lock","logic","lonely","long","loop","lottery","loud","lounge","love","loyal","lucky","luggage","lumber","lunar","lunch","luxury","lyrics","machine","mad","magic","magnet","maid","mail","main","major","make","mammal","man","manage","mandate","mango","mansion","manual","maple","marble","march","margin","marine","market","marriage","mask","mass","master","match","material","math","matrix","matter","maximum","maze","meadow","mean","measure","meat","mechanic","medal","media","melody","melt","member","memory","mention","menu","mercy","merge","merit","merry","mesh","message","metal","method","middle","midnight","milk","million","mimic","mind","minimum","minor","minute","miracle","mirror","misery","miss","mistake","mix","mixed","mixture","mobile","model","modify","mom","moment","monitor","monkey","monster","month","moon","moral","more","morning","mosquito","mother","motion","motor","mountain","mouse","move","movie","much","muffin","mule","multiply","muscle","museum","mushroom","music","must","mutual","myself","mystery","myth","naive","name","napkin","narrow","nasty","nation","nature","near","neck","need","negative","neglect","neither","nephew","nerve","nest","net","network","neutral","never","news","next","nice","night","noble","noise","nominee","noodle","normal","north","nose","notable","note","nothing","notice","novel","now","nuclear","number","nurse","nut","oak","obey","object","oblige","obscure","observe","obtain","obvious","occur","ocean","october","odor","off","offer","office","often","oil","okay","old","olive","olympic","omit","once","one","onion","online","only","open","opera","opinion","oppose","option","orange","orbit","orchard","order","ordinary","organ","orient","original","orphan","ostrich","other","outdoor","outer","output","outside","oval","oven","over","own","owner","oxygen","oyster","ozone","pact","paddle","page","pair","palace","palm","panda","panel","panic","panther","paper","parade","parent","park","parrot","party","pass","patch","path","patient","patrol","pattern","pause","pave","payment","peace","peanut","pear","peasant","pelican","pen","penalty","pencil","people","pepper","perfect","permit","person","pet","phone","photo","phrase","physical","piano","picnic","picture","piece","pig","pigeon","pill","pilot","pink","pioneer","pipe","pistol","pitch","pizza","place","planet","plastic","plate","play","please","pledge","pluck","plug","plunge","poem","poet","point","polar","pole","police","pond","pony","pool","popular","portion","position","possible","post","potato","pottery","poverty","powder","power","practice","praise","predict","prefer","prepare","present","pretty","prevent","price","pride","primary","print","priority","prison","private","prize","problem","process","produce","profit","program","project","promote","proof","property","prosper","protect","proud","provide","public","pudding","pull","pulp","pulse","pumpkin","punch","pupil","puppy","purchase","purity","purpose","purse","push","put","puzzle","pyramid","quality","quantum","quarter","question","quick","quit","quiz","quote","rabbit","raccoon","race","rack","radar","radio","rail","rain","raise","rally","ramp","ranch","random","range","rapid","rare","rate","rather","raven","raw","razor","ready","real","reason","rebel","rebuild","recall","receive","recipe","record","recycle","reduce","reflect","reform","refuse","region","regret","regular","reject","relax","release","relief","rely","remain","remember","remind","remove","render","renew","rent","reopen","repair","repeat","replace","report","require","rescue","resemble","resist","resource","response","result","retire","retreat","return","reunion","reveal","review","reward","rhythm","rib","ribbon","rice","rich","ride","ridge","rifle","right","rigid","ring","riot","ripple","risk","ritual","rival","river","road","roast","robot","robust","rocket","romance","roof","rookie","room","rose","rotate","rough","round","route","royal","rubber","rude","rug","rule","run","runway","rural","sad","saddle","sadness","safe","sail","salad","salmon","salon","salt","salute","same","sample","sand","satisfy","satoshi","sauce","sausage","save","say","scale","scan","scare","scatter","scene","scheme","school","science","scissors","scorpion","scout","scrap","screen","script","scrub","sea","search","season","seat","second","secret","section","security","seed","seek","segment","select","sell","seminar","senior","sense","sentence","series","service","session","settle","setup","seven","shadow","shaft","shallow","share","shed","shell","sheriff","shield","shift","shine","ship","shiver","shock","shoe","shoot","shop","short","shoulder","shove","shrimp","shrug","shuffle","shy","sibling","sick","side","siege","sight","sign","silent","silk","silly","silver","similar","simple","since","sing","siren","sister","situate","six","size","skate","sketch","ski","skill","skin","skirt","skull","slab","slam","sleep","slender","slice","slide","slight","slim","slogan","slot","slow","slush","small","smart","smile","smoke","smooth","snack","snake","snap","sniff","snow","soap","soccer","social","sock","soda","soft","solar","soldier","solid","solution","solve","someone","song","soon","sorry","sort","soul","sound","soup","source","south","space","spare","spatial","spawn","speak","special","speed","spell","spend","sphere","spice","spider","spike","spin","spirit","split","spoil","sponsor","spoon","sport","spot","spray","spread","spring","spy","square","squeeze","squirrel","stable","stadium","staff","stage","stairs","stamp","stand","start","state","stay","steak","steel","stem","step","stereo","stick","still","sting","stock","stomach","stone","stool","story","stove","strategy","street","strike","strong","struggle","student","stuff","stumble","style","subject","submit","subway","success","such","sudden","suffer","sugar","suggest","suit","summer","sun","sunny","sunset","super","supply","supreme","sure","surface","surge","surprise","surround","survey","suspect","sustain","swallow","swamp","swap","swarm","swear","sweet","swift","swim","swing","switch","sword","symbol","symptom","syrup","system","table","tackle","tag","tail","talent","talk","tank","tape","target","task","taste","tattoo","taxi","teach","team","tell","ten","tenant","tennis","tent","term","test","text","thank","that","theme","then","theory","there","they","thing","this","thought","three","thrive","throw","thumb","thunder","ticket","tide","tiger","tilt","timber","time","tiny","tip","tired","tissue","title","toast","tobacco","today","toddler","toe","together","toilet","token","tomato","tomorrow","tone","tongue","tonight","tool","tooth","top","topic","topple","torch","tornado","tortoise","toss","total","tourist","toward","tower","town","toy","track","trade","traffic","tragic","train","transfer","trap","trash","travel","tray","treat","tree","trend","trial","tribe","trick","trigger","trim","trip","trophy","trouble","truck","true","truly","trumpet","trust","truth","try","tube","tuition","tumble","tuna","tunnel","turkey","turn","turtle","twelve","twenty","twice","twin","twist","two","type","typical","ugly","umbrella","unable","unaware","uncle","uncover","under","undo","unfair","unfold","unhappy","uniform","unique","unit","universe","unknown","unlock","until","unusual","unveil","update","upgrade","uphold","upon","upper","upset","urban","urge","usage","use","used","useful","useless","usual","utility","vacant","vacuum","vague","valid","valley","valve","van","vanish","vapor","various","vast","vault","vehicle","velvet","vendor","venture","venue","verb","verify","version","very","vessel","veteran","viable","vibrant","vicious","victory","video","view","village","vintage","violin","virtual","virus","visa","visit","visual","vital","vivid","vocal","voice","void","volcano","volume","vote","voyage","wage","wagon","wait","walk","wall","walnut","want","warfare","warm","warrior","wash","wasp","waste","water","wave","way","wealth","weapon","wear","weasel","weather","web","wedding","weekend","weird","welcome","west","wet","whale","what","wheat","wheel","when","where","whip","whisper","wide","width","wife","wild","will","win","window","wine","wing","wink","winner","winter","wire","wisdom","wise","wish","witness","wolf","woman","wonder","wood","wool","word","work","world","worry","worth","wrap","wreck","wrestle","wrist","write","wrong","yard","year","yellow","you","young","youth","zebra","zero","zone","zoo"];var o={};Object.defineProperty(o,"__esModule",{value:!0}),o.PUBLIC_KEY_LENGTH=32,o.PRIVATE_KEY_LENGTH=32,o.SIGNATURE_LENGTH=64,o.ADDRESS_LENGTH=26,o.MAIN_NET_CHAIN_ID=87,o.TEST_NET_CHAIN_ID=84;var u={};Object.defineProperty(u,"__esModule",{value:!0}),u.ChaidId={toNumber:function(e){return"string"==typeof e?e.charCodeAt(0):e},isMainnet:function(e){return u.ChaidId.toNumber(e)===o.MAIN_NET_CHAIN_ID},isTestnet:function(e){return u.ChaidId.toNumber(e)===o.TEST_NET_CHAIN_ID}};var c={options:{usePureJavaScript:!1}},l={},f={};(function(e){var t={};f=t;var r={};t.encode=function(e,t,r){if("string"!=typeof t)throw new TypeError('"alphabet" must be a string.');if(void 0!==r&&"number"!=typeof r)throw new TypeError('"maxline" must be a number.');var n="";if(e instanceof Uint8Array){var a=0,i=t.length,s=t.charAt(0),o=[0];for(a=0;a<e.length;++a){for(var u=0,c=e[a];u<o.length;++u)c+=o[u]<<8,o[u]=c%i,c=c/i|0;for(;c>0;)o.push(c%i),c=c/i|0}for(a=0;0===e[a]&&a<e.length-1;++a)n+=s;for(a=o.length-1;a>=0;--a)n+=t[o[a]]}else n=function(e,t){var r=0,n=t.length,a=t.charAt(0),i=[0];for(r=0;r<e.length();++r){for(var s=0,o=e.at(r);s<i.length;++s)o+=i[s]<<8,i[s]=o%n,o=o/n|0;for(;o>0;)i.push(o%n),o=o/n|0}var u="";for(r=0;0===e.at(r)&&r<e.length()-1;++r)u+=a;for(r=i.length-1;r>=0;--r)u+=t[i[r]];return u}(e,t);if(r){var l=new RegExp(".{1,"+r+"}","g");n=n.match(l).join("\r\n")}return n},t.decode=function(t,n){if("string"!=typeof t)throw new TypeError('"input" must be a string.');if("string"!=typeof n)throw new TypeError('"alphabet" must be a string.');var a=r[n];if(!a){a=r[n]=[];for(var i=0;i<n.length;++i)a[n.charCodeAt(i)]=i}t=t.replace(/\s/g,"");var s=n.length,o=n.charAt(0),u=[0];for(i=0;i<t.length;i++){var c=a[t.charCodeAt(i)];if(void 0===c)return;for(var l=0,f=c;l<u.length;++l)f+=u[l]*s,u[l]=255&f,f>>=8;for(;f>0;)u.push(255&f),f>>=8}for(var h=0;t[h]===o&&h<t.length-1;++h)u.push(0);return void 0!==e?e.from(u.reverse()):new Uint8Array(u.reverse())}}).call(this,l.Buffer);var h,p,d={},y=d={};function g(){throw new Error("setTimeout has not been defined")}function m(){throw new Error("clearTimeout has not been defined")}function v(e){if(h===setTimeout)return setTimeout(e,0);if((h===g||!h)&&setTimeout)return h=setTimeout,setTimeout(e,0);try{return h(e,0)}catch(t){try{return h.call(null,e,0)}catch(t){return h.call(this,e,0)}}}!function(){try{h="function"==typeof setTimeout?setTimeout:g}catch(e){h=g}try{p="function"==typeof clearTimeout?clearTimeout:m}catch(e){p=m}}();var E,C=[],b=!1,S=-1;function T(){b&&E&&(b=!1,E.length?C=E.concat(C):S=-1,C.length&&I())}function I(){if(!b){var e=v(T);b=!0;for(var t=C.length;t;){for(E=C,C=[];++S<t;)E&&E[S].run();S=-1,t=C.length}E=null,b=!1,function(e){if(p===clearTimeout)return clearTimeout(e);if((p===m||!p)&&clearTimeout)return p=clearTimeout,clearTimeout(e);try{p(e)}catch(t){try{return p.call(null,e)}catch(t){return p.call(this,e)}}}(e)}}function A(e,t){this.fun=e,this.array=t}function w(){}y.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];C.push(new A(e,t)),1!==C.length||b||v(I)},A.prototype.run=function(){this.fun.apply(null,this.array)},y.title="browser",y.browser=!0,y.env={},y.argv=[],y.version="",y.versions={},y.on=w,y.addListener=w,y.once=w,y.off=w,y.removeListener=w,y.removeAllListeners=w,y.emit=w,y.prependListener=w,y.prependOnceListener=w,y.listeners=function(e){return[]},y.binding=function(e){throw new Error("process.binding is not supported")},y.cwd=function(){return"/"},y.chdir=function(e){throw new Error("process.chdir is not supported")},y.umask=function(){return 0};var B={};(function(e,t,r,n,a,i,s,o){var u=B=c.util=c.util||{};function l(e){if(8!==e&&16!==e&&24!==e&&32!==e)throw new Error("Only 8, 16, 24, or 32 bits supported: "+e)}function h(e){if(this.data="",this.read=0,"string"==typeof e)this.data=e;else if(u.isArrayBuffer(e)||u.isArrayBufferView(e))if(void 0!==r&&e instanceof r)this.data=e.toString("binary");else{var t=new Uint8Array(e);try{this.data=String.fromCharCode.apply(null,t)}catch(a){for(var n=0;n<t.length;++n)this.putByte(t[n])}}else(e instanceof h||"object"==typeof e&&"string"==typeof e.data&&"number"==typeof e.read)&&(this.data=e.data,this.read=e.read);this._constructedStringLength=0}!function(){if(void 0!==e&&e.nextTick&&!e.browser)return u.nextTick=e.nextTick,void(u.setImmediate="function"==typeof o?o:u.nextTick);if("function"==typeof o)return u.setImmediate=function(){return o.apply(void 0,arguments)},void(u.nextTick=function(e){return o(e)});if(u.setImmediate=function(e){setTimeout(e,0)},"undefined"!=typeof window&&"function"==typeof window.postMessage){var t="forge.setImmediate",r=[];u.setImmediate=function(e){r.push(e),1===r.length&&window.postMessage(t,"*")},window.addEventListener("message",function(e){if(e.source===window&&e.data===t){e.stopPropagation();var n=r.slice();r.length=0,n.forEach(function(e){e()})}},!0)}if("undefined"!=typeof MutationObserver){var n=Date.now(),a=!0,i=document.createElement("div");r=[],new MutationObserver(function(){var e=r.slice();r.length=0,e.forEach(function(e){e()})}).observe(i,{attributes:!0});var s=u.setImmediate;u.setImmediate=function(e){Date.now()-n>15?(n=Date.now(),s(e)):(r.push(e),1===r.length&&i.setAttribute("a",a=!a))}}u.nextTick=u.setImmediate}(),u.isNodejs=void 0!==e&&e.versions&&e.versions.node,u.globalScope=u.isNodejs?t:"undefined"==typeof self?window:self,u.isArray=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},u.isArrayBuffer=function(e){return"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer},u.isArrayBufferView=function(e){return e&&u.isArrayBuffer(e.buffer)&&void 0!==e.byteLength},u.ByteBuffer=h,u.ByteStringBuffer=h,u.ByteStringBuffer.prototype._optimizeConstructedString=function(e){this._constructedStringLength+=e,this._constructedStringLength>4096&&(this.data.substr(0,1),this._constructedStringLength=0)},u.ByteStringBuffer.prototype.length=function(){return this.data.length-this.read},u.ByteStringBuffer.prototype.isEmpty=function(){return this.length()<=0},u.ByteStringBuffer.prototype.putByte=function(e){return this.putBytes(String.fromCharCode(e))},u.ByteStringBuffer.prototype.fillWithByte=function(e,t){e=String.fromCharCode(e);for(var r=this.data;t>0;)1&t&&(r+=e),(t>>>=1)>0&&(e+=e);return this.data=r,this._optimizeConstructedString(t),this},u.ByteStringBuffer.prototype.putBytes=function(e){return this.data+=e,this._optimizeConstructedString(e.length),this},u.ByteStringBuffer.prototype.putString=function(e){return this.putBytes(u.encodeUtf8(e))},u.ByteStringBuffer.prototype.putInt16=function(e){return this.putBytes(String.fromCharCode(e>>8&255)+String.fromCharCode(255&e))},u.ByteStringBuffer.prototype.putInt24=function(e){return this.putBytes(String.fromCharCode(e>>16&255)+String.fromCharCode(e>>8&255)+String.fromCharCode(255&e))},u.ByteStringBuffer.prototype.putInt32=function(e){return this.putBytes(String.fromCharCode(e>>24&255)+String.fromCharCode(e>>16&255)+String.fromCharCode(e>>8&255)+String.fromCharCode(255&e))},u.ByteStringBuffer.prototype.putInt16Le=function(e){return this.putBytes(String.fromCharCode(255&e)+String.fromCharCode(e>>8&255))},u.ByteStringBuffer.prototype.putInt24Le=function(e){return this.putBytes(String.fromCharCode(255&e)+String.fromCharCode(e>>8&255)+String.fromCharCode(e>>16&255))},u.ByteStringBuffer.prototype.putInt32Le=function(e){return this.putBytes(String.fromCharCode(255&e)+String.fromCharCode(e>>8&255)+String.fromCharCode(e>>16&255)+String.fromCharCode(e>>24&255))},u.ByteStringBuffer.prototype.putInt=function(e,t){l(t);var r="";do{t-=8,r+=String.fromCharCode(e>>t&255)}while(t>0);return this.putBytes(r)},u.ByteStringBuffer.prototype.putSignedInt=function(e,t){return e<0&&(e+=2<<t-1),this.putInt(e,t)},u.ByteStringBuffer.prototype.putBuffer=function(e){return this.putBytes(e.getBytes())},u.ByteStringBuffer.prototype.getByte=function(){return this.data.charCodeAt(this.read++)},u.ByteStringBuffer.prototype.getInt16=function(){var e=this.data.charCodeAt(this.read)<<8^this.data.charCodeAt(this.read+1);return this.read+=2,e},u.ByteStringBuffer.prototype.getInt24=function(){var e=this.data.charCodeAt(this.read)<<16^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2);return this.read+=3,e},u.ByteStringBuffer.prototype.getInt32=function(){var e=this.data.charCodeAt(this.read)<<24^this.data.charCodeAt(this.read+1)<<16^this.data.charCodeAt(this.read+2)<<8^this.data.charCodeAt(this.read+3);return this.read+=4,e},u.ByteStringBuffer.prototype.getInt16Le=function(){var e=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8;return this.read+=2,e},u.ByteStringBuffer.prototype.getInt24Le=function(){var e=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16;return this.read+=3,e},u.ByteStringBuffer.prototype.getInt32Le=function(){var e=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16^this.data.charCodeAt(this.read+3)<<24;return this.read+=4,e},u.ByteStringBuffer.prototype.getInt=function(e){l(e);var t=0;do{t=(t<<8)+this.data.charCodeAt(this.read++),e-=8}while(e>0);return t},u.ByteStringBuffer.prototype.getSignedInt=function(e){var t=this.getInt(e),r=2<<e-2;return t>=r&&(t-=r<<1),t},u.ByteStringBuffer.prototype.getBytes=function(e){var t;return e?(e=Math.min(this.length(),e),t=this.data.slice(this.read,this.read+e),this.read+=e):0===e?t="":(t=0===this.read?this.data:this.data.slice(this.read),this.clear()),t},u.ByteStringBuffer.prototype.bytes=function(e){return void 0===e?this.data.slice(this.read):this.data.slice(this.read,this.read+e)},u.ByteStringBuffer.prototype.at=function(e){return this.data.charCodeAt(this.read+e)},u.ByteStringBuffer.prototype.setAt=function(e,t){return this.data=this.data.substr(0,this.read+e)+String.fromCharCode(t)+this.data.substr(this.read+e+1),this},u.ByteStringBuffer.prototype.last=function(){return this.data.charCodeAt(this.data.length-1)},u.ByteStringBuffer.prototype.copy=function(){var e=u.createBuffer(this.data);return e.read=this.read,e},u.ByteStringBuffer.prototype.compact=function(){return this.read>0&&(this.data=this.data.slice(this.read),this.read=0),this},u.ByteStringBuffer.prototype.clear=function(){return this.data="",this.read=0,this},u.ByteStringBuffer.prototype.truncate=function(e){var t=Math.max(0,this.length()-e);return this.data=this.data.substr(this.read,t),this.read=0,this},u.ByteStringBuffer.prototype.toHex=function(){for(var e="",t=this.read;t<this.data.length;++t){var r=this.data.charCodeAt(t);r<16&&(e+="0"),e+=r.toString(16)}return e},u.ByteStringBuffer.prototype.toString=function(){return u.decodeUtf8(this.bytes())},u.DataBuffer=function(e,t){t=t||{},this.read=t.readOffset||0,this.growSize=t.growSize||1024;var r=u.isArrayBuffer(e),n=u.isArrayBufferView(e);if(r||n)return this.data=r?new DataView(e):new DataView(e.buffer,e.byteOffset,e.byteLength),void(this.write="writeOffset"in t?t.writeOffset:this.data.byteLength);this.data=new DataView(new ArrayBuffer(0)),this.write=0,null!=e&&this.putBytes(e),"writeOffset"in t&&(this.write=t.writeOffset)},u.DataBuffer.prototype.length=function(){return this.write-this.read},u.DataBuffer.prototype.isEmpty=function(){return this.length()<=0},u.DataBuffer.prototype.accommodate=function(e,t){if(this.length()>=e)return this;t=Math.max(t||this.growSize,e);var r=new Uint8Array(this.data.buffer,this.data.byteOffset,this.data.byteLength),n=new Uint8Array(this.length()+t);return n.set(r),this.data=new DataView(n.buffer),this},u.DataBuffer.prototype.putByte=function(e){return this.accommodate(1),this.data.setUint8(this.write++,e),this},u.DataBuffer.prototype.fillWithByte=function(e,t){this.accommodate(t);for(var r=0;r<t;++r)this.data.setUint8(e);return this},u.DataBuffer.prototype.putBytes=function(e,t){if(u.isArrayBufferView(e)){var r=(n=new Uint8Array(e.buffer,e.byteOffset,e.byteLength)).byteLength-n.byteOffset;return this.accommodate(r),new Uint8Array(this.data.buffer,this.write).set(n),this.write+=r,this}if(u.isArrayBuffer(e)){var n=new Uint8Array(e);return this.accommodate(n.byteLength),new Uint8Array(this.data.buffer).set(n,this.write),this.write+=n.byteLength,this}if(e instanceof u.DataBuffer||"object"==typeof e&&"number"==typeof e.read&&"number"==typeof e.write&&u.isArrayBufferView(e.data))return n=new Uint8Array(e.data.byteLength,e.read,e.length()),this.accommodate(n.byteLength),new Uint8Array(e.data.byteLength,this.write).set(n),this.write+=n.byteLength,this;if(e instanceof u.ByteStringBuffer&&(e=e.data,t="binary"),t=t||"binary","string"==typeof e){var a;if("hex"===t)return this.accommodate(Math.ceil(e.length/2)),a=new Uint8Array(this.data.buffer,this.write),this.write+=u.binary.hex.decode(e,a,this.write),this;if("base64"===t)return this.accommodate(3*Math.ceil(e.length/4)),a=new Uint8Array(this.data.buffer,this.write),this.write+=u.binary.base64.decode(e,a,this.write),this;if("utf8"===t&&(e=u.encodeUtf8(e),t="binary"),"binary"===t||"raw"===t)return this.accommodate(e.length),a=new Uint8Array(this.data.buffer,this.write),this.write+=u.binary.raw.decode(a),this;if("utf16"===t)return this.accommodate(2*e.length),a=new Uint16Array(this.data.buffer,this.write),this.write+=u.text.utf16.encode(a),this;throw new Error("Invalid encoding: "+t)}throw Error("Invalid parameter: "+e)},u.DataBuffer.prototype.putBuffer=function(e){return this.putBytes(e),e.clear(),this},u.DataBuffer.prototype.putString=function(e){return this.putBytes(e,"utf16")},u.DataBuffer.prototype.putInt16=function(e){return this.accommodate(2),this.data.setInt16(this.write,e),this.write+=2,this},u.DataBuffer.prototype.putInt24=function(e){return this.accommodate(3),this.data.setInt16(this.write,e>>8&65535),this.data.setInt8(this.write,e>>16&255),this.write+=3,this},u.DataBuffer.prototype.putInt32=function(e){return this.accommodate(4),this.data.setInt32(this.write,e),this.write+=4,this},u.DataBuffer.prototype.putInt16Le=function(e){return this.accommodate(2),this.data.setInt16(this.write,e,!0),this.write+=2,this},u.DataBuffer.prototype.putInt24Le=function(e){return this.accommodate(3),this.data.setInt8(this.write,e>>16&255),this.data.setInt16(this.write,e>>8&65535,!0),this.write+=3,this},u.DataBuffer.prototype.putInt32Le=function(e){return this.accommodate(4),this.data.setInt32(this.write,e,!0),this.write+=4,this},u.DataBuffer.prototype.putInt=function(e,t){l(t),this.accommodate(t/8);do{t-=8,this.data.setInt8(this.write++,e>>t&255)}while(t>0);return this},u.DataBuffer.prototype.putSignedInt=function(e,t){return l(t),this.accommodate(t/8),e<0&&(e+=2<<t-1),this.putInt(e,t)},u.DataBuffer.prototype.getByte=function(){return this.data.getInt8(this.read++)},u.DataBuffer.prototype.getInt16=function(){var e=this.data.getInt16(this.read);return this.read+=2,e},u.DataBuffer.prototype.getInt24=function(){var e=this.data.getInt16(this.read)<<8^this.data.getInt8(this.read+2);return this.read+=3,e},u.DataBuffer.prototype.getInt32=function(){var e=this.data.getInt32(this.read);return this.read+=4,e},u.DataBuffer.prototype.getInt16Le=function(){var e=this.data.getInt16(this.read,!0);return this.read+=2,e},u.DataBuffer.prototype.getInt24Le=function(){var e=this.data.getInt8(this.read)^this.data.getInt16(this.read+1,!0)<<8;return this.read+=3,e},u.DataBuffer.prototype.getInt32Le=function(){var e=this.data.getInt32(this.read,!0);return this.read+=4,e},u.DataBuffer.prototype.getInt=function(e){l(e);var t=0;do{t=(t<<8)+this.data.getInt8(this.read++),e-=8}while(e>0);return t},u.DataBuffer.prototype.getSignedInt=function(e){var t=this.getInt(e),r=2<<e-2;return t>=r&&(t-=r<<1),t},u.DataBuffer.prototype.getBytes=function(e){var t;return e?(e=Math.min(this.length(),e),t=this.data.slice(this.read,this.read+e),this.read+=e):0===e?t="":(t=0===this.read?this.data:this.data.slice(this.read),this.clear()),t},u.DataBuffer.prototype.bytes=function(e){return void 0===e?this.data.slice(this.read):this.data.slice(this.read,this.read+e)},u.DataBuffer.prototype.at=function(e){return this.data.getUint8(this.read+e)},u.DataBuffer.prototype.setAt=function(e,t){return this.data.setUint8(e,t),this},u.DataBuffer.prototype.last=function(){return this.data.getUint8(this.write-1)},u.DataBuffer.prototype.copy=function(){return new u.DataBuffer(this)},u.DataBuffer.prototype.compact=function(){if(this.read>0){var e=new Uint8Array(this.data.buffer,this.read),t=new Uint8Array(e.byteLength);t.set(e),this.data=new DataView(t),this.write-=this.read,this.read=0}return this},u.DataBuffer.prototype.clear=function(){return this.data=new DataView(new ArrayBuffer(0)),this.read=this.write=0,this},u.DataBuffer.prototype.truncate=function(e){return this.write=Math.max(0,this.length()-e),this.read=Math.min(this.read,this.write),this},u.DataBuffer.prototype.toHex=function(){for(var e="",t=this.read;t<this.data.byteLength;++t){var r=this.data.getUint8(t);r<16&&(e+="0"),e+=r.toString(16)}return e},u.DataBuffer.prototype.toString=function(e){var t=new Uint8Array(this.data,this.read,this.length());if("binary"===(e=e||"utf8")||"raw"===e)return u.binary.raw.encode(t);if("hex"===e)return u.binary.hex.encode(t);if("base64"===e)return u.binary.base64.encode(t);if("utf8"===e)return u.text.utf8.decode(t);if("utf16"===e)return u.text.utf16.decode(t);throw new Error("Invalid encoding: "+e)},u.createBuffer=function(e,t){return t=t||"raw",void 0!==e&&"utf8"===t&&(e=u.encodeUtf8(e)),new u.ByteBuffer(e)},u.fillString=function(e,t){for(var r="";t>0;)1&t&&(r+=e),(t>>>=1)>0&&(e+=e);return r},u.xorBytes=function(e,t,r){for(var n="",a="",i="",s=0,o=0;r>0;--r,++s)a=e.charCodeAt(s)^t.charCodeAt(s),o>=10&&(n+=i,i="",o=0),i+=String.fromCharCode(a),++o;return n+i},u.hexToBytes=function(e){var t="",r=0;for(!0&e.length&&(r=1,t+=String.fromCharCode(parseInt(e[0],16)));r<e.length;r+=2)t+=String.fromCharCode(parseInt(e.substr(r,2),16));return t},u.bytesToHex=function(e){return u.createBuffer(e).toHex()},u.int32ToBytes=function(e){return String.fromCharCode(e>>24&255)+String.fromCharCode(e>>16&255)+String.fromCharCode(e>>8&255)+String.fromCharCode(255&e)};var p="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",d=[62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,64,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51],y="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";u.encode64=function(e,t){for(var r,n,a,i="",s="",o=0;o<e.length;)r=e.charCodeAt(o++),n=e.charCodeAt(o++),a=e.charCodeAt(o++),i+=p.charAt(r>>2),i+=p.charAt((3&r)<<4|n>>4),isNaN(n)?i+="==":(i+=p.charAt((15&n)<<2|a>>6),i+=isNaN(a)?"=":p.charAt(63&a)),t&&i.length>t&&(s+=i.substr(0,t)+"\r\n",i=i.substr(t));return s+i},u.decode64=function(e){e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");for(var t,r,n,a,i="",s=0;s<e.length;)t=d[e.charCodeAt(s++)-43],r=d[e.charCodeAt(s++)-43],n=d[e.charCodeAt(s++)-43],a=d[e.charCodeAt(s++)-43],i+=String.fromCharCode(t<<2|r>>4),64!==n&&(i+=String.fromCharCode((15&r)<<4|n>>2),64!==a&&(i+=String.fromCharCode((3&n)<<6|a)));return i},u.encodeUtf8=function(e){return unescape(encodeURIComponent(e))},u.decodeUtf8=function(e){return decodeURIComponent(escape(e))},u.binary={raw:{},hex:{},base64:{},base58:{},baseN:{encode:f.encode,decode:f.decode}},u.binary.raw.encode=function(e){return String.fromCharCode.apply(null,e)},u.binary.raw.decode=function(e,t,r){var n=t;n||(n=new Uint8Array(e.length));for(var a=r=r||0,i=0;i<e.length;++i)n[a++]=e.charCodeAt(i);return t?a-r:n},u.binary.hex.encode=u.bytesToHex,u.binary.hex.decode=function(e,t,r){var n=t;n||(n=new Uint8Array(Math.ceil(e.length/2)));var a=0,i=r=r||0;for(1&e.length&&(a=1,n[i++]=parseInt(e[0],16));a<e.length;a+=2)n[i++]=parseInt(e.substr(a,2),16);return t?i-r:n},u.binary.base64.encode=function(e,t){for(var r,n,a,i="",s="",o=0;o<e.byteLength;)r=e[o++],n=e[o++],a=e[o++],i+=p.charAt(r>>2),i+=p.charAt((3&r)<<4|n>>4),isNaN(n)?i+="==":(i+=p.charAt((15&n)<<2|a>>6),i+=isNaN(a)?"=":p.charAt(63&a)),t&&i.length>t&&(s+=i.substr(0,t)+"\r\n",i=i.substr(t));return s+i},u.binary.base64.decode=function(e,t,r){var n,a,i,s,o=t;o||(o=new Uint8Array(3*Math.ceil(e.length/4))),e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");for(var u=0,c=r=r||0;u<e.length;)n=d[e.charCodeAt(u++)-43],a=d[e.charCodeAt(u++)-43],i=d[e.charCodeAt(u++)-43],s=d[e.charCodeAt(u++)-43],o[c++]=n<<2|a>>4,64!==i&&(o[c++]=(15&a)<<4|i>>2,64!==s&&(o[c++]=(3&i)<<6|s));return t?c-r:o.subarray(0,c)},u.binary.base58.encode=function(e,t){return u.binary.baseN.encode(e,y,t)},u.binary.base58.decode=function(e,t){return u.binary.baseN.decode(e,y,t)},u.text={utf8:{},utf16:{}},u.text.utf8.encode=function(e,t,r){e=u.encodeUtf8(e);var n=t;n||(n=new Uint8Array(e.length));for(var a=r=r||0,i=0;i<e.length;++i)n[a++]=e.charCodeAt(i);return t?a-r:n},u.text.utf8.decode=function(e){return u.decodeUtf8(String.fromCharCode.apply(null,e))},u.text.utf16.encode=function(e,t,r){var n=t;n||(n=new Uint8Array(2*e.length));for(var a=new Uint16Array(n.buffer),i=r=r||0,s=r,o=0;o<e.length;++o)a[s++]=e.charCodeAt(o),i+=2;return t?i-r:n},u.text.utf16.decode=function(e){return String.fromCharCode.apply(null,new Uint16Array(e.buffer))},u.deflate=function(e,t,r){if(t=u.decode64(e.deflate(u.encode64(t)).rval),r){var n=2;32&t.charCodeAt(1)&&(n=6),t=t.substring(n,t.length-4)}return t},u.inflate=function(e,t,r){var n=e.inflate(u.encode64(t)).rval;return null===n?null:u.decode64(n)};var g=function(e,t,r){if(!e)throw new Error("WebStorage not available.");var n;if(null===r?n=e.removeItem(t):(r=u.encode64(JSON.stringify(r)),n=e.setItem(t,r)),void 0!==n&&!0!==n.rval){var a=new Error(n.error.message);throw a.id=n.error.id,a.name=n.error.name,a}},m=function(e,t){if(!e)throw new Error("WebStorage not available.");var r=e.getItem(t);if(e.init)if(null===r.rval){if(r.error){var n=new Error(r.error.message);throw n.id=r.error.id,n.name=r.error.name,n}r=null}else r=r.rval;return null!==r&&(r=JSON.parse(u.decode64(r))),r},v=function(e,t,r,n){var a=m(e,t);null===a&&(a={}),a[r]=n,g(e,t,a)},E=function(e,t,r){var n=m(e,t);return null!==n&&(n=r in n?n[r]:null),n},C=function(e,t,r){var n=m(e,t);if(null!==n&&r in n){delete n[r];var a=!0;for(var i in n){a=!1;break}a&&(n=null),g(e,t,n)}},b=function(e,t){g(e,t,null)},S=function(e,t,r){var n,a=null;void 0===r&&(r=["web","flash"]);var i=!1,s=null;for(var o in r){n=r[o];try{if("flash"===n||"both"===n){if(null===t[0])throw new Error("Flash local storage not available.");a=e.apply(this,t),i="flash"===n}"web"!==n&&"both"!==n||(t[0]=localStorage,a=e.apply(this,t),i=!0)}catch(u){s=u}if(i)break}if(!i)throw s;return a};u.setItem=function(e,t,r,n,a){S(v,arguments,a)},u.getItem=function(e,t,r,n){return S(E,arguments,n)},u.removeItem=function(e,t,r,n){S(C,arguments,n)},u.clearItems=function(e,t,r){S(b,arguments,r)},u.parseUrl=function(e){var t=/^(https?):\/\/([^:&^\/]*):?(\d*)(.*)$/g;t.lastIndex=0;var r=t.exec(e),n=null===r?null:{full:e,scheme:r[1],host:r[2],port:r[3],path:r[4]};return n&&(n.fullHost=n.host,n.port?80!==n.port&&"http"===n.scheme?n.fullHost+=":"+n.port:443!==n.port&&"https"===n.scheme&&(n.fullHost+=":"+n.port):"http"===n.scheme?n.port=80:"https"===n.scheme&&(n.port=443),n.full=n.scheme+"://"+n.fullHost),n};var T=null;u.getQueryVariables=function(e){var t,r=function(e){for(var t={},r=e.split("&"),n=0;n<r.length;n++){var a,i,s=r[n].indexOf("=");s>0?(a=r[n].substring(0,s),i=r[n].substring(s+1)):(a=r[n],i=null),a in t||(t[a]=[]),a in Object.prototype||null===i||t[a].push(unescape(i))}return t};return void 0===e?(null===T&&(T="undefined"!=typeof window&&window.location&&window.location.search?r(window.location.search.substring(1)):{}),t=T):t=r(e),t},u.parseFragment=function(e){var t=e,r="",n=e.indexOf("?");n>0&&(t=e.substring(0,n),r=e.substring(n+1));var a=t.split("/");return a.length>0&&""===a[0]&&a.shift(),{pathString:t,queryString:r,path:a,query:""===r?{}:u.getQueryVariables(r)}},u.makeRequest=function(e){var t=u.parseFragment(e),r={path:t.pathString,query:t.queryString,getPath:function(e){return void 0===e?t.path:t.path[e]},getQuery:function(e,r){var n;return void 0===e?n=t.query:(n=t.query[e])&&void 0!==r&&(n=n[r]),n},getQueryLast:function(e,t){var n=r.getQuery(e);return n?n[n.length-1]:t}};return r},u.makeLink=function(e,t,r){e=jQuery.isArray(e)?e.join("/"):e;var n=jQuery.param(t||{});return r=r||"",e+(n.length>0?"?"+n:"")+(r.length>0?"#"+r:"")},u.setPath=function(e,t,r){if("object"==typeof e&&null!==e)for(var n=0,a=t.length;n<a;){var i=t[n++];if(n==a)e[i]=r;else{var s=i in e;(!s||s&&"object"!=typeof e[i]||s&&null===e[i])&&(e[i]={}),e=e[i]}}},u.getPath=function(e,t,r){for(var n=0,a=t.length,i=!0;i&&n<a&&"object"==typeof e&&null!==e;){var s=t[n++];(i=s in e)&&(e=e[s])}return i?e:r},u.deletePath=function(e,t){if("object"==typeof e&&null!==e)for(var r=0,n=t.length;r<n;){var a=t[r++];if(r==n)delete e[a];else{if(!(a in e)||"object"!=typeof e[a]||null===e[a])break;e=e[a]}}},u.isEmpty=function(e){for(var t in e)if(e.hasOwnProperty(t))return!1;return!0},u.format=function(e){for(var t,r,n=/%./g,a=0,i=[],s=0;t=n.exec(e);){(r=e.substring(s,n.lastIndex-2)).length>0&&i.push(r),s=n.lastIndex;var o=t[0][1];switch(o){case"s":case"o":a<arguments.length?i.push(arguments[1+a++]):i.push("<?>");break;case"%":i.push("%");break;default:i.push("<%"+o+"?>")}}return i.push(e.substring(s)),i.join("")},u.formatNumber=function(e,t,r,n){var a=e,i=isNaN(t=Math.abs(t))?2:t,s=void 0===r?",":r,o=void 0===n?".":n,u=a<0?"-":"",c=parseInt(a=Math.abs(+a||0).toFixed(i),10)+"",l=c.length>3?c.length%3:0;return u+(l?c.substr(0,l)+o:"")+c.substr(l).replace(/(\d{3})(?=\d)/g,"$1"+o)+(i?s+Math.abs(a-c).toFixed(i).slice(2):"")},u.formatSize=function(e){return e>=1073741824?u.formatNumber(e/1073741824,2,".","")+" GiB":e>=1048576?u.formatNumber(e/1048576,2,".","")+" MiB":e>=1024?u.formatNumber(e/1024,0)+" KiB":u.formatNumber(e,0)+" bytes"},u.bytesFromIP=function(e){return-1!==e.indexOf(".")?u.bytesFromIPv4(e):-1!==e.indexOf(":")?u.bytesFromIPv6(e):null},u.bytesFromIPv4=function(e){if(4!==(e=e.split(".")).length)return null;for(var t=u.createBuffer(),r=0;r<e.length;++r){var n=parseInt(e[r],10);if(isNaN(n))return null;t.putByte(n)}return t.getBytes()},u.bytesFromIPv6=function(e){for(var t=0,r=2*(8-(e=e.split(":").filter(function(e){return 0===e.length&&++t,!0})).length+t),n=u.createBuffer(),a=0;a<8;++a)if(e[a]&&0!==e[a].length){var i=u.hexToBytes(e[a]);i.length<2&&n.putByte(0),n.putBytes(i)}else n.fillWithByte(0,r),r=0;return n.getBytes()},u.bytesToIP=function(e){return 4===e.length?u.bytesToIPv4(e):16===e.length?u.bytesToIPv6(e):null},u.bytesToIPv4=function(e){if(4!==e.length)return null;for(var t=[],r=0;r<e.length;++r)t.push(e.charCodeAt(r));return t.join(".")},u.bytesToIPv6=function(e){if(16!==e.length)return null;for(var t=[],r=[],n=0,a=0;a<e.length;a+=2){for(var i=u.bytesToHex(e[a]+e[a+1]);"0"===i[0]&&"0"!==i;)i=i.substr(1);if("0"===i){var s=r[r.length-1],o=t.length;s&&o===s.end+1?(s.end=o,s.end-s.start>r[n].end-r[n].start&&(n=r.length-1)):r.push({start:o,end:o})}t.push(i)}if(r.length>0){var c=r[n];c.end-c.start>0&&(t.splice(c.start,c.end-c.start+1,""),0===c.start&&t.unshift(""),7===c.end&&t.push(""))}return t.join(":")},u.estimateCores=function(e,t){if("function"==typeof e&&(t=e,e={}),e=e||{},"cores"in u&&!e.update)return t(null,u.cores);if("undefined"!=typeof navigator&&"hardwareConcurrency"in navigator&&navigator.hardwareConcurrency>0)return u.cores=navigator.hardwareConcurrency,t(null,u.cores);if("undefined"==typeof Worker)return u.cores=1,t(null,u.cores);if("undefined"==typeof Blob)return u.cores=2,t(null,u.cores);var r=URL.createObjectURL(new Blob(["(",function(){self.addEventListener("message",function(e){for(var t=Date.now(),r=t+4;Date.now()<r;);self.postMessage({st:t,et:r})})}.toString(),")()"],{type:"application/javascript"}));!function e(n,a,i){if(0===a){var s=Math.floor(n.reduce(function(e,t){return e+t},0)/n.length);return u.cores=Math.max(1,s),URL.revokeObjectURL(r),t(null,u.cores)}!function(e,t){for(var n=[],a=[],i=0;i<e;++i){var s=new Worker(r);s.addEventListener("message",function(r){if(a.push(r.data),a.length===e){for(var i=0;i<e;++i)n[i].terminate();t(null,a)}}),n.push(s)}for(i=0;i<e;++i)n[i].postMessage(i)}(i,function(t,r){n.push(function(e,t){for(var r=[],n=0;n<e;++n)for(var a=t[n],i=r[n]=[],s=0;s<e;++s)if(n!==s){var o=t[s];(a.st>o.st&&a.st<o.et||o.st>a.st&&o.st<a.et)&&i.push(s)}return r.reduce(function(e,t){return Math.max(e,t.length)},0)}(i,r)),e(n,a-1,i)})}([],5,16)}}).call(this,d,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},l.Buffer,arguments[3],arguments[4],arguments[5],arguments[6],i({}).setImmediate);var N={};Object.defineProperty(N,"__esModule",{value:!0});var k="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz",R=k.split("").reduce(function(e,t,r){return e[t]=r,e},{});N.default={encode:function(e){if(!e.length)return"";for(var t=[0],r=0;r<e.length;r++){for(var n=0;n<t.length;n++)t[n]<<=8;t[0]+=e[r];for(var a=0,i=0;i<t.length;i++)t[i]+=a,a=t[i]/58|0,t[i]%=58;for(;a;)t.push(a%58),a=a/58|0}for(r=0;0===e[r]&&r<e.length-1;r++)t.push(0);return t.reverse().map(function(e){return k[e]}).join("")},decode:function(e){if(!e.length)return new Uint8Array(0);for(var t=[0],r=0;r<e.length;r++){var n=e[r];if(!(n in R))throw'There is no character "'+n+'" in the Base58 sequence!';for(var a=0;a<t.length;a++)t[a]*=58;t[0]+=R[n];var i=0;for(a=0;a<t.length;a++)t[a]+=i,i=t[a]>>8,t[a]&=255;for(;i;)t.push(255&i),i>>=8}for(r=0;"1"===e[r]&&r<e.length-1;r++)t.push(0);return new Uint8Array(t.reverse())}};var U,L,_,P={};Object.defineProperty(P,"__esModule",{value:!0}),P.utf8ArrayToStr=(U=new Array(128),L=String.fromCodePoint||String.fromCharCode,_=[],function(e){var t,r,n=e.length;_.length=0;for(var a=0;a<n;)(r=e[a++])<=127?t=r:r<=223?t=(31&r)<<6|63&e[a++]:r<=239?t=(15&r)<<12|(63&e[a++])<<6|63&e[a++]:String.fromCodePoint?t=(7&r)<<18|(63&e[a++])<<12|(63&e[a++])<<6|63&e[a++]:(t=63,a+=3),_.push(U[t]||(U[t]=L(t)));return _.join("")}),P.strToUtf8Array=function(e){for(var t=[],r=0;r<e.length;r++){var n=e.charCodeAt(r);n<128?t.push(n):n<2048?t.push(192|n>>6,128|63&n):n<55296||n>=57344?t.push(224|n>>12,128|n>>6&63,128|63&n):(r++,n=65536+((1023&n)<<10|1023&e.charCodeAt(r)),t.push(240|n>>18,128|n>>12&63,128|n>>6&63,128|63&n))}return Uint8Array.from(t)};var D={};Object.defineProperty(D,"__esModule",{value:!0});var O=r({}),V=a({});D.Seed={isSeedWithNonce:function(e){return void 0!==e.nonce},toBinary:function(e){return D.Seed.isSeedWithNonce(e)?{seed:D.Seed.toBinary(e.seed).seed,nonce:e.nonce}:{seed:O._fromRawIn(e),nonce:void 0}},toString:function(e){return V.bytesToString(D.Seed.toBinary(e).seed)}};var K={};Object.defineProperty(K,"__esModule",{value:!0}),K.isPublicKey=function(e){return void 0!==e.publicKey},K.isPrivateKey=function(e){return void 0!==e.privateKey};var x;x=c.cipher=c.cipher||{},c.cipher.algorithms=c.cipher.algorithms||{},c.cipher.createCipher=function(e,t){var r=e;if("string"==typeof r&&(r=c.cipher.getAlgorithm(r))&&(r=r()),!r)throw new Error("Unsupported algorithm: "+e);return new c.cipher.BlockCipher({algorithm:r,key:t,decrypt:!1})},c.cipher.createDecipher=function(e,t){var r=e;if("string"==typeof r&&(r=c.cipher.getAlgorithm(r))&&(r=r()),!r)throw new Error("Unsupported algorithm: "+e);return new c.cipher.BlockCipher({algorithm:r,key:t,decrypt:!0})},c.cipher.registerAlgorithm=function(e,t){e=e.toUpperCase(),c.cipher.algorithms[e]=t},c.cipher.getAlgorithm=function(e){return(e=e.toUpperCase())in c.cipher.algorithms?c.cipher.algorithms[e]:null};var M=c.cipher.BlockCipher=function(e){this.algorithm=e.algorithm,this.mode=this.algorithm.mode,this.blockSize=this.mode.blockSize,this._finish=!1,this._input=null,this.output=null,this._op=e.decrypt?this.mode.decrypt:this.mode.encrypt,this._decrypt=e.decrypt,this.algorithm.initialize(e)};M.prototype.start=function(e){e=e||{};var t={};for(var r in e)t[r]=e[r];t.decrypt=this._decrypt,this._finish=!1,this._input=c.util.createBuffer(),this.output=e.output||c.util.createBuffer(),this.mode.start(t)},M.prototype.update=function(e){for(e&&this._input.putBuffer(e);!this._op.call(this.mode,this._input,this.output,this._finish)&&!this._finish;);this._input.compact()},M.prototype.finish=function(e){!e||"ECB"!==this.mode.name&&"CBC"!==this.mode.name||(this.mode.pad=function(t){return e(this.blockSize,t,!1)},this.mode.unpad=function(t){return e(this.blockSize,t,!0)});var t={};return t.decrypt=this._decrypt,t.overflow=this._input.length()%this.blockSize,!(!this._decrypt&&this.mode.pad&&!this.mode.pad(this._input,t)||(this._finish=!0,this.update(),this._decrypt&&this.mode.unpad&&!this.mode.unpad(this.output,t)||this.mode.afterFinish&&!this.mode.afterFinish(this.output,t)))};c.cipher=c.cipher||{};var j=c.cipher.modes=c.cipher.modes||{};function F(e){if("string"==typeof e&&(e=c.util.createBuffer(e)),c.util.isArray(e)&&e.length>4){var t=e;e=c.util.createBuffer();for(var r=0;r<t.length;++r)e.putByte(t[r])}return c.util.isArray(e)||(e=[e.getInt32(),e.getInt32(),e.getInt32(),e.getInt32()]),e}function z(e){e[e.length-1]=e[e.length-1]+1&4294967295}function q(e){return[e/4294967296|0,4294967295&e]}j.ecb=function(e){e=e||{},this.name="ECB",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)},j.ecb.prototype.start=function(e){},j.ecb.prototype.encrypt=function(e,t,r){if(e.length()<this.blockSize&&!(r&&e.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=e.getInt32();for(this.cipher.encrypt(this._inBlock,this._outBlock),n=0;n<this._ints;++n)t.putInt32(this._outBlock[n])},j.ecb.prototype.decrypt=function(e,t,r){if(e.length()<this.blockSize&&!(r&&e.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=e.getInt32();for(this.cipher.decrypt(this._inBlock,this._outBlock),n=0;n<this._ints;++n)t.putInt32(this._outBlock[n])},j.ecb.prototype.pad=function(e,t){var r=e.length()===this.blockSize?this.blockSize:this.blockSize-e.length();return e.fillWithByte(r,r),!0},j.ecb.prototype.unpad=function(e,t){if(t.overflow>0)return!1;var r=e.length(),n=e.at(r-1);return!(n>this.blockSize<<2||(e.truncate(n),0))},j.cbc=function(e){e=e||{},this.name="CBC",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)},j.cbc.prototype.start=function(e){if(null===e.iv){if(!this._prev)throw new Error("Invalid IV parameter.");this._iv=this._prev.slice(0)}else{if(!("iv"in e))throw new Error("Invalid IV parameter.");this._iv=F(e.iv),this._prev=this._iv.slice(0)}},j.cbc.prototype.encrypt=function(e,t,r){if(e.length()<this.blockSize&&!(r&&e.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=this._prev[n]^e.getInt32();for(this.cipher.encrypt(this._inBlock,this._outBlock),n=0;n<this._ints;++n)t.putInt32(this._outBlock[n]);this._prev=this._outBlock},j.cbc.prototype.decrypt=function(e,t,r){if(e.length()<this.blockSize&&!(r&&e.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=e.getInt32();for(this.cipher.decrypt(this._inBlock,this._outBlock),n=0;n<this._ints;++n)t.putInt32(this._prev[n]^this._outBlock[n]);this._prev=this._inBlock.slice(0)},j.cbc.prototype.pad=function(e,t){var r=e.length()===this.blockSize?this.blockSize:this.blockSize-e.length();return e.fillWithByte(r,r),!0},j.cbc.prototype.unpad=function(e,t){if(t.overflow>0)return!1;var r=e.length(),n=e.at(r-1);return!(n>this.blockSize<<2||(e.truncate(n),0))},j.cfb=function(e){e=e||{},this.name="CFB",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialBlock=new Array(this._ints),this._partialOutput=c.util.createBuffer(),this._partialBytes=0},j.cfb.prototype.start=function(e){if(!("iv"in e))throw new Error("Invalid IV parameter.");this._iv=F(e.iv),this._inBlock=this._iv.slice(0),this._partialBytes=0},j.cfb.prototype.encrypt=function(e,t,r){var n=e.length();if(0===n)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),0===this._partialBytes&&n>=this.blockSize)for(var a=0;a<this._ints;++a)this._inBlock[a]=e.getInt32()^this._outBlock[a],t.putInt32(this._inBlock[a]);else{var i=(this.blockSize-n)%this.blockSize;for(i>0&&(i=this.blockSize-i),this._partialOutput.clear(),a=0;a<this._ints;++a)this._partialBlock[a]=e.getInt32()^this._outBlock[a],this._partialOutput.putInt32(this._partialBlock[a]);if(i>0)e.read-=this.blockSize;else for(a=0;a<this._ints;++a)this._inBlock[a]=this._partialBlock[a];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),i>0&&!r)return t.putBytes(this._partialOutput.getBytes(i-this._partialBytes)),this._partialBytes=i,!0;t.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0}},j.cfb.prototype.decrypt=function(e,t,r){var n=e.length();if(0===n)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),0===this._partialBytes&&n>=this.blockSize)for(var a=0;a<this._ints;++a)this._inBlock[a]=e.getInt32(),t.putInt32(this._inBlock[a]^this._outBlock[a]);else{var i=(this.blockSize-n)%this.blockSize;for(i>0&&(i=this.blockSize-i),this._partialOutput.clear(),a=0;a<this._ints;++a)this._partialBlock[a]=e.getInt32(),this._partialOutput.putInt32(this._partialBlock[a]^this._outBlock[a]);if(i>0)e.read-=this.blockSize;else for(a=0;a<this._ints;++a)this._inBlock[a]=this._partialBlock[a];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),i>0&&!r)return t.putBytes(this._partialOutput.getBytes(i-this._partialBytes)),this._partialBytes=i,!0;t.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0}},j.ofb=function(e){e=e||{},this.name="OFB",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=c.util.createBuffer(),this._partialBytes=0},j.ofb.prototype.start=function(e){if(!("iv"in e))throw new Error("Invalid IV parameter.");this._iv=F(e.iv),this._inBlock=this._iv.slice(0),this._partialBytes=0},j.ofb.prototype.encrypt=function(e,t,r){var n=e.length();if(0===e.length())return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),0===this._partialBytes&&n>=this.blockSize)for(var a=0;a<this._ints;++a)t.putInt32(e.getInt32()^this._outBlock[a]),this._inBlock[a]=this._outBlock[a];else{var i=(this.blockSize-n)%this.blockSize;for(i>0&&(i=this.blockSize-i),this._partialOutput.clear(),a=0;a<this._ints;++a)this._partialOutput.putInt32(e.getInt32()^this._outBlock[a]);if(i>0)e.read-=this.blockSize;else for(a=0;a<this._ints;++a)this._inBlock[a]=this._outBlock[a];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),i>0&&!r)return t.putBytes(this._partialOutput.getBytes(i-this._partialBytes)),this._partialBytes=i,!0;t.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0}},j.ofb.prototype.decrypt=j.ofb.prototype.encrypt,j.ctr=function(e){e=e||{},this.name="CTR",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=c.util.createBuffer(),this._partialBytes=0},j.ctr.prototype.start=function(e){if(!("iv"in e))throw new Error("Invalid IV parameter.");this._iv=F(e.iv),this._inBlock=this._iv.slice(0),this._partialBytes=0},j.ctr.prototype.encrypt=function(e,t,r){var n=e.length();if(0===n)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),0===this._partialBytes&&n>=this.blockSize)for(var a=0;a<this._ints;++a)t.putInt32(e.getInt32()^this._outBlock[a]);else{var i=(this.blockSize-n)%this.blockSize;for(i>0&&(i=this.blockSize-i),this._partialOutput.clear(),a=0;a<this._ints;++a)this._partialOutput.putInt32(e.getInt32()^this._outBlock[a]);if(i>0&&(e.read-=this.blockSize),this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),i>0&&!r)return t.putBytes(this._partialOutput.getBytes(i-this._partialBytes)),this._partialBytes=i,!0;t.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0}z(this._inBlock)},j.ctr.prototype.decrypt=j.ctr.prototype.encrypt,j.gcm=function(e){e=e||{},this.name="GCM",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints),this._partialOutput=c.util.createBuffer(),this._partialBytes=0,this._R=3774873600},j.gcm.prototype.start=function(e){if(!("iv"in e))throw new Error("Invalid IV parameter.");var t,r=c.util.createBuffer(e.iv);if(this._cipherLength=0,t="additionalData"in e?c.util.createBuffer(e.additionalData):c.util.createBuffer(),this._tagLength="tagLength"in e?e.tagLength:128,this._tag=null,e.decrypt&&(this._tag=c.util.createBuffer(e.tag).getBytes(),this._tag.length!==this._tagLength/8))throw new Error("Authentication tag does not match tag length.");this._hashBlock=new Array(this._ints),this.tag=null,this._hashSubkey=new Array(this._ints),this.cipher.encrypt([0,0,0,0],this._hashSubkey),this.componentBits=4,this._m=this.generateHashTable(this._hashSubkey,this.componentBits);var n=r.length();if(12===n)this._j0=[r.getInt32(),r.getInt32(),r.getInt32(),1];else{for(this._j0=[0,0,0,0];r.length()>0;)this._j0=this.ghash(this._hashSubkey,this._j0,[r.getInt32(),r.getInt32(),r.getInt32(),r.getInt32()]);this._j0=this.ghash(this._hashSubkey,this._j0,[0,0].concat(q(8*n)))}this._inBlock=this._j0.slice(0),z(this._inBlock),this._partialBytes=0,t=c.util.createBuffer(t),this._aDataLength=q(8*t.length());var a=t.length()%this.blockSize;for(a&&t.fillWithByte(0,this.blockSize-a),this._s=[0,0,0,0];t.length()>0;)this._s=this.ghash(this._hashSubkey,this._s,[t.getInt32(),t.getInt32(),t.getInt32(),t.getInt32()])},j.gcm.prototype.encrypt=function(e,t,r){var n=e.length();if(0===n)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),0===this._partialBytes&&n>=this.blockSize){for(var a=0;a<this._ints;++a)t.putInt32(this._outBlock[a]^=e.getInt32());this._cipherLength+=this.blockSize}else{var i=(this.blockSize-n)%this.blockSize;for(i>0&&(i=this.blockSize-i),this._partialOutput.clear(),a=0;a<this._ints;++a)this._partialOutput.putInt32(e.getInt32()^this._outBlock[a]);if(i<=0||r){if(r){var s=n%this.blockSize;this._cipherLength+=s,this._partialOutput.truncate(this.blockSize-s)}else this._cipherLength+=this.blockSize;for(a=0;a<this._ints;++a)this._outBlock[a]=this._partialOutput.getInt32();this._partialOutput.read-=this.blockSize}if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),i>0&&!r)return e.read-=this.blockSize,t.putBytes(this._partialOutput.getBytes(i-this._partialBytes)),this._partialBytes=i,!0;t.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0}this._s=this.ghash(this._hashSubkey,this._s,this._outBlock),z(this._inBlock)},j.gcm.prototype.decrypt=function(e,t,r){var n=e.length();if(n<this.blockSize&&!(r&&n>0))return!0;this.cipher.encrypt(this._inBlock,this._outBlock),z(this._inBlock),this._hashBlock[0]=e.getInt32(),this._hashBlock[1]=e.getInt32(),this._hashBlock[2]=e.getInt32(),this._hashBlock[3]=e.getInt32(),this._s=this.ghash(this._hashSubkey,this._s,this._hashBlock);for(var a=0;a<this._ints;++a)t.putInt32(this._outBlock[a]^this._hashBlock[a]);n<this.blockSize?this._cipherLength+=n%this.blockSize:this._cipherLength+=this.blockSize},j.gcm.prototype.afterFinish=function(e,t){var r=!0;t.decrypt&&t.overflow&&e.truncate(this.blockSize-t.overflow),this.tag=c.util.createBuffer();var n=this._aDataLength.concat(q(8*this._cipherLength));this._s=this.ghash(this._hashSubkey,this._s,n);var a=[];this.cipher.encrypt(this._j0,a);for(var i=0;i<this._ints;++i)this.tag.putInt32(this._s[i]^a[i]);return this.tag.truncate(this.tag.length()%(this._tagLength/8)),t.decrypt&&this.tag.bytes()!==this._tag&&(r=!1),r},j.gcm.prototype.multiply=function(e,t){for(var r=[0,0,0,0],n=t.slice(0),a=0;a<128;++a)e[a/32|0]&1<<31-a%32&&(r[0]^=n[0],r[1]^=n[1],r[2]^=n[2],r[3]^=n[3]),this.pow(n,n);return r},j.gcm.prototype.pow=function(e,t){for(var r=1&e[3],n=3;n>0;--n)t[n]=e[n]>>>1|(1&e[n-1])<<31;t[0]=e[0]>>>1,r&&(t[0]^=this._R)},j.gcm.prototype.tableMultiply=function(e){for(var t=[0,0,0,0],r=0;r<32;++r){var n=e[r/8|0]>>>4*(7-r%8)&15,a=this._m[r][n];t[0]^=a[0],t[1]^=a[1],t[2]^=a[2],t[3]^=a[3]}return t},j.gcm.prototype.ghash=function(e,t,r){return t[0]^=r[0],t[1]^=r[1],t[2]^=r[2],t[3]^=r[3],this.tableMultiply(t)},j.gcm.prototype.generateHashTable=function(e,t){for(var r=8/t,n=4*r,a=16*r,i=new Array(a),s=0;s<a;++s){var o=[0,0,0,0],u=(n-1-s%n)*t;o[s/n|0]=1<<t-1<<u,i[s]=this.generateSubHashTable(this.multiply(o,e),t)}return i},j.gcm.prototype.generateSubHashTable=function(e,t){var r=1<<t,n=r>>>1,a=new Array(r);a[n]=e.slice(0);for(var i=n>>>1;i>0;)this.pow(a[2*i],a[i]=[]),i>>=1;for(i=2;i<n;){for(var s=1;s<i;++s){var o=a[i],u=a[s];a[i+s]=[o[0]^u[0],o[1]^u[1],o[2]^u[2],o[3]^u[3]]}i*=2}for(a[0]=[0,0,0,0],i=n+1;i<r;++i){var c=a[i^n];a[i]=[e[0]^c[0],e[1]^c[1],e[2]^c[2],e[3]^c[3]]}return a};function G(e,t){c.cipher.registerAlgorithm(e,function(){return new c.aes.Algorithm(e,t)})}c.aes=c.aes||{},c.aes.startEncrypting=function(e,t,r,n){var a=re({key:e,output:r,decrypt:!1,mode:n});return a.start(t),a},c.aes.createEncryptionCipher=function(e,t){return re({key:e,output:null,decrypt:!1,mode:t})},c.aes.startDecrypting=function(e,t,r,n){var a=re({key:e,output:r,decrypt:!0,mode:n});return a.start(t),a},c.aes.createDecryptionCipher=function(e,t){return re({key:e,output:null,decrypt:!0,mode:t})},c.aes.Algorithm=function(e,t){Z||$();var r=this;r.name=e,r.mode=new t({blockSize:16,cipher:{encrypt:function(e,t){return te(r._w,e,t,!1)},decrypt:function(e,t){return te(r._w,e,t,!0)}}}),r._init=!1},c.aes.Algorithm.prototype.initialize=function(e){if(!this._init){var t,r=e.key;if("string"!=typeof r||16!==r.length&&24!==r.length&&32!==r.length){if(c.util.isArray(r)&&(16===r.length||24===r.length||32===r.length)){t=r,r=c.util.createBuffer();for(var n=0;n<t.length;++n)r.putByte(t[n])}}else r=c.util.createBuffer(r);if(!c.util.isArray(r)){t=r,r=[];var a=t.length();if(16===a||24===a||32===a)for(a>>>=2,n=0;n<a;++n)r.push(t.getInt32())}if(!c.util.isArray(r)||4!==r.length&&6!==r.length&&8!==r.length)throw new Error("Invalid key parameter.");var i=this.mode.name,s=-1!==["CFB","OFB","CTR","GCM"].indexOf(i);this._w=ee(r,e.decrypt&&!s),this._init=!0}},c.aes._expandKey=function(e,t){return Z||$(),ee(e,t)},c.aes._updateBlock=te,G("AES-ECB",c.cipher.modes.ecb),G("AES-CBC",c.cipher.modes.cbc),G("AES-CFB",c.cipher.modes.cfb),G("AES-OFB",c.cipher.modes.ofb),G("AES-CTR",c.cipher.modes.ctr),G("AES-GCM",c.cipher.modes.gcm);var Q,H,W,X,Y,Z=!1,J=4;function $(){Z=!0,W=[0,1,2,4,8,16,32,64,128,27,54];for(var e=new Array(256),t=0;t<128;++t)e[t]=t<<1,e[t+128]=t+128<<1^283;for(Q=new Array(256),H=new Array(256),X=new Array(4),Y=new Array(4),t=0;t<4;++t)X[t]=new Array(256),Y[t]=new Array(256);var r,n,a,i,s,o,u,c=0,l=0;for(t=0;t<256;++t){i=(i=l^l<<1^l<<2^l<<3^l<<4)>>8^255&i^99,Q[c]=i,H[i]=c,o=(s=e[i])<<24^i<<16^i<<8^i^s,u=((r=e[c])^(n=e[r])^(a=e[n]))<<24^(c^a)<<16^(c^n^a)<<8^c^r^a;for(var f=0;f<4;++f)X[f][c]=o,Y[f][i]=u,o=o<<24|o>>>8,u=u<<24|u>>>8;0===c?c=l=1:(c=r^e[e[e[r^a]]],l^=e[e[l]])}}function ee(e,t){for(var r,n=e.slice(0),a=1,i=n.length,s=J*(i+6+1),o=i;o<s;++o)r=n[o-1],o%i==0?(r=Q[r>>>16&255]<<24^Q[r>>>8&255]<<16^Q[255&r]<<8^Q[r>>>24]^W[a]<<24,a++):i>6&&o%i==4&&(r=Q[r>>>24]<<24^Q[r>>>16&255]<<16^Q[r>>>8&255]<<8^Q[255&r]),n[o]=n[o-i]^r;if(t){for(var u,c=Y[0],l=Y[1],f=Y[2],h=Y[3],p=n.slice(0),d=(o=0,(s=n.length)-J);o<s;o+=J,d-=J)if(0===o||o===s-J)p[o]=n[d],p[o+1]=n[d+3],p[o+2]=n[d+2],p[o+3]=n[d+1];else for(var y=0;y<J;++y)u=n[d+y],p[o+(3&-y)]=c[Q[u>>>24]]^l[Q[u>>>16&255]]^f[Q[u>>>8&255]]^h[Q[255&u]];n=p}return n}function te(e,t,r,n){var a,i,s,o,u,c,l,f,h,p,d,y,g=e.length/4-1;n?(a=Y[0],i=Y[1],s=Y[2],o=Y[3],u=H):(a=X[0],i=X[1],s=X[2],o=X[3],u=Q),c=t[0]^e[0],l=t[n?3:1]^e[1],f=t[2]^e[2],h=t[n?1:3]^e[3];for(var m=3,v=1;v<g;++v)p=a[c>>>24]^i[l>>>16&255]^s[f>>>8&255]^o[255&h]^e[++m],d=a[l>>>24]^i[f>>>16&255]^s[h>>>8&255]^o[255&c]^e[++m],y=a[f>>>24]^i[h>>>16&255]^s[c>>>8&255]^o[255&l]^e[++m],h=a[h>>>24]^i[c>>>16&255]^s[l>>>8&255]^o[255&f]^e[++m],c=p,l=d,f=y;r[0]=u[c>>>24]<<24^u[l>>>16&255]<<16^u[f>>>8&255]<<8^u[255&h]^e[++m],r[n?3:1]=u[l>>>24]<<24^u[f>>>16&255]<<16^u[h>>>8&255]<<8^u[255&c]^e[++m],r[2]=u[f>>>24]<<24^u[h>>>16&255]<<16^u[c>>>8&255]<<8^u[255&l]^e[++m],r[n?1:3]=u[h>>>24]<<24^u[c>>>16&255]<<16^u[l>>>8&255]<<8^u[255&f]^e[++m]}function re(e){var t,r="AES-"+((e=e||{}).mode||"CBC").toUpperCase(),n=(t=e.decrypt?c.cipher.createDecipher(r,e.key):c.cipher.createCipher(r,e.key)).start;return t.start=function(e,r){var a=null;r instanceof c.util.ByteBuffer&&(a=r,r={}),(r=r||{}).output=a,r.iv=e,n.call(t,r)},t}var ne;ne=c.md=c.md||{},c.md.algorithms=c.md.algorithms||{};var ae=c.sha256=c.sha256||{};c.md.sha256=c.md.algorithms.sha256=ae,ae.create=function(){se||(ie=String.fromCharCode(128),ie+=c.util.fillString(String.fromCharCode(0),64),oe=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],se=!0);var e=null,t=c.util.createBuffer(),r=new Array(64),n={algorithm:"sha256",blockLength:64,digestLength:32,messageLength:0,fullMessageLength:null,messageLengthSize:8,start:function(){n.messageLength=0,n.fullMessageLength=n.messageLength64=[];for(var r=n.messageLengthSize/4,a=0;a<r;++a)n.fullMessageLength.push(0);return t=c.util.createBuffer(),e={h0:1779033703,h1:3144134277,h2:1013904242,h3:2773480762,h4:1359893119,h5:2600822924,h6:528734635,h7:1541459225},n}};return n.start(),n.update=function(a,i){"utf8"===i&&(a=c.util.encodeUtf8(a));var s=a.length;n.messageLength+=s,s=[s/4294967296>>>0,s>>>0];for(var o=n.fullMessageLength.length-1;o>=0;--o)n.fullMessageLength[o]+=s[1],s[1]=s[0]+(n.fullMessageLength[o]/4294967296>>>0),n.fullMessageLength[o]=n.fullMessageLength[o]>>>0,s[0]=s[1]/4294967296>>>0;return t.putBytes(a),ue(e,r,t),(t.read>2048||0===t.length())&&t.compact(),n},n.digest=function(){var a=c.util.createBuffer();a.putBytes(t.bytes());var i,s=n.fullMessageLength[n.fullMessageLength.length-1]+n.messageLengthSize&n.blockLength-1;a.putBytes(ie.substr(0,n.blockLength-s));for(var o=8*n.fullMessageLength[0],u=0;u<n.fullMessageLength.length-1;++u)o+=(i=8*n.fullMessageLength[u+1])/4294967296>>>0,a.putInt32(o>>>0),o=i>>>0;a.putInt32(o);var l={h0:e.h0,h1:e.h1,h2:e.h2,h3:e.h3,h4:e.h4,h5:e.h5,h6:e.h6,h7:e.h7};ue(l,r,a);var f=c.util.createBuffer();return f.putInt32(l.h0),f.putInt32(l.h1),f.putInt32(l.h2),f.putInt32(l.h3),f.putInt32(l.h4),f.putInt32(l.h5),f.putInt32(l.h6),f.putInt32(l.h7),f},n};var ie=null,se=!1,oe=null;function ue(e,t,r){for(var n,a,i,s,o,u,c,l,f,h,p,d,y,g=r.length();g>=64;){for(o=0;o<16;++o)t[o]=r.getInt32();for(;o<64;++o)n=((n=t[o-2])>>>17|n<<15)^(n>>>19|n<<13)^n>>>10,a=((a=t[o-15])>>>7|a<<25)^(a>>>18|a<<14)^a>>>3,t[o]=n+t[o-7]+a+t[o-16]|0;for(u=e.h0,c=e.h1,l=e.h2,f=e.h3,h=e.h4,p=e.h5,d=e.h6,y=e.h7,o=0;o<64;++o)i=(u>>>2|u<<30)^(u>>>13|u<<19)^(u>>>22|u<<10),s=u&c|l&(u^c),n=y+((h>>>6|h<<26)^(h>>>11|h<<21)^(h>>>25|h<<7))+(d^h&(p^d))+oe[o]+t[o],y=d,d=p,p=h,h=f+n>>>0,f=l,l=c,c=u,u=n+(a=i+s)>>>0;e.h0=e.h0+u|0,e.h1=e.h1+c|0,e.h2=e.h2+l|0,e.h3=e.h3+f|0,e.h4=e.h4+h|0,e.h5=e.h5+p|0,e.h6=e.h6+d|0,e.h7=e.h7+y|0,g-=64}}(function(e){var t=null;!c.util.isNodejs||c.options.usePureJavaScript||e.versions["node-webkit"]||(t=l),(c.prng=c.prng||{}).create=function(e){for(var r={plugin:e,key:null,seed:null,time:null,reseeds:0,generated:0,keyBytes:""},n=e.md,a=new Array(32),i=0;i<32;++i)a[i]=n.create();function s(){if(r.pools[0].messageLength>=32)return o();var e=32-r.pools[0].messageLength<<5;r.collect(r.seedFileSync(e)),o()}function o(){r.reseeds=4294967295===r.reseeds?0:r.reseeds+1;var e=r.plugin.md.create();e.update(r.keyBytes);for(var t=1,n=0;n<32;++n)r.reseeds%t==0&&(e.update(r.pools[n].digest().getBytes()),r.pools[n].start()),t<<=1;r.keyBytes=e.digest().getBytes(),e.start(),e.update(r.keyBytes);var a=e.digest().getBytes();r.key=r.plugin.formatKey(r.keyBytes),r.seed=r.plugin.formatSeed(a),r.generated=0}function u(e){var t=null,r=c.util.globalScope,n=r.crypto||r.msCrypto;n&&n.getRandomValues&&(t=function(e){return n.getRandomValues(e)});var a=c.util.createBuffer();if(t)for(;a.length()<e;){var i=Math.max(1,Math.min(e-a.length(),65536)/4),s=new Uint32Array(Math.floor(i));try{t(s);for(var o=0;o<s.length;++o)a.putInt32(s[o])}catch(p){if(!("undefined"!=typeof QuotaExceededError&&p instanceof QuotaExceededError))throw p}}if(a.length()<e)for(var u,l,f,h=Math.floor(65536*Math.random());a.length()<e;)for(l=16807*(65535&h),l+=(32767&(u=16807*(h>>16)))<<16,h=4294967295&(l=(2147483647&(l+=u>>15))+(l>>31)),o=0;o<3;++o)f=h>>>(o<<3),f^=Math.floor(256*Math.random()),a.putByte(String.fromCharCode(255&f));return a.getBytes(e)}return r.pools=a,r.pool=0,r.generate=function(e,t){if(!t)return r.generateSync(e);var n=r.plugin.cipher,a=r.plugin.increment,i=r.plugin.formatKey,s=r.plugin.formatSeed,u=c.util.createBuffer();r.key=null,function l(f){if(f)return t(f);if(u.length()>=e)return t(null,u.getBytes(e));if(r.generated>1048575&&(r.key=null),null===r.key)return c.util.nextTick(function(){!function(e){if(r.pools[0].messageLength>=32)return o(),e();var t=32-r.pools[0].messageLength<<5;r.seedFile(t,function(t,n){if(t)return e(t);r.collect(n),o(),e()})}(l)});var h=n(r.key,r.seed);r.generated+=h.length,u.putBytes(h),r.key=i(n(r.key,a(r.seed))),r.seed=s(n(r.key,r.seed)),c.util.setImmediate(l)}()},r.generateSync=function(e){var t=r.plugin.cipher,n=r.plugin.increment,a=r.plugin.formatKey,i=r.plugin.formatSeed;r.key=null;for(var o=c.util.createBuffer();o.length()<e;){r.generated>1048575&&(r.key=null),null===r.key&&s();var u=t(r.key,r.seed);r.generated+=u.length,o.putBytes(u),r.key=a(t(r.key,n(r.seed))),r.seed=i(t(r.key,r.seed))}return o.getBytes(e)},t?(r.seedFile=function(e,r){t.randomBytes(e,function(e,t){if(e)return r(e);r(null,t.toString())})},r.seedFileSync=function(e){return t.randomBytes(e).toString()}):(r.seedFile=function(e,t){try{t(null,u(e))}catch(r){t(r)}},r.seedFileSync=u),r.collect=function(e){for(var t=e.length,n=0;n<t;++n)r.pools[r.pool].update(e.substr(n,1)),r.pool=31===r.pool?0:r.pool+1},r.collectInt=function(e,t){for(var n="",a=0;a<t;a+=8)n+=String.fromCharCode(e>>a&255);r.collect(n)},r.registerWorker=function(e){e===self?r.seedFile=function(e,t){self.addEventListener("message",function e(r){var n=r.data;n.forge&&n.forge.prng&&(self.removeEventListener("message",e),t(n.forge.prng.err,n.forge.prng.bytes))}),self.postMessage({forge:{prng:{needed:e}}})}:e.addEventListener("message",function(t){var n=t.data;n.forge&&n.forge.prng&&r.seedFile(n.forge.prng.needed,function(t,r){e.postMessage({forge:{prng:{err:t,bytes:r}}})})})},r}}).call(this,d);var ce={};c.random&&c.random.getBytes?ce=c.random:function(e){var t={},r=new Array(4),n=c.util.createBuffer();function a(){var e=c.prng.create(t);return e.getBytes=function(t,r){return e.generate(t,r)},e.getBytesSync=function(t){return e.generate(t)},e}t.formatKey=function(e){var t=c.util.createBuffer(e);return(e=new Array(4))[0]=t.getInt32(),e[1]=t.getInt32(),e[2]=t.getInt32(),e[3]=t.getInt32(),c.aes._expandKey(e,!1)},t.formatSeed=function(e){var t=c.util.createBuffer(e);return(e=new Array(4))[0]=t.getInt32(),e[1]=t.getInt32(),e[2]=t.getInt32(),e[3]=t.getInt32(),e},t.cipher=function(e,t){return c.aes._updateBlock(e,t,r,!1),n.putInt32(r[0]),n.putInt32(r[1]),n.putInt32(r[2]),n.putInt32(r[3]),n.getBytes()},t.increment=function(e){return++e[3],e},t.md=c.md.sha256;var i=a(),s=null,o=c.util.globalScope,u=o.crypto||o.msCrypto;if(u&&u.getRandomValues&&(s=function(e){return u.getRandomValues(e)}),c.options.usePureJavaScript||!c.util.isNodejs&&!s){if("undefined"==typeof window||window.document,i.collectInt(+new Date,32),"undefined"!=typeof navigator){var l="";for(var f in navigator)try{"string"==typeof navigator[f]&&(l+=navigator[f])}catch(h){}i.collect(l),l=null}e&&(e().mousemove(function(e){i.collectInt(e.clientX,16),i.collectInt(e.clientY,16)}),e().keypress(function(e){i.collectInt(e.charCode,8)}))}if(c.random)for(var f in i)c.random[f]=i[f];else c.random=i;c.random.createInstance=a,ce=c.random}("undefined"!=typeof jQuery?jQuery:null);for(var le={toByteArray:function(e){var t,r,n=me(e),a=n[0],i=n[1],s=new pe(function(e,t,r){return 3*(t+r)/4-r}(0,a,i)),o=0,u=i>0?a-4:a;for(r=0;r<u;r+=4)t=he[e.charCodeAt(r)]<<18|he[e.charCodeAt(r+1)]<<12|he[e.charCodeAt(r+2)]<<6|he[e.charCodeAt(r+3)],s[o++]=t>>16&255,s[o++]=t>>8&255,s[o++]=255&t;return 2===i&&(t=he[e.charCodeAt(r)]<<2|he[e.charCodeAt(r+1)]>>4,s[o++]=255&t),1===i&&(t=he[e.charCodeAt(r)]<<10|he[e.charCodeAt(r+1)]<<4|he[e.charCodeAt(r+2)]>>2,s[o++]=t>>8&255,s[o++]=255&t),s},fromByteArray:function(e){for(var t,r=e.length,n=r%3,a=[],i=0,s=r-n;i<s;i+=16383)a.push(ve(e,i,i+16383>s?s:i+16383));return 1===n?(t=e[r-1],a.push(fe[t>>2]+fe[t<<4&63]+"==")):2===n&&(t=(e[r-2]<<8)+e[r-1],a.push(fe[t>>10]+fe[t>>4&63]+fe[t<<2&63]+"=")),a.join("")}},fe=[],he=[],pe="undefined"!=typeof Uint8Array?Uint8Array:Array,de="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",ye=0,ge=de.length;ye<ge;++ye)fe[ye]=de[ye],he[de.charCodeAt(ye)]=ye;function me(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=e.indexOf("=");return-1===r&&(r=t),[r,r===t?0:4-r%4]}function ve(e,t,r){for(var n,a,i=[],s=t;s<r;s+=3)n=(e[s]<<16&16711680)+(e[s+1]<<8&65280)+(255&e[s+2]),i.push(fe[(a=n)>>18&63]+fe[a>>12&63]+fe[a>>6&63]+fe[63&a]);return i.join("")}he["-".charCodeAt(0)]=62,he["_".charCodeAt(0)]=63;var Ee={read:function(e,t,r,n,a){var i,s,o=8*a-n-1,u=(1<<o)-1,c=u>>1,l=-7,f=r?a-1:0,h=r?-1:1,p=e[t+f];for(f+=h,i=p&(1<<-l)-1,p>>=-l,l+=o;l>0;i=256*i+e[t+f],f+=h,l-=8);for(s=i&(1<<-l)-1,i>>=-l,l+=n;l>0;s=256*s+e[t+f],f+=h,l-=8);if(0===i)i=1-c;else{if(i===u)return s?NaN:1/0*(p?-1:1);s+=Math.pow(2,n),i-=c}return(p?-1:1)*s*Math.pow(2,i-n)},write:function(e,t,r,n,a,i){var s,o,u,c=8*i-a-1,l=(1<<c)-1,f=l>>1,h=23===a?Math.pow(2,-24)-Math.pow(2,-77):0,p=n?0:i-1,d=n?1:-1,y=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(o=isNaN(t)?1:0,s=l):(s=Math.floor(Math.log(t)/Math.LN2),t*(u=Math.pow(2,-s))<1&&(s--,u*=2),(t+=s+f>=1?h/u:h*Math.pow(2,1-f))*u>=2&&(s++,u/=2),s+f>=l?(o=0,s=l):s+f>=1?(o=(t*u-1)*Math.pow(2,a),s+=f):(o=t*Math.pow(2,f-1)*Math.pow(2,a),s=0));a>=8;e[r+p]=255&o,p+=d,o/=256,a-=8);for(s=s<<a|o,c+=a;c>0;e[r+p]=255&s,p+=d,s/=256,c-=8);e[r+p-d]|=128*y}},Ce={};(function(e){"use strict";var t=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Ce,"__esModule",{value:!0});var r=t(ce),n=a({}),i=function(e){return n.stringToBytes(r.default.getBytesSync(e),"raw")};Ce.random=function(t,r){switch(r){case"Array8":return Array.from(i(t));case"Array16":return Array.from(Ce.random(t,"Uint16Array"));case"Array32":return Array.from(Ce.random(t,"Uint32Array"));case"Buffer":return function(){try{new e(1)}catch(t){throw new Error("Buffer not supported in this environment. Use Node.js or Browserify for browser support.")}}(),e.from(i(t));case"Uint8Array":return i(t);case"Uint16Array":return new Uint16Array(t).map(function(e){return i(2).reduce(function(e,t,r){return e|t<<8*(1-r)},0)});case"Uint32Array":return new Uint32Array(t).map(function(e){return i(4).reduce(function(e,t,r){return e|t<<8*(1-r)},0)});default:throw new Error(r+" is unsupported.")}},Ce.randomBytes=function(e){return Ce.random(e,"Uint8Array")},Ce.randomSeed=function(e){return void 0===e&&(e=15),Ce.random(e,"Array32").map(function(e){return s.seedWordsList[e%s.seedWordsList.length]}).join(" ")}}).call(this,t({}).Buffer);for(var be={},Se="0123456789abcdef".split(""),Te=[0,8,16,24],Ie=[1,0,32898,0,32906,2147483648,2147516416,2147483648,32907,0,2147483649,0,2147516545,2147483648,32777,2147483648,138,0,136,0,2147516425,0,2147483658,0,2147516555,0,139,2147483648,32905,2147483648,32771,2147483648,32770,2147483648,128,2147483648,32778,0,2147483658,2147483648,2147516545,2147483648,32896,2147483648,2147483649,0,2147516424,2147483648],Ae=[224,256,384,512],we=["hex","buffer","arrayBuffer","array"],Be=function(e,t,r){return function(n){return new Ke(e,t,e).update(n)[r]()}},Ne=function(e,t,r){return function(n,a){return new Ke(e,t,a).update(n)[r]()}},ke=function(e,t){var r=Be(e,t,"hex");r.create=function(){return new Ke(e,t,e)},r.update=function(e){return r.create().update(e)};for(var n=0;n<we.length;++n){var a=we[n];r[a]=Be(e,t,a)}return r},Re=[{name:"keccak",padding:[1,256,65536,16777216],bits:Ae,createMethod:ke},{name:"sha3",padding:[6,1536,393216,100663296],bits:Ae,createMethod:ke},{name:"shake",padding:[31,7936,2031616,520093696],bits:[128,256],createMethod:function(e,t){var r=Ne(e,t,"hex");r.create=function(r){return new Ke(e,t,r)},r.update=function(e,t){return r.create(t).update(e)};for(var n=0;n<we.length;++n){var a=we[n];r[a]=Ne(e,t,a)}return r}}],Ue={},Le=[],_e=0;_e<Re.length;++_e)for(var Pe=Re[_e],De=Pe.bits,Oe=0;Oe<De.length;++Oe){var Ve=Pe.name+"_"+De[Oe];Le.push(Ve),Ue[Ve]=Pe.createMethod(De[Oe],Pe.padding)}function Ke(e,t,r){this.blocks=[],this.s=[],this.padding=t,this.outputBits=r,this.reset=!0,this.block=0,this.start=0,this.blockCount=1600-(e<<1)>>5,this.byteCount=this.blockCount<<2,this.outputBlocks=r>>5,this.extraBytes=(31&r)>>3;for(var n=0;n<50;++n)this.s[n]=0}Ke.prototype.update=function(e){var t="string"!=typeof e;t&&e.constructor===ArrayBuffer&&(e=new Uint8Array(e));for(var r,n,a=e.length,i=this.blocks,s=this.byteCount,o=this.blockCount,u=0,c=this.s;u<a;){if(this.reset)for(this.reset=!1,i[0]=this.block,r=1;r<o+1;++r)i[r]=0;if(t)for(r=this.start;u<a&&r<s;++u)i[r>>2]|=e[u]<<Te[3&r++];else for(r=this.start;u<a&&r<s;++u)(n=e.charCodeAt(u))<128?i[r>>2]|=n<<Te[3&r++]:n<2048?(i[r>>2]|=(192|n>>6)<<Te[3&r++],i[r>>2]|=(128|63&n)<<Te[3&r++]):n<55296||n>=57344?(i[r>>2]|=(224|n>>12)<<Te[3&r++],i[r>>2]|=(128|n>>6&63)<<Te[3&r++],i[r>>2]|=(128|63&n)<<Te[3&r++]):(n=65536+((1023&n)<<10|1023&e.charCodeAt(++u)),i[r>>2]|=(240|n>>18)<<Te[3&r++],i[r>>2]|=(128|n>>12&63)<<Te[3&r++],i[r>>2]|=(128|n>>6&63)<<Te[3&r++],i[r>>2]|=(128|63&n)<<Te[3&r++]);if(this.lastByteIndex=r,r>=s){for(this.start=r-s,this.block=i[o],r=0;r<o;++r)c[r]^=i[r];xe(c),this.reset=!0}else this.start=r}return this},Ke.prototype.finalize=function(){var e=this.blocks,t=this.lastByteIndex,r=this.blockCount,n=this.s;if(e[t>>2]|=this.padding[3&t],this.lastByteIndex===this.byteCount)for(e[0]=e[r],t=1;t<r+1;++t)e[t]=0;for(e[r-1]|=2147483648,t=0;t<r;++t)n[t]^=e[t];xe(n)},Ke.prototype.toString=Ke.prototype.hex=function(){this.finalize();for(var e,t=this.blockCount,r=this.s,n=this.outputBlocks,a=this.extraBytes,i=0,s=0,o="";s<n;){for(i=0;i<t&&s<n;++i,++s)e=r[i],o+=Se[e>>4&15]+Se[15&e]+Se[e>>12&15]+Se[e>>8&15]+Se[e>>20&15]+Se[e>>16&15]+Se[e>>28&15]+Se[e>>24&15];s%t==0&&(xe(r),i=0)}return a&&(e=r[i],a>0&&(o+=Se[e>>4&15]+Se[15&e]),a>1&&(o+=Se[e>>12&15]+Se[e>>8&15]),a>2&&(o+=Se[e>>20&15]+Se[e>>16&15])),o},Ke.prototype.arrayBuffer=function(){this.finalize();var e,t=this.blockCount,r=this.s,n=this.outputBlocks,a=this.extraBytes,i=0,s=0,o=this.outputBits>>3;e=a?new ArrayBuffer(n+1<<2):new ArrayBuffer(o);for(var u=new Uint32Array(e);s<n;){for(i=0;i<t&&s<n;++i,++s)u[s]=r[i];s%t==0&&xe(r)}return a&&(u[i]=r[i],e=e.slice(0,o)),e},Ke.prototype.buffer=Ke.prototype.arrayBuffer,Ke.prototype.digest=Ke.prototype.array=function(){this.finalize();for(var e,t,r=this.blockCount,n=this.s,a=this.outputBlocks,i=this.extraBytes,s=0,o=0,u=[];o<a;){for(s=0;s<r&&o<a;++s,++o)e=o<<2,t=n[s],u[e]=255&t,u[e+1]=t>>8&255,u[e+2]=t>>16&255,u[e+3]=t>>24&255;o%r==0&&xe(n)}return i&&(e=o<<2,t=n[s],i>0&&(u[e]=255&t),i>1&&(u[e+1]=t>>8&255),i>2&&(u[e+2]=t>>16&255)),u};var xe=function(e){var t,r,n,a,i,s,o,u,c,l,f,h,p,d,y,g,m,v,E,C,b,S,T,I,A,w,B,N,k,R,U,L,_,P,D,O,V,K,x,M,j,F,z,q,G,Q,H,W,X,Y,Z,J,$,ee,te,re,ne,ae,ie,se,oe,ue,ce;for(n=0;n<48;n+=2)a=e[0]^e[10]^e[20]^e[30]^e[40],i=e[1]^e[11]^e[21]^e[31]^e[41],s=e[2]^e[12]^e[22]^e[32]^e[42],o=e[3]^e[13]^e[23]^e[33]^e[43],u=e[4]^e[14]^e[24]^e[34]^e[44],c=e[5]^e[15]^e[25]^e[35]^e[45],l=e[6]^e[16]^e[26]^e[36]^e[46],f=e[7]^e[17]^e[27]^e[37]^e[47],t=(h=e[8]^e[18]^e[28]^e[38]^e[48])^(s<<1|o>>>31),r=(p=e[9]^e[19]^e[29]^e[39]^e[49])^(o<<1|s>>>31),e[0]^=t,e[1]^=r,e[10]^=t,e[11]^=r,e[20]^=t,e[21]^=r,e[30]^=t,e[31]^=r,e[40]^=t,e[41]^=r,t=a^(u<<1|c>>>31),r=i^(c<<1|u>>>31),e[2]^=t,e[3]^=r,e[12]^=t,e[13]^=r,e[22]^=t,e[23]^=r,e[32]^=t,e[33]^=r,e[42]^=t,e[43]^=r,t=s^(l<<1|f>>>31),r=o^(f<<1|l>>>31),e[4]^=t,e[5]^=r,e[14]^=t,e[15]^=r,e[24]^=t,e[25]^=r,e[34]^=t,e[35]^=r,e[44]^=t,e[45]^=r,t=u^(h<<1|p>>>31),r=c^(p<<1|h>>>31),e[6]^=t,e[7]^=r,e[16]^=t,e[17]^=r,e[26]^=t,e[27]^=r,e[36]^=t,e[37]^=r,e[46]^=t,e[47]^=r,t=l^(a<<1|i>>>31),r=f^(i<<1|a>>>31),e[8]^=t,e[9]^=r,e[18]^=t,e[19]^=r,e[28]^=t,e[29]^=r,e[38]^=t,e[39]^=r,e[48]^=t,e[49]^=r,d=e[0],y=e[1],Q=e[11]<<4|e[10]>>>28,H=e[10]<<4|e[11]>>>28,N=e[20]<<3|e[21]>>>29,k=e[21]<<3|e[20]>>>29,se=e[31]<<9|e[30]>>>23,oe=e[30]<<9|e[31]>>>23,F=e[40]<<18|e[41]>>>14,z=e[41]<<18|e[40]>>>14,P=e[2]<<1|e[3]>>>31,D=e[3]<<1|e[2]>>>31,g=e[13]<<12|e[12]>>>20,m=e[12]<<12|e[13]>>>20,W=e[22]<<10|e[23]>>>22,X=e[23]<<10|e[22]>>>22,R=e[33]<<13|e[32]>>>19,U=e[32]<<13|e[33]>>>19,ue=e[42]<<2|e[43]>>>30,ce=e[43]<<2|e[42]>>>30,ee=e[5]<<30|e[4]>>>2,te=e[4]<<30|e[5]>>>2,O=e[14]<<6|e[15]>>>26,V=e[15]<<6|e[14]>>>26,v=e[25]<<11|e[24]>>>21,E=e[24]<<11|e[25]>>>21,Y=e[34]<<15|e[35]>>>17,Z=e[35]<<15|e[34]>>>17,L=e[45]<<29|e[44]>>>3,_=e[44]<<29|e[45]>>>3,I=e[6]<<28|e[7]>>>4,A=e[7]<<28|e[6]>>>4,re=e[17]<<23|e[16]>>>9,ne=e[16]<<23|e[17]>>>9,K=e[26]<<25|e[27]>>>7,x=e[27]<<25|e[26]>>>7,C=e[36]<<21|e[37]>>>11,b=e[37]<<21|e[36]>>>11,J=e[47]<<24|e[46]>>>8,$=e[46]<<24|e[47]>>>8,q=e[8]<<27|e[9]>>>5,G=e[9]<<27|e[8]>>>5,w=e[18]<<20|e[19]>>>12,B=e[19]<<20|e[18]>>>12,ae=e[29]<<7|e[28]>>>25,ie=e[28]<<7|e[29]>>>25,M=e[38]<<8|e[39]>>>24,j=e[39]<<8|e[38]>>>24,S=e[48]<<14|e[49]>>>18,T=e[49]<<14|e[48]>>>18,e[0]=d^~g&v,e[1]=y^~m&E,e[10]=I^~w&N,e[11]=A^~B&k,e[20]=P^~O&K,e[21]=D^~V&x,e[30]=q^~Q&W,e[31]=G^~H&X,e[40]=ee^~re&ae,e[41]=te^~ne&ie,e[2]=g^~v&C,e[3]=m^~E&b,e[12]=w^~N&R,e[13]=B^~k&U,e[22]=O^~K&M,e[23]=V^~x&j,e[32]=Q^~W&Y,e[33]=H^~X&Z,e[42]=re^~ae&se,e[43]=ne^~ie&oe,e[4]=v^~C&S,e[5]=E^~b&T,e[14]=N^~R&L,e[15]=k^~U&_,e[24]=K^~M&F,e[25]=x^~j&z,e[34]=W^~Y&J,e[35]=X^~Z&$,e[44]=ae^~se&ue,e[45]=ie^~oe&ce,e[6]=C^~S&d,e[7]=b^~T&y,e[16]=R^~L&I,e[17]=U^~_&A,e[26]=M^~F&P,e[27]=j^~z&D,e[36]=Y^~J&q,e[37]=Z^~$&G,e[46]=se^~ue&ee,e[47]=oe^~ce&te,e[8]=S^~d&g,e[9]=T^~y&m,e[18]=L^~I&w,e[19]=_^~A&B,e[28]=F^~P&O,e[29]=z^~D&V,e[38]=J^~q&Q,e[39]=$^~G&H,e[48]=ue^~ee&re,e[49]=ce^~te&ne,e[0]^=Ie[n],e[1]^=Ie[n+1]};be.keccak256=Ue.keccak_256;var Me={};(Me=c.hmac=c.hmac||{}).create=function(){var e=null,t=null,r=null,n=null,a={start:function(a,i){if(null!==a)if("string"==typeof a){if(!((a=a.toLowerCase())in c.md.algorithms))throw new Error('Unknown hash algorithm "'+a+'"');t=c.md.algorithms[a].create()}else t=a;if(null===i)i=e;else{if("string"==typeof i)i=c.util.createBuffer(i);else if(c.util.isArray(i)){var s=i;i=c.util.createBuffer();for(var o=0;o<s.length;++o)i.putByte(s[o])}var u=i.length();for(u>t.blockLength&&(t.start(),t.update(i.bytes()),i=t.digest()),r=c.util.createBuffer(),n=c.util.createBuffer(),u=i.length(),o=0;o<u;++o)s=i.at(o),r.putByte(54^s),n.putByte(92^s);if(u<t.blockLength)for(s=t.blockLength-u,o=0;o<s;++o)r.putByte(54),n.putByte(92);e=i,r=r.bytes(),n=n.bytes()}t.start(),t.update(r)},update:function(e){t.update(e)},getMac:function(){var e=t.digest().bytes();return t.start(),t.update(n),t.update(e),t.digest()}};return a.digest=a.getMac,a};var je={};(function(e){"use strict";je.__esModule=!0;var t="Input must be an string, Buffer or Uint8Array";function r(e,t,r){var n=e[t]+e[r],a=e[t+1]+e[r+1];n>=4294967296&&a++,e[t]=n,e[t+1]=a}function n(e,t,r,n){var a=e[t]+r;r<0&&(a+=4294967296);var i=e[t+1]+n;a>=4294967296&&i++,e[t]=a,e[t+1]=i}function a(e,t){return e[t]^e[t+1]<<8^e[t+2]<<16^e[t+3]<<24}function i(e,t,a,i,s,o){var l=c[s],f=c[s+1],h=c[o],p=c[o+1];r(u,e,t),n(u,e,l,f);var d=u[i]^u[e],y=u[i+1]^u[e+1];u[i]=y,u[i+1]=d,r(u,a,i),d=u[t]^u[a],y=u[t+1]^u[a+1],u[t]=d>>>24^y<<8,u[t+1]=y>>>24^d<<8,r(u,e,t),n(u,e,h,p),d=u[i]^u[e],y=u[i+1]^u[e+1],u[i]=d>>>16^y<<16,u[i+1]=y>>>16^d<<16,r(u,a,i),d=u[t]^u[a],y=u[t+1]^u[a+1],u[t]=y>>>31^d<<1,u[t+1]=d>>>31^y<<1}var s=new Uint32Array([4089235720,1779033703,2227873595,3144134277,4271175723,1013904242,1595750129,2773480762,2917565137,1359893119,725511199,2600822924,4215389547,528734635,327033209,1541459225]),o=new Uint8Array([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9,12,5,1,15,14,13,4,10,0,7,6,3,9,2,8,11,13,11,7,14,12,1,3,9,5,0,15,4,8,6,2,10,6,15,14,9,11,3,0,8,12,2,13,7,1,4,10,5,10,2,8,4,7,6,1,5,15,11,9,14,3,12,13,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3].map(function(e){return 2*e})),u=new Uint32Array(32),c=new Uint32Array(32);function l(e,t){var r=0;for(r=0;r<16;r++)u[r]=e.h[r],u[r+16]=s[r];for(u[24]=u[24]^e.t,u[25]=u[25]^e.t/4294967296,t&&(u[28]=~u[28],u[29]=~u[29]),r=0;r<32;r++)c[r]=a(e.b,4*r);for(r=0;r<12;r++)i(0,8,16,24,o[16*r+0],o[16*r+1]),i(2,10,18,26,o[16*r+2],o[16*r+3]),i(4,12,20,28,o[16*r+4],o[16*r+5]),i(6,14,22,30,o[16*r+6],o[16*r+7]),i(0,10,20,30,o[16*r+8],o[16*r+9]),i(2,12,22,24,o[16*r+10],o[16*r+11]),i(4,14,16,26,o[16*r+12],o[16*r+13]),i(6,8,18,28,o[16*r+14],o[16*r+15]);for(r=0;r<16;r++)e.h[r]=e.h[r]^u[r]^u[r+16]}function f(e,t){if(0===e||e>64)throw new Error("Illegal output length, expected 0 < length <= 64");if(t&&t.length>64)throw new Error("Illegal key, expected Uint8Array with 0 < length <= 64");for(var r={b:new Uint8Array(128),h:new Uint32Array(16),t:0,c:0,outlen:e},n=0;n<16;n++)r.h[n]=s[n];var a=t?t.length:0;return r.h[0]^=16842752^a<<8^e,t&&(h(r,t),r.c=128),r}function h(e,t){for(var r=0;r<t.length;r++)128===e.c&&(e.t+=e.c,l(e,!1),e.c=0),e.b[e.c++]=t[r]}function p(e){for(e.t+=e.c;e.c<128;)e.b[e.c++]=0;l(e,!0);for(var t=new Uint8Array(e.outlen),r=0;r<e.outlen;r++)t[r]=e.h[r>>2]>>8*(3&r);return t}function d(r,n,a){a=a||64,r=function(r){var n;if(r instanceof Uint8Array)n=r;else if(r instanceof e)n=new Uint8Array(r);else{if("string"!=typeof r)throw new Error(t);n=new Uint8Array(e.from(r,"utf8"))}return n}(r);var i=f(a,n);return h(i,r),p(i)}je.blake2bInit=f,je.blake2bUpdate=h,je.blake2bFinal=p,je.blake2b=d,je.blake2bHex=function(e,t,r){var n;return n=d(e,t,r),Array.prototype.map.call(n,function(e){return(e<16?"0":"")+e.toString(16)}).join("")}}).call(this,t({}).Buffer);var Fe={},ze=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t};Object.defineProperty(Fe,"__esModule",{value:!0});var qe=r({}),Ge=ze(Me),Qe=ze(ne),He=ze(je),We=a({});Fe._hashChain=function(e){return qe._fromIn(Fe.keccak(Fe.blake2b(qe._fromIn(e))))},Fe.sha256=function(e){var t=Qe.algorithms.sha256.create();return t.update(We.bytesToString(e,"raw")),We.stringToBytes(t.digest().getBytes(),"raw")},Fe.blake2b=function(e){return He.blake2b(qe._fromIn(e),null,32)},Fe.keccak=function(e){return qe._fromIn(be.keccak256.array(qe._fromIn(e)))},Fe.hmacSHA256=function(e,t){var r=Ge.create();return r.start("sha256",We.bytesToString(qe._fromIn(t),"raw")),r.update(We.bytesToString(qe._fromIn(e),"raw")),We.stringToBytes(r.digest().getBytes(),"raw")};var Xe={},Ye=this&&this.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,a,i=r.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)s.push(n.value)}catch(o){a={error:o}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(a)throw a.error}}return s},Ze=this&&this.__spread||function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(Ye(arguments[t]));return e};Object.defineProperty(Xe,"__esModule",{value:!0});var Je=r({});Xe.concat=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.reduce(function(e,t){return Uint8Array.from(Ze(e,Je._fromIn(t)))},new Uint8Array(0))},Xe.split=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];var n=t.reduce(function(e,t){return{arr:e.arr.slice(t),r:Ze(e.r,[e.arr.slice(0,t)])}},{arr:Je._fromIn(e),r:[]}),a=n.r,i=n.arr;return Ze(a,[i])};var $e={__esModule:!0},et=Object.create(null),tt=function(e){var t,r=new Float64Array(16);if(e)for(t=0;t<e.length;t++)r[t]=e[t];return r},rt=(new Uint8Array(16),new Uint8Array(32));rt[0]=9;var nt=tt(),at=tt([1]),it=tt([56129,1]),st=tt([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),ot=tt([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),ut=tt([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),ct=tt([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),lt=tt([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function ft(e,t,r,n){e[t]=r>>24&255,e[t+1]=r>>16&255,e[t+2]=r>>8&255,e[t+3]=255&r,e[t+4]=n>>24&255,e[t+5]=n>>16&255,e[t+6]=n>>8&255,e[t+7]=255&n}function ht(e,t,r,n){return function(e,t,r,n,a){var i,s=0;for(i=0;i<32;i++)s|=e[t+i]^r[n+i];return(1&s-1>>>8)-1}(e,t,r,n)}function pt(e,t){for(var r=0;r<16;r++)e[r]=0|t[r]}function dt(e){var t,r,n=1;for(t=0;t<16;t++)r=e[t]+n+65535,n=Math.floor(r/65536),e[t]=r-65536*n;e[0]+=n-1+37*(n-1)}function yt(e,t,r){for(var n,a=~(r-1),i=0;i<16;i++)n=a&(e[i]^t[i]),e[i]^=n,t[i]^=n}function gt(e,t){var r,n,a,i=tt(),s=tt();for(r=0;r<16;r++)s[r]=t[r];for(dt(s),dt(s),dt(s),n=0;n<2;n++){for(i[0]=s[0]-65517,r=1;r<15;r++)i[r]=s[r]-65535-(i[r-1]>>16&1),i[r-1]&=65535;i[15]=s[15]-32767-(i[14]>>16&1),a=i[15]>>16&1,i[14]&=65535,yt(s,i,1-a)}for(r=0;r<16;r++)e[2*r]=255&s[r],e[2*r+1]=s[r]>>8}function mt(e,t){var r=new Uint8Array(32),n=new Uint8Array(32);return gt(r,e),gt(n,t),ht(r,0,n,0)}function vt(e){var t=new Uint8Array(32);return gt(t,e),1&t[0]}function Et(e,t){for(var r=0;r<16;r++)e[r]=t[2*r]+(t[2*r+1]<<8);e[15]&=32767}function Ct(e,t,r){for(var n=0;n<16;n++)e[n]=t[n]+r[n]}function bt(e,t,r){for(var n=0;n<16;n++)e[n]=t[n]-r[n]}function St(e,t,r){var n,a,i=0,s=0,o=0,u=0,c=0,l=0,f=0,h=0,p=0,d=0,y=0,g=0,m=0,v=0,E=0,C=0,b=0,S=0,T=0,I=0,A=0,w=0,B=0,N=0,k=0,R=0,U=0,L=0,_=0,P=0,D=0,O=r[0],V=r[1],K=r[2],x=r[3],M=r[4],j=r[5],F=r[6],z=r[7],q=r[8],G=r[9],Q=r[10],H=r[11],W=r[12],X=r[13],Y=r[14],Z=r[15];i+=(n=t[0])*O,s+=n*V,o+=n*K,u+=n*x,c+=n*M,l+=n*j,f+=n*F,h+=n*z,p+=n*q,d+=n*G,y+=n*Q,g+=n*H,m+=n*W,v+=n*X,E+=n*Y,C+=n*Z,s+=(n=t[1])*O,o+=n*V,u+=n*K,c+=n*x,l+=n*M,f+=n*j,h+=n*F,p+=n*z,d+=n*q,y+=n*G,g+=n*Q,m+=n*H,v+=n*W,E+=n*X,C+=n*Y,b+=n*Z,o+=(n=t[2])*O,u+=n*V,c+=n*K,l+=n*x,f+=n*M,h+=n*j,p+=n*F,d+=n*z,y+=n*q,g+=n*G,m+=n*Q,v+=n*H,E+=n*W,C+=n*X,b+=n*Y,S+=n*Z,u+=(n=t[3])*O,c+=n*V,l+=n*K,f+=n*x,h+=n*M,p+=n*j,d+=n*F,y+=n*z,g+=n*q,m+=n*G,v+=n*Q,E+=n*H,C+=n*W,b+=n*X,S+=n*Y,T+=n*Z,c+=(n=t[4])*O,l+=n*V,f+=n*K,h+=n*x,p+=n*M,d+=n*j,y+=n*F,g+=n*z,m+=n*q,v+=n*G,E+=n*Q,C+=n*H,b+=n*W,S+=n*X,T+=n*Y,I+=n*Z,l+=(n=t[5])*O,f+=n*V,h+=n*K,p+=n*x,d+=n*M,y+=n*j,g+=n*F,m+=n*z,v+=n*q,E+=n*G,C+=n*Q,b+=n*H,S+=n*W,T+=n*X,I+=n*Y,A+=n*Z,f+=(n=t[6])*O,h+=n*V,p+=n*K,d+=n*x,y+=n*M,g+=n*j,m+=n*F,v+=n*z,E+=n*q,C+=n*G,b+=n*Q,S+=n*H,T+=n*W,I+=n*X,A+=n*Y,w+=n*Z,h+=(n=t[7])*O,p+=n*V,d+=n*K,y+=n*x,g+=n*M,m+=n*j,v+=n*F,E+=n*z,C+=n*q,b+=n*G,S+=n*Q,T+=n*H,I+=n*W,A+=n*X,w+=n*Y,B+=n*Z,p+=(n=t[8])*O,d+=n*V,y+=n*K,g+=n*x,m+=n*M,v+=n*j,E+=n*F,C+=n*z,b+=n*q,S+=n*G,T+=n*Q,I+=n*H,A+=n*W,w+=n*X,B+=n*Y,N+=n*Z,d+=(n=t[9])*O,y+=n*V,g+=n*K,m+=n*x,v+=n*M,E+=n*j,C+=n*F,b+=n*z,S+=n*q,T+=n*G,I+=n*Q,A+=n*H,w+=n*W,B+=n*X,N+=n*Y,k+=n*Z,y+=(n=t[10])*O,g+=n*V,m+=n*K,v+=n*x,E+=n*M,C+=n*j,b+=n*F,S+=n*z,T+=n*q,I+=n*G,A+=n*Q,w+=n*H,B+=n*W,N+=n*X,k+=n*Y,R+=n*Z,g+=(n=t[11])*O,m+=n*V,v+=n*K,E+=n*x,C+=n*M,b+=n*j,S+=n*F,T+=n*z,I+=n*q,A+=n*G,w+=n*Q,B+=n*H,N+=n*W,k+=n*X,R+=n*Y,U+=n*Z,m+=(n=t[12])*O,v+=n*V,E+=n*K,C+=n*x,b+=n*M,S+=n*j,T+=n*F,I+=n*z,A+=n*q,w+=n*G,B+=n*Q,N+=n*H,k+=n*W,R+=n*X,U+=n*Y,L+=n*Z,v+=(n=t[13])*O,E+=n*V,C+=n*K,b+=n*x,S+=n*M,T+=n*j,I+=n*F,A+=n*z,w+=n*q,B+=n*G,N+=n*Q,k+=n*H,R+=n*W,U+=n*X,L+=n*Y,_+=n*Z,E+=(n=t[14])*O,C+=n*V,b+=n*K,S+=n*x,T+=n*M,I+=n*j,A+=n*F,w+=n*z,B+=n*q,N+=n*G,k+=n*Q,R+=n*H,U+=n*W,L+=n*X,_+=n*Y,P+=n*Z,C+=(n=t[15])*O,s+=38*(S+=n*K),o+=38*(T+=n*x),u+=38*(I+=n*M),c+=38*(A+=n*j),l+=38*(w+=n*F),f+=38*(B+=n*z),h+=38*(N+=n*q),p+=38*(k+=n*G),d+=38*(R+=n*Q),y+=38*(U+=n*H),g+=38*(L+=n*W),m+=38*(_+=n*X),v+=38*(P+=n*Y),E+=38*(D+=n*Z),i=(n=(i+=38*(b+=n*V))+(a=1)+65535)-65536*(a=Math.floor(n/65536)),s=(n=s+a+65535)-65536*(a=Math.floor(n/65536)),o=(n=o+a+65535)-65536*(a=Math.floor(n/65536)),u=(n=u+a+65535)-65536*(a=Math.floor(n/65536)),c=(n=c+a+65535)-65536*(a=Math.floor(n/65536)),l=(n=l+a+65535)-65536*(a=Math.floor(n/65536)),f=(n=f+a+65535)-65536*(a=Math.floor(n/65536)),h=(n=h+a+65535)-65536*(a=Math.floor(n/65536)),p=(n=p+a+65535)-65536*(a=Math.floor(n/65536)),d=(n=d+a+65535)-65536*(a=Math.floor(n/65536)),y=(n=y+a+65535)-65536*(a=Math.floor(n/65536)),g=(n=g+a+65535)-65536*(a=Math.floor(n/65536)),m=(n=m+a+65535)-65536*(a=Math.floor(n/65536)),v=(n=v+a+65535)-65536*(a=Math.floor(n/65536)),E=(n=E+a+65535)-65536*(a=Math.floor(n/65536)),C=(n=C+a+65535)-65536*(a=Math.floor(n/65536)),i=(n=(i+=a-1+37*(a-1))+(a=1)+65535)-65536*(a=Math.floor(n/65536)),s=(n=s+a+65535)-65536*(a=Math.floor(n/65536)),o=(n=o+a+65535)-65536*(a=Math.floor(n/65536)),u=(n=u+a+65535)-65536*(a=Math.floor(n/65536)),c=(n=c+a+65535)-65536*(a=Math.floor(n/65536)),l=(n=l+a+65535)-65536*(a=Math.floor(n/65536)),f=(n=f+a+65535)-65536*(a=Math.floor(n/65536)),h=(n=h+a+65535)-65536*(a=Math.floor(n/65536)),p=(n=p+a+65535)-65536*(a=Math.floor(n/65536)),d=(n=d+a+65535)-65536*(a=Math.floor(n/65536)),y=(n=y+a+65535)-65536*(a=Math.floor(n/65536)),g=(n=g+a+65535)-65536*(a=Math.floor(n/65536)),m=(n=m+a+65535)-65536*(a=Math.floor(n/65536)),v=(n=v+a+65535)-65536*(a=Math.floor(n/65536)),E=(n=E+a+65535)-65536*(a=Math.floor(n/65536)),C=(n=C+a+65535)-65536*(a=Math.floor(n/65536)),i+=a-1+37*(a-1),e[0]=i,e[1]=s,e[2]=o,e[3]=u,e[4]=c,e[5]=l,e[6]=f,e[7]=h,e[8]=p,e[9]=d,e[10]=y,e[11]=g,e[12]=m,e[13]=v,e[14]=E,e[15]=C}function Tt(e,t){St(e,t,t)}function It(e,t){var r,n=tt();for(r=0;r<16;r++)n[r]=t[r];for(r=253;r>=0;r--)Tt(n,n),2!==r&&4!==r&&St(n,n,t);for(r=0;r<16;r++)e[r]=n[r]}function At(e,t,r){var n,a,i=new Uint8Array(32),s=new Float64Array(80),o=tt(),u=tt(),c=tt(),l=tt(),f=tt(),h=tt();for(a=0;a<31;a++)i[a]=t[a];for(i[31]=127&t[31]|64,i[0]&=248,Et(s,r),a=0;a<16;a++)u[a]=s[a],l[a]=o[a]=c[a]=0;for(o[0]=l[0]=1,a=254;a>=0;--a)yt(o,u,n=i[a>>>3]>>>(7&a)&1),yt(c,l,n),Ct(f,o,c),bt(o,o,c),Ct(c,u,l),bt(u,u,l),Tt(l,f),Tt(h,o),St(o,c,o),St(c,u,f),Ct(f,o,c),bt(o,o,c),Tt(u,o),bt(c,l,h),St(o,c,it),Ct(o,o,l),St(c,c,o),St(o,l,h),St(l,u,s),Tt(u,f),yt(o,u,n),yt(c,l,n);for(a=0;a<16;a++)s[a+16]=o[a],s[a+32]=c[a],s[a+48]=u[a],s[a+64]=l[a];var p=s.subarray(32),d=s.subarray(16);return It(p,p),St(d,d,p),gt(e,d),0}var wt=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];function Bt(e,t,r,n){for(var a,i,s,o,u,c,l,f,h,p,d,y,g,m,v,E,C,b,S,T,I,A,w,B,N,k,R=new Int32Array(16),U=new Int32Array(16),L=e[0],_=e[1],P=e[2],D=e[3],O=e[4],V=e[5],K=e[6],x=e[7],M=t[0],j=t[1],F=t[2],z=t[3],q=t[4],G=t[5],Q=t[6],H=t[7],W=0;n>=128;){for(S=0;S<16;S++)T=8*S+W,R[S]=r[T+0]<<24|r[T+1]<<16|r[T+2]<<8|r[T+3],U[S]=r[T+4]<<24|r[T+5]<<16|r[T+6]<<8|r[T+7];for(S=0;S<80;S++)if(a=L,i=_,s=P,o=D,u=O,c=V,l=K,h=M,p=j,d=F,y=z,g=q,m=G,v=Q,w=65535&(A=H),B=A>>>16,N=65535&(I=x),k=I>>>16,w+=65535&(A=(q>>>14|O<<18)^(q>>>18|O<<14)^(O>>>9|q<<23)),B+=A>>>16,N+=65535&(I=(O>>>14|q<<18)^(O>>>18|q<<14)^(q>>>9|O<<23)),k+=I>>>16,w+=65535&(A=q&G^~q&Q),B+=A>>>16,N+=65535&(I=O&V^~O&K),k+=I>>>16,I=wt[2*S],w+=65535&(A=wt[2*S+1]),B+=A>>>16,N+=65535&I,k+=I>>>16,I=R[S%16],B+=(A=U[S%16])>>>16,N+=65535&I,k+=I>>>16,N+=(B+=(w+=65535&A)>>>16)>>>16,w=65535&(A=b=65535&w|B<<16),B=A>>>16,N=65535&(I=C=65535&N|(k+=N>>>16)<<16),k=I>>>16,w+=65535&(A=(M>>>28|L<<4)^(L>>>2|M<<30)^(L>>>7|M<<25)),B+=A>>>16,N+=65535&(I=(L>>>28|M<<4)^(M>>>2|L<<30)^(M>>>7|L<<25)),k+=I>>>16,B+=(A=M&j^M&F^j&F)>>>16,N+=65535&(I=L&_^L&P^_&P),k+=I>>>16,f=65535&(N+=(B+=(w+=65535&A)>>>16)>>>16)|(k+=N>>>16)<<16,E=65535&w|B<<16,w=65535&(A=y),B=A>>>16,N=65535&(I=o),k=I>>>16,B+=(A=b)>>>16,N+=65535&(I=C),k+=I>>>16,_=a,P=i,D=s,O=o=65535&(N+=(B+=(w+=65535&A)>>>16)>>>16)|(k+=N>>>16)<<16,V=u,K=c,x=l,L=f,j=h,F=p,z=d,q=y=65535&w|B<<16,G=g,Q=m,H=v,M=E,S%16==15)for(T=0;T<16;T++)I=R[T],w=65535&(A=U[T]),B=A>>>16,N=65535&I,k=I>>>16,I=R[(T+9)%16],w+=65535&(A=U[(T+9)%16]),B+=A>>>16,N+=65535&I,k+=I>>>16,C=R[(T+1)%16],w+=65535&(A=((b=U[(T+1)%16])>>>1|C<<31)^(b>>>8|C<<24)^(b>>>7|C<<25)),B+=A>>>16,N+=65535&(I=(C>>>1|b<<31)^(C>>>8|b<<24)^C>>>7),k+=I>>>16,C=R[(T+14)%16],B+=(A=((b=U[(T+14)%16])>>>19|C<<13)^(C>>>29|b<<3)^(b>>>6|C<<26))>>>16,N+=65535&(I=(C>>>19|b<<13)^(b>>>29|C<<3)^C>>>6),k+=I>>>16,k+=(N+=(B+=(w+=65535&A)>>>16)>>>16)>>>16,R[T]=65535&N|k<<16,U[T]=65535&w|B<<16;w=65535&(A=M),B=A>>>16,N=65535&(I=L),k=I>>>16,I=e[0],B+=(A=t[0])>>>16,N+=65535&I,k+=I>>>16,k+=(N+=(B+=(w+=65535&A)>>>16)>>>16)>>>16,e[0]=L=65535&N|k<<16,t[0]=M=65535&w|B<<16,w=65535&(A=j),B=A>>>16,N=65535&(I=_),k=I>>>16,I=e[1],B+=(A=t[1])>>>16,N+=65535&I,k+=I>>>16,k+=(N+=(B+=(w+=65535&A)>>>16)>>>16)>>>16,e[1]=_=65535&N|k<<16,t[1]=j=65535&w|B<<16,w=65535&(A=F),B=A>>>16,N=65535&(I=P),k=I>>>16,I=e[2],B+=(A=t[2])>>>16,N+=65535&I,k+=I>>>16,k+=(N+=(B+=(w+=65535&A)>>>16)>>>16)>>>16,e[2]=P=65535&N|k<<16,t[2]=F=65535&w|B<<16,w=65535&(A=z),B=A>>>16,N=65535&(I=D),k=I>>>16,I=e[3],B+=(A=t[3])>>>16,N+=65535&I,k+=I>>>16,k+=(N+=(B+=(w+=65535&A)>>>16)>>>16)>>>16,e[3]=D=65535&N|k<<16,t[3]=z=65535&w|B<<16,w=65535&(A=q),B=A>>>16,N=65535&(I=O),k=I>>>16,I=e[4],B+=(A=t[4])>>>16,N+=65535&I,k+=I>>>16,k+=(N+=(B+=(w+=65535&A)>>>16)>>>16)>>>16,e[4]=O=65535&N|k<<16,t[4]=q=65535&w|B<<16,w=65535&(A=G),B=A>>>16,N=65535&(I=V),k=I>>>16,I=e[5],B+=(A=t[5])>>>16,N+=65535&I,k+=I>>>16,k+=(N+=(B+=(w+=65535&A)>>>16)>>>16)>>>16,e[5]=V=65535&N|k<<16,t[5]=G=65535&w|B<<16,w=65535&(A=Q),B=A>>>16,N=65535&(I=K),k=I>>>16,I=e[6],B+=(A=t[6])>>>16,N+=65535&I,k+=I>>>16,k+=(N+=(B+=(w+=65535&A)>>>16)>>>16)>>>16,e[6]=K=65535&N|k<<16,t[6]=Q=65535&w|B<<16,w=65535&(A=H),B=A>>>16,N=65535&(I=x),k=I>>>16,I=e[7],B+=(A=t[7])>>>16,N+=65535&I,k+=I>>>16,k+=(N+=(B+=(w+=65535&A)>>>16)>>>16)>>>16,e[7]=x=65535&N|k<<16,t[7]=H=65535&w|B<<16,W+=128,n-=128}return n}function Nt(e,t,r){var n,a=new Int32Array(8),i=new Int32Array(8),s=new Uint8Array(256),o=r;for(a[0]=1779033703,a[1]=3144134277,a[2]=1013904242,a[3]=2773480762,a[4]=1359893119,a[5]=2600822924,a[6]=528734635,a[7]=1541459225,i[0]=4089235720,i[1]=2227873595,i[2]=4271175723,i[3]=1595750129,i[4]=2917565137,i[5]=725511199,i[6]=4215389547,i[7]=327033209,Bt(a,i,t,r),r%=128,n=0;n<r;n++)s[n]=t[o-r+n];for(s[r]=128,s[(r=256-128*(r<112?1:0))-9]=0,ft(s,r-8,o/536870912|0,o<<3),Bt(a,i,s,r),n=0;n<8;n++)ft(e,8*n,a[n],i[n]);return 0}function kt(e,t){var r=tt(),n=tt(),a=tt(),i=tt(),s=tt(),o=tt(),u=tt(),c=tt(),l=tt();bt(r,e[1],e[0]),bt(l,t[1],t[0]),St(r,r,l),Ct(n,e[0],e[1]),Ct(l,t[0],t[1]),St(n,n,l),St(a,e[3],t[3]),St(a,a,ot),St(i,e[2],t[2]),Ct(i,i,i),bt(s,n,r),bt(o,i,a),Ct(u,i,a),Ct(c,n,r),St(e[0],s,o),St(e[1],c,u),St(e[2],u,o),St(e[3],s,c)}function Rt(e,t,r){for(var n=0;n<4;n++)yt(e[n],t[n],r)}function Ut(e,t){var r=tt(),n=tt(),a=tt();It(a,t[2]),St(r,t[0],a),St(n,t[1],a),gt(e,n),e[31]^=vt(r)<<7}function Lt(e,t,r){var n,a;for(pt(e[0],nt),pt(e[1],at),pt(e[2],at),pt(e[3],nt),a=255;a>=0;--a)Rt(e,t,n=r[a/8|0]>>(7&a)&1),kt(t,e),kt(e,e),Rt(e,t,n)}function _t(e,t){var r=[tt(),tt(),tt(),tt()];pt(r[0],ut),pt(r[1],ct),pt(r[2],at),St(r[3],ut,ct),Lt(e,r,t)}var Pt=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function Dt(e,t){var r,n,a,i;for(n=63;n>=32;--n){for(r=0,a=n-32,i=n-12;a<i;++a)t[a]+=r-16*t[n]*Pt[a-(n-32)],r=t[a]+128>>8,t[a]-=256*r;t[a]+=r,t[n]=0}for(r=0,a=0;a<32;a++)t[a]+=r-(t[31]>>4)*Pt[a],r=t[a]>>8,t[a]&=255;for(a=0;a<32;a++)t[a]-=r*Pt[a];for(n=0;n<32;n++)t[n+1]+=t[n]>>8,e[n]=255&t[n]}function Ot(e){var t,r=new Float64Array(64);for(t=0;t<64;t++)r[t]=e[t];for(t=0;t<64;t++)e[t]=0;Dt(e,r)}function Vt(e,t,r,n,a){for(var i=new Uint8Array(64),s=[tt(),tt(),tt(),tt()],o=0;o<32;o++)i[o]=n[o];i[0]&=248,i[31]&=127,i[31]|=64,_t(s,i),Ut(i.subarray(32),s);var u,c=128&i[63];return u=a?function(e,t,r,n,a){new Uint8Array(64);var i,s,o=new Uint8Array(64),u=new Uint8Array(64),c=new Float64Array(64),l=[tt(),tt(),tt(),tt()];for(e[0]=254,i=1;i<32;i++)e[i]=255;for(i=0;i<32;i++)e[32+i]=n[i];for(i=0;i<r;i++)e[64+i]=t[i];for(i=0;i<64;i++)e[r+64+i]=a[i];for(Nt(u,e,r+128),Ot(u),_t(l,u),Ut(e,l),i=0;i<32;i++)e[i+32]=n[32+i];for(Nt(o,e,r+64),Ot(o),i=0;i<64;i++)e[r+64+i]=0;for(i=0;i<64;i++)c[i]=0;for(i=0;i<32;i++)c[i]=u[i];for(i=0;i<32;i++)for(s=0;s<32;s++)c[i+s]+=o[i]*n[s];return Dt(e.subarray(32,r+64),c),r+64}(e,t,r,i,a):function(e,t,r,n){new Uint8Array(64);var a,i,s=new Uint8Array(64),o=new Uint8Array(64),u=new Float64Array(64),c=[tt(),tt(),tt(),tt()];for(a=0;a<r;a++)e[64+a]=t[a];for(a=0;a<32;a++)e[32+a]=n[a];for(Nt(o,e.subarray(32),r+32),Ot(o),_t(c,o),Ut(e,c),a=0;a<32;a++)e[a+32]=n[32+a];for(Nt(s,e,r+64),Ot(s),a=0;a<64;a++)u[a]=0;for(a=0;a<32;a++)u[a]=o[a];for(a=0;a<32;a++)for(i=0;i<32;i++)u[a+i]+=s[a]*n[i];return Dt(e.subarray(32),u),r+64}(e,t,r,i),e[63]|=c,u}function Kt(e,t,r,n){var a=function(e){var t=new Uint8Array(32),r=tt(),n=tt(),a=tt();return Et(r,e),Ct(n,r,at),bt(a,r,at),It(n,n),St(n,n,a),gt(t,n),t}(n);return a[31]|=128&t[63],t[63]&=127,function(e,t,r,n){var a,i=new Uint8Array(32),s=new Uint8Array(64),o=[tt(),tt(),tt(),tt()],u=[tt(),tt(),tt(),tt()];if(r<64)return-1;if(function(e,t){var r=tt(),n=tt(),a=tt(),i=tt(),s=tt(),o=tt(),u=tt();return pt(e[2],at),Et(e[1],t),Tt(a,e[1]),St(i,a,st),bt(a,a,e[2]),Ct(i,e[2],i),Tt(s,i),Tt(o,s),St(u,o,s),St(r,u,a),St(r,r,i),function(e,t){var r,n=tt();for(r=0;r<16;r++)n[r]=t[r];for(r=250;r>=0;r--)Tt(n,n),1!==r&&St(n,n,t);for(r=0;r<16;r++)e[r]=n[r]}(r,r),St(r,r,a),St(r,r,i),St(r,r,i),St(e[0],r,i),Tt(n,e[0]),St(n,n,i),mt(n,a)&&St(e[0],e[0],lt),Tt(n,e[0]),St(n,n,i),mt(n,a)?-1:(vt(e[0])===t[31]>>7&&bt(e[0],nt,e[0]),St(e[3],e[0],e[1]),0)}(u,n))return-1;for(a=0;a<r;a++)e[a]=t[a];for(a=0;a<32;a++)e[a+32]=n[a];if(Nt(s,e,r),Ot(s),Lt(o,u,s),_t(u,t.subarray(32)),kt(o,u),Ut(i,o),r-=64,ht(t,0,i,0)){for(a=0;a<r;a++)e[a]=0;return-1}for(a=0;a<r;a++)e[a]=t[a+64];return r}(e,t,r,a)}function xt(){for(var e,t,r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];for(t=0;t<arguments.length;t++)if("[object Uint8Array]"!==(e=Object.prototype.toString.call(arguments[t])))throw new TypeError("unexpected type "+e+", use Uint8Array")}et.sharedKey=function(e,t){if(xt(t,e),32!==t.length)throw new Error("wrong public key length");if(32!==e.length)throw new Error("wrong secret key length");var r=new Uint8Array(32);return At(r,e,t),r},et.signMessage=function(e,t,r){if(xt(t,e),32!==e.length)throw new Error("wrong secret key length");if(r){if(xt(r),64!==r.length)throw new Error("wrong random data length");var n=new Uint8Array(128+t.length);return Vt(n,t,t.length,e,r),new Uint8Array(n.subarray(0,64+t.length))}var a=new Uint8Array(64+t.length);return Vt(a,t,t.length,e),a},et.openMessage=function(e,t){if(xt(t,e),32!==e.length)throw new Error("wrong public key length");var r=new Uint8Array(t.length),n=Kt(r,t,t.length,e);if(n<0)return null;for(var a=new Uint8Array(n),i=0;i<a.length;i++)a[i]=r[i];return a},et.sign=function(e,t,r){if(xt(e,t),32!==e.length)throw new Error("wrong secret key length");if(r&&(xt(r),64!==r.length))throw new Error("wrong random data length");var n=new Uint8Array((r?128:64)+t.length);Vt(n,t,t.length,e,r);for(var a=new Uint8Array(64),i=0;i<a.length;i++)a[i]=n[i];return a},et.verify=function(e,t,r){if(xt(t,r,e),64!==r.length)throw new Error("wrong signature length");if(32!==e.length)throw new Error("wrong public key length");var n,a=new Uint8Array(64+t.length),i=new Uint8Array(64+t.length);for(n=0;n<64;n++)a[n]=r[n];for(n=0;n<t.length;n++)a[n+64]=t[n];return Kt(i,a,a.length,e)>=0},et.generateKeyPair=function(e){if(xt(e),32!==e.length)throw new Error("wrong seed length");for(var t=new Uint8Array(32),r=new Uint8Array(32),n=0;n<32;n++)t[n]=e[n];return At(r,t,rt),t[0]&=248,t[31]&=127,t[31]|=64,r[31]&=127,{public:r,private:t}},$e.default=et;var Mt={},jt=this&&this.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,a,i=r.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)s.push(n.value)}catch(o){a={error:o}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(a)throw a.error}}return s},Ft=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t},zt=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Mt,"__esModule",{value:!0});var qt=Ft(x),Gt=Ft(B),Qt=r({}),Ht=zt($e),Wt=a({});Mt.aesEncrypt=function(e,t,r,n){void 0===r&&(r="CBC");var a=qt.createCipher("AES-"+r,Wt.bytesToString(Qt._fromIn(t),"raw"));return a.start({iv:n&&Gt.createBuffer(Wt.bytesToString(Qt._fromIn(n),"raw"))}),a.update(Gt.createBuffer(Wt.bytesToString(e,"raw"))),a.finish(),Wt.stringToBytes(a.output.getBytes(),"raw")},Mt.aesDecrypt=function(e,t,r,n){void 0===r&&(r="CBC");var a=qt.createDecipher("AES-"+r,Wt.bytesToString(Qt._fromIn(t),"raw"));a.start({iv:n&&Gt.createBuffer(Wt.bytesToString(Qt._fromIn(n),"raw"))});var i=Gt.createBuffer(Wt.bytesToString(Qt._fromIn(e),"raw"));if(a.update(i),!a.finish())throw new Error("Failed to decrypt data with provided key");return Wt.stringToBytes(a.output.getBytes(),"raw")},Mt.messageEncrypt=function(e,t){var r=Uint8Array.from([1]),n=Ce.randomBytes(32),a=Ce.randomBytes(16),i=Wt.stringToBytes(t),s=Mt.aesEncrypt(i,n,"CTR",a),o=Mt.aesEncrypt(n,e,"ECB"),u=Fe.hmacSHA256(i,n),c=Fe.hmacSHA256(Xe.concat(n,a),e);return Xe.concat(r,o,c,u,a,s)},Mt.messageDecrypt=function(e,t){var r=jt(Xe.split(t,1,48,32,32,16),6),n=(r[0],r[1]),a=r[2],i=r[3],s=r[4],o=r[5],u=Mt.aesDecrypt(n,e,"ECB");if(!Qt._fromIn(Fe.hmacSHA256(Xe.concat(u,s),Qt._fromIn(e))).every(function(e,t){return e===a[t]}))throw new Error("Invalid key");var c=Mt.aesDecrypt(o,u,"CTR",s);if(!Qt._fromIn(Fe.hmacSHA256(c,u)).every(function(e,t){return e===i[t]}))throw new Error("Invalid message");return Wt.bytesToString(c)},Mt.sharedKey=function(e,t,r){var n=Ht.default.sharedKey(Qt._fromIn(e),Qt._fromIn(t)),a=Fe.sha256(Qt._fromRawIn(r));return Fe.hmacSHA256(n,a)};var Xt={},Yt=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Xt,"__esModule",{value:!0});var Zt=r({}),Jt=Yt($e);Xt.seedWithNonce=function(e,t){return{seed:D.Seed.toBinary(e).seed,nonce:t}},Xt.buildAddress=function(e,t){void 0===t&&(t=o.MAIN_NET_CHAIN_ID);var r=[1,"string"==typeof t?t.charCodeAt(0):t],n=Fe._hashChain(e).slice(0,20),a=Xe.concat(r,n),i=Fe._hashChain(a).slice(0,4);return Xe.concat(a,i)},Xt.keyPair=function(e){var t=D.Seed.toBinary(e),r=function(e,t){var r=[0,0,0,0];if(t&&t>0)for(var n=t,a=3;a>=0;a--)r[3-a]=Math.floor(n/Math.pow(2,8*a)),n%=Math.pow(2,8*a);var i=Xe.concat(r,e),s=Fe._hashChain(i);return Fe.sha256(s)}(t.seed,t.nonce),n=Jt.default.generateKeyPair(r);return{privateKey:n.private,publicKey:n.public}},Xt.address=function(e,t){return void 0===t&&(t=o.MAIN_NET_CHAIN_ID),K.isPublicKey(e)?Xt.buildAddress(Zt._fromIn(e.publicKey),t):Xt.address(Xt.keyPair(e),t)},Xt.publicKey=function(e){return K.isPrivateKey(e)?Jt.default.generateKeyPair(Zt._fromIn(e.privateKey)).public:Xt.keyPair(e).publicKey},Xt.privateKey=function(e){return Xt.keyPair(e).privateKey};var $t={},er=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty($t,"__esModule",{value:!0});var tr=er($e),rr=r({});$t.signBytes=function(e,t,r){return tr.default.sign(rr._fromIn(K.isPrivateKey(e)?e.privateKey:Xt.privateKey(e)),rr._fromIn(t),rr._fromIn(r||Ce.randomBytes(64)))};var nr={},ar=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(nr,"__esModule",{value:!0});var ir=r({}),sr=ar($e);nr.verifyAddress=function(e,t){var r=t?t.chainId:void 0;try{var n=ir._fromIn(e);if(1!=n[0]||r&&n[1]!=u.ChaidId.toNumber(r))return!1;for(var a=n.slice(0,22),i=n.slice(22,26),s=Fe._hashChain(a).slice(0,4),o=0;o<4;o++)if(i[o]!=s[o])return!1;if(t&&t.publicKey){var c=Xt.address({publicKey:t.publicKey},r);if(n.length!==c.length)return!1;for(o=0;o<c.length;o++)if(c[o]!==n[o])return!1}}catch(l){return!1}return!0},nr.verifySignature=function(e,t,r){try{return sr.default.verify(ir._fromIn(e),ir._fromIn(t),ir._fromIn(r))}catch(n){return!1}},nr.verifyPublicKey=function(e){return ir._fromIn(e).length===o.PUBLIC_KEY_LENGTH};c.pki=c.pki||{};var or=c.pki.oids=c.oids=c.oids||{};function ur(e,t){or[e]=t,or[t]=e}function cr(e,t){or[e]=t}ur("1.2.840.113549.1.1.1","rsaEncryption"),ur("1.2.840.113549.1.1.4","md5WithRSAEncryption"),ur("1.2.840.113549.1.1.5","sha1WithRSAEncryption"),ur("1.2.840.113549.1.1.7","RSAES-OAEP"),ur("1.2.840.113549.1.1.8","mgf1"),ur("1.2.840.113549.1.1.9","pSpecified"),ur("1.2.840.113549.1.1.10","RSASSA-PSS"),ur("1.2.840.113549.1.1.11","sha256WithRSAEncryption"),ur("1.2.840.113549.1.1.12","sha384WithRSAEncryption"),ur("1.2.840.113549.1.1.13","sha512WithRSAEncryption"),ur("1.2.840.10040.4.3","dsa-with-sha1"),ur("1.3.14.3.2.7","desCBC"),ur("1.3.14.3.2.26","sha1"),ur("2.16.840.1.101.3.4.2.1","sha256"),ur("2.16.840.1.101.3.4.2.2","sha384"),ur("2.16.840.1.101.3.4.2.3","sha512"),ur("1.2.840.113549.2.5","md5"),ur("1.2.840.113549.1.7.1","data"),ur("1.2.840.113549.1.7.2","signedData"),ur("1.2.840.113549.1.7.3","envelopedData"),ur("1.2.840.113549.1.7.4","signedAndEnvelopedData"),ur("1.2.840.113549.1.7.5","digestedData"),ur("1.2.840.113549.1.7.6","encryptedData"),ur("1.2.840.113549.1.9.1","emailAddress"),ur("1.2.840.113549.1.9.2","unstructuredName"),ur("1.2.840.113549.1.9.3","contentType"),ur("1.2.840.113549.1.9.4","messageDigest"),ur("1.2.840.113549.1.9.5","signingTime"),ur("1.2.840.113549.1.9.6","counterSignature"),ur("1.2.840.113549.1.9.7","challengePassword"),ur("1.2.840.113549.1.9.8","unstructuredAddress"),ur("1.2.840.113549.1.9.14","extensionRequest"),ur("1.2.840.113549.1.9.20","friendlyName"),ur("1.2.840.113549.1.9.21","localKeyId"),ur("1.2.840.113549.1.9.22.1","x509Certificate"),ur("1.2.840.113549.1.12.10.1.1","keyBag"),ur("1.2.840.113549.1.12.10.1.2","pkcs8ShroudedKeyBag"),ur("1.2.840.113549.1.12.10.1.3","certBag"),ur("1.2.840.113549.1.12.10.1.4","crlBag"),ur("1.2.840.113549.1.12.10.1.5","secretBag"),ur("1.2.840.113549.1.12.10.1.6","safeContentsBag"),ur("1.2.840.113549.1.5.13","pkcs5PBES2"),ur("1.2.840.113549.1.5.12","pkcs5PBKDF2"),ur("1.2.840.113549.1.12.1.1","pbeWithSHAAnd128BitRC4"),ur("1.2.840.113549.1.12.1.2","pbeWithSHAAnd40BitRC4"),ur("1.2.840.113549.1.12.1.3","pbeWithSHAAnd3-KeyTripleDES-CBC"),ur("1.2.840.113549.1.12.1.4","pbeWithSHAAnd2-KeyTripleDES-CBC"),ur("1.2.840.113549.1.12.1.5","pbeWithSHAAnd128BitRC2-CBC"),ur("1.2.840.113549.1.12.1.6","pbewithSHAAnd40BitRC2-CBC"),ur("1.2.840.113549.2.7","hmacWithSHA1"),ur("1.2.840.113549.2.8","hmacWithSHA224"),ur("1.2.840.113549.2.9","hmacWithSHA256"),ur("1.2.840.113549.2.10","hmacWithSHA384"),ur("1.2.840.113549.2.11","hmacWithSHA512"),ur("1.2.840.113549.3.7","des-EDE3-CBC"),ur("2.16.840.1.101.3.4.1.2","aes128-CBC"),ur("2.16.840.1.101.3.4.1.22","aes192-CBC"),ur("2.16.840.1.101.3.4.1.42","aes256-CBC"),ur("2.5.4.3","commonName"),ur("2.5.4.5","serialName"),ur("2.5.4.6","countryName"),ur("2.5.4.7","localityName"),ur("2.5.4.8","stateOrProvinceName"),ur("2.5.4.10","organizationName"),ur("2.5.4.11","organizationalUnitName"),ur("2.5.4.13","description"),ur("2.16.840.1.113730.1.1","nsCertType"),ur("2.16.840.1.113730.1.13","nsComment"),cr("2.5.29.1","authorityKeyIdentifier"),cr("2.5.29.2","keyAttributes"),cr("2.5.29.3","certificatePolicies"),cr("2.5.29.4","keyUsageRestriction"),cr("2.5.29.5","policyMapping"),cr("2.5.29.6","subtreesConstraint"),cr("2.5.29.7","subjectAltName"),cr("2.5.29.8","issuerAltName"),cr("2.5.29.9","subjectDirectoryAttributes"),cr("2.5.29.10","basicConstraints"),cr("2.5.29.11","nameConstraints"),cr("2.5.29.12","policyConstraints"),cr("2.5.29.13","basicConstraints"),ur("2.5.29.14","subjectKeyIdentifier"),ur("2.5.29.15","keyUsage"),cr("2.5.29.16","privateKeyUsagePeriod"),ur("2.5.29.17","subjectAltName"),ur("2.5.29.18","issuerAltName"),ur("2.5.29.19","basicConstraints"),cr("2.5.29.20","cRLNumber"),cr("2.5.29.21","cRLReason"),cr("2.5.29.22","expirationDate"),cr("2.5.29.23","instructionCode"),cr("2.5.29.24","invalidityDate"),cr("2.5.29.25","cRLDistributionPoints"),cr("2.5.29.26","issuingDistributionPoint"),cr("2.5.29.27","deltaCRLIndicator"),cr("2.5.29.28","issuingDistributionPoint"),cr("2.5.29.29","certificateIssuer"),cr("2.5.29.30","nameConstraints"),ur("2.5.29.31","cRLDistributionPoints"),ur("2.5.29.32","certificatePolicies"),cr("2.5.29.33","policyMappings"),cr("2.5.29.34","policyConstraints"),ur("2.5.29.35","authorityKeyIdentifier"),cr("2.5.29.36","policyConstraints"),ur("2.5.29.37","extKeyUsage"),cr("2.5.29.46","freshestCRL"),cr("2.5.29.54","inhibitAnyPolicy"),ur("1.3.6.1.4.1.11129.2.4.2","timestampList"),ur("1.3.6.1.5.5.7.1.1","authorityInfoAccess"),ur("1.3.6.1.5.5.7.3.1","serverAuth"),ur("1.3.6.1.5.5.7.3.2","clientAuth"),ur("1.3.6.1.5.5.7.3.3","codeSigning"),ur("1.3.6.1.5.5.7.3.4","emailProtection"),ur("1.3.6.1.5.5.7.3.8","timeStamping");var lr=c.asn1=c.asn1||{};function fr(e,t,r){if(r>t){var n=new Error("Too few bytes to parse DER.");throw n.available=e.length(),n.remaining=t,n.requested=r,n}}lr.Class={UNIVERSAL:0,APPLICATION:64,CONTEXT_SPECIFIC:128,PRIVATE:192},lr.Type={NONE:0,BOOLEAN:1,INTEGER:2,BITSTRING:3,OCTETSTRING:4,NULL:5,OID:6,ODESC:7,EXTERNAL:8,REAL:9,ENUMERATED:10,EMBEDDED:11,UTF8:12,ROID:13,SEQUENCE:16,SET:17,PRINTABLESTRING:19,IA5STRING:22,UTCTIME:23,GENERALIZEDTIME:24,BMPSTRING:30},lr.create=function(e,t,r,n,a){if(c.util.isArray(n)){for(var i=[],s=0;s<n.length;++s)void 0!==n[s]&&i.push(n[s]);n=i}var o={tagClass:e,type:t,constructed:r,composed:r||c.util.isArray(n),value:n};return a&&"bitStringContents"in a&&(o.bitStringContents=a.bitStringContents,o.original=lr.copy(o)),o},lr.copy=function(e,t){var r;if(c.util.isArray(e)){r=[];for(var n=0;n<e.length;++n)r.push(lr.copy(e[n],t));return r}return"string"==typeof e?e:(r={tagClass:e.tagClass,type:e.type,constructed:e.constructed,composed:e.composed,value:lr.copy(e.value,t)},t&&!t.excludeBitStringContents&&(r.bitStringContents=e.bitStringContents),r)},lr.equals=function(e,t,r){if(c.util.isArray(e)){if(!c.util.isArray(t))return!1;if(e.length!==t.length)return!1;for(var n=0;n<e.length;++n)if(!lr.equals(e[n],t[n]))return!1;return!0}if(typeof e!=typeof t)return!1;if("string"==typeof e)return e===t;var a=e.tagClass===t.tagClass&&e.type===t.type&&e.constructed===t.constructed&&e.composed===t.composed&&lr.equals(e.value,t.value);return r&&r.includeBitStringContents&&(a=a&&e.bitStringContents===t.bitStringContents),a},lr.getBerValueLength=function(e){var t=e.getByte();if(128!==t)return 128&t?e.getInt((127&t)<<3):t};lr.fromDer=function(e,t){return void 0===t&&(t={strict:!0,decodeBitStrings:!0}),"boolean"==typeof t&&(t={strict:t,decodeBitStrings:!0}),"strict"in t||(t.strict=!0),"decodeBitStrings"in t||(t.decodeBitStrings=!0),"string"==typeof e&&(e=c.util.createBuffer(e)),function e(t,r,n,a){var i;fr(t,r,2);var s=t.getByte();r--;var o=192&s,u=31&s;i=t.length();var c,l,f=function(e,t){var r=e.getByte();if(128!==r){var n;if(128&r){var a=127&r;fr(e,--t,a),n=e.getInt(a<<3)}else n=r;if(n<0)throw new Error("Negative length: "+n);return n}}(t,r);if(r-=i-t.length(),void 0!==f&&f>r){if(a.strict){var h=new Error("Too few bytes to read ASN.1 value.");throw h.available=t.length(),h.remaining=r,h.requested=f,h}f=r}var p=32==(32&s);if(p)if(c=[],void 0===f)for(;;){if(fr(t,r,2),t.bytes(2)===String.fromCharCode(0,0)){t.getBytes(2),r-=2;break}i=t.length(),c.push(e(t,r,n+1,a)),r-=i-t.length()}else for(;f>0;)i=t.length(),c.push(e(t,f,n+1,a)),r-=i-t.length(),f-=i-t.length();if(void 0===c&&o===lr.Class.UNIVERSAL&&u===lr.Type.BITSTRING&&(l=t.bytes(f)),void 0===c&&a.decodeBitStrings&&o===lr.Class.UNIVERSAL&&u===lr.Type.BITSTRING&&f>1){var d=t.read,y=r,g=0;if(u===lr.Type.BITSTRING&&(fr(t,r,1),g=t.getByte(),r--),0===g)try{i=t.length();var m=e(t,r,n+1,{verbose:a.verbose,strict:!0,decodeBitStrings:!0}),v=i-t.length();r-=v,u==lr.Type.BITSTRING&&v++;var E=m.tagClass;v!==f||E!==lr.Class.UNIVERSAL&&E!==lr.Class.CONTEXT_SPECIFIC||(c=[m])}catch(b){}void 0===c&&(t.read=d,r=y)}if(void 0===c){if(void 0===f){if(a.strict)throw new Error("Non-constructed ASN.1 object of indefinite length.");f=r}if(u===lr.Type.BMPSTRING)for(c="";f>0;f-=2)fr(t,r,2),c+=String.fromCharCode(t.getInt16()),r-=2;else c=t.getBytes(f)}var C=void 0===l?null:{bitStringContents:l};return lr.create(o,u,p,c,C)}(e,e.length(),0,t)},lr.toDer=function(e){var t=c.util.createBuffer(),r=e.tagClass|e.type,n=c.util.createBuffer(),a=!1;if("bitStringContents"in e&&(a=!0,e.original&&(a=lr.equals(e,e.original))),a)n.putBytes(e.bitStringContents);else if(e.composed){e.constructed?r|=32:n.putByte(0);for(var i=0;i<e.value.length;++i)void 0!==e.value[i]&&n.putBuffer(lr.toDer(e.value[i]))}else if(e.type===lr.Type.BMPSTRING)for(i=0;i<e.value.length;++i)n.putInt16(e.value.charCodeAt(i));else e.type===lr.Type.INTEGER&&e.value.length>1&&(0===e.value.charCodeAt(0)&&0==(128&e.value.charCodeAt(1))||255===e.value.charCodeAt(0)&&128==(128&e.value.charCodeAt(1)))?n.putBytes(e.value.substr(1)):n.putBytes(e.value);if(t.putByte(r),n.length()<=127)t.putByte(127&n.length());else{var s=n.length(),o="";do{o+=String.fromCharCode(255&s),s>>>=8}while(s>0);for(t.putByte(128|o.length),i=o.length-1;i>=0;--i)t.putByte(o.charCodeAt(i))}return t.putBuffer(n),t},lr.oidToDer=function(e){var t,r,n,a,i=e.split("."),s=c.util.createBuffer();s.putByte(40*parseInt(i[0],10)+parseInt(i[1],10));for(var o=2;o<i.length;++o){t=!0,r=[],n=parseInt(i[o],10);do{a=127&n,n>>>=7,t||(a|=128),r.push(a),t=!1}while(n>0);for(var u=r.length-1;u>=0;--u)s.putByte(r[u])}return s},lr.derToOid=function(e){var t;"string"==typeof e&&(e=c.util.createBuffer(e));var r=e.getByte();t=Math.floor(r/40)+"."+r%40;for(var n=0;e.length()>0;)n<<=7,128&(r=e.getByte())?n+=127&r:(t+="."+(n+r),n=0);return t},lr.utcTimeToDate=function(e){var t=new Date,r=parseInt(e.substr(0,2),10);r=r>=50?1900+r:2e3+r;var n=parseInt(e.substr(2,2),10)-1,a=parseInt(e.substr(4,2),10),i=parseInt(e.substr(6,2),10),s=parseInt(e.substr(8,2),10),o=0;if(e.length>11){var u=e.charAt(10),c=10;"+"!==u&&"-"!==u&&(o=parseInt(e.substr(10,2),10),c+=2)}if(t.setUTCFullYear(r,n,a),t.setUTCHours(i,s,o,0),c&&("+"===(u=e.charAt(c))||"-"===u)){var l=60*parseInt(e.substr(c+1,2),10)+parseInt(e.substr(c+4,2),10);l*=6e4,"+"===u?t.setTime(+t-l):t.setTime(+t+l)}return t},lr.generalizedTimeToDate=function(e){var t=new Date,r=parseInt(e.substr(0,4),10),n=parseInt(e.substr(4,2),10)-1,a=parseInt(e.substr(6,2),10),i=parseInt(e.substr(8,2),10),s=parseInt(e.substr(10,2),10),o=parseInt(e.substr(12,2),10),u=0,c=0,l=!1;"Z"===e.charAt(e.length-1)&&(l=!0);var f=e.length-5,h=e.charAt(f);return"+"!==h&&"-"!==h||(c=60*parseInt(e.substr(f+1,2),10)+parseInt(e.substr(f+4,2),10),c*=6e4,"+"===h&&(c*=-1),l=!0),"."===e.charAt(14)&&(u=1e3*parseFloat(e.substr(14),10)),l?(t.setUTCFullYear(r,n,a),t.setUTCHours(i,s,o,u),t.setTime(+t+c)):(t.setFullYear(r,n,a),t.setHours(i,s,o,u)),t},lr.dateToUtcTime=function(e){if("string"==typeof e)return e;var t="",r=[];r.push((""+e.getUTCFullYear()).substr(2)),r.push(""+(e.getUTCMonth()+1)),r.push(""+e.getUTCDate()),r.push(""+e.getUTCHours()),r.push(""+e.getUTCMinutes()),r.push(""+e.getUTCSeconds());for(var n=0;n<r.length;++n)r[n].length<2&&(t+="0"),t+=r[n];return t+"Z"},lr.dateToGeneralizedTime=function(e){if("string"==typeof e)return e;var t="",r=[];r.push(""+e.getUTCFullYear()),r.push(""+(e.getUTCMonth()+1)),r.push(""+e.getUTCDate()),r.push(""+e.getUTCHours()),r.push(""+e.getUTCMinutes()),r.push(""+e.getUTCSeconds());for(var n=0;n<r.length;++n)r[n].length<2&&(t+="0"),t+=r[n];return t+"Z"},lr.integerToDer=function(e){var t=c.util.createBuffer();if(e>=-128&&e<128)return t.putSignedInt(e,8);if(e>=-32768&&e<32768)return t.putSignedInt(e,16);if(e>=-8388608&&e<8388608)return t.putSignedInt(e,24);if(e>=-2147483648&&e<2147483648)return t.putSignedInt(e,32);var r=new Error("Integer too large; max is 32-bits.");throw r.integer=e,r},lr.derToInteger=function(e){"string"==typeof e&&(e=c.util.createBuffer(e));var t=8*e.length();if(t>32)throw new Error("Integer too large; max is 32-bits.");return e.getSignedInt(t)},lr.validate=function(e,t,r,n){var a=!1;if(e.tagClass!==t.tagClass&&void 0!==t.tagClass||e.type!==t.type&&void 0!==t.type)n&&(e.tagClass!==t.tagClass&&n.push("["+t.name+'] Expected tag class "'+t.tagClass+'", got "'+e.tagClass+'"'),e.type!==t.type&&n.push("["+t.name+'] Expected type "'+t.type+'", got "'+e.type+'"'));else if(e.constructed===t.constructed||void 0===t.constructed){if(a=!0,t.value&&c.util.isArray(t.value))for(var i=0,s=0;a&&s<t.value.length;++s)a=t.value[s].optional||!1,e.value[i]&&((a=lr.validate(e.value[i],t.value[s],r,n))?++i:t.value[s].optional&&(a=!0)),!a&&n&&n.push("["+t.name+'] Tag class "'+t.tagClass+'", type "'+t.type+'" expected value length "'+t.value.length+'", got "'+e.value.length+'"');if(a&&r&&(t.capture&&(r[t.capture]=e.value),t.captureAsn1&&(r[t.captureAsn1]=e),t.captureBitStringContents&&"bitStringContents"in e&&(r[t.captureBitStringContents]=e.bitStringContents),t.captureBitStringValue&&"bitStringContents"in e))if(e.bitStringContents.length<2)r[t.captureBitStringValue]="";else{if(0!==e.bitStringContents.charCodeAt(0))throw new Error("captureBitStringValue only supported for zero unused bits");r[t.captureBitStringValue]=e.bitStringContents.slice(1)}}else n&&n.push("["+t.name+'] Expected constructed "'+t.constructed+'", got "'+e.constructed+'"');return a};var hr=/[^\\u0000-\\u00ff]/;lr.prettyPrint=function(e,t,r){var n="";r=r||2,(t=t||0)>0&&(n+="\n");for(var a="",i=0;i<t*r;++i)a+=" ";switch(n+=a+"Tag: ",e.tagClass){case lr.Class.UNIVERSAL:n+="Universal:";break;case lr.Class.APPLICATION:n+="Application:";break;case lr.Class.CONTEXT_SPECIFIC:n+="Context-Specific:";break;case lr.Class.PRIVATE:n+="Private:"}if(e.tagClass===lr.Class.UNIVERSAL)switch(n+=e.type,e.type){case lr.Type.NONE:n+=" (None)";break;case lr.Type.BOOLEAN:n+=" (Boolean)";break;case lr.Type.INTEGER:n+=" (Integer)";break;case lr.Type.BITSTRING:n+=" (Bit string)";break;case lr.Type.OCTETSTRING:n+=" (Octet string)";break;case lr.Type.NULL:n+=" (Null)";break;case lr.Type.OID:n+=" (Object Identifier)";break;case lr.Type.ODESC:n+=" (Object Descriptor)";break;case lr.Type.EXTERNAL:n+=" (External or Instance of)";break;case lr.Type.REAL:n+=" (Real)";break;case lr.Type.ENUMERATED:n+=" (Enumerated)";break;case lr.Type.EMBEDDED:n+=" (Embedded PDV)";break;case lr.Type.UTF8:n+=" (UTF8)";break;case lr.Type.ROID:n+=" (Relative Object Identifier)";break;case lr.Type.SEQUENCE:n+=" (Sequence)";break;case lr.Type.SET:n+=" (Set)";break;case lr.Type.PRINTABLESTRING:n+=" (Printable String)";break;case lr.Type.IA5String:n+=" (IA5String (ASCII))";break;case lr.Type.UTCTIME:n+=" (UTC time)";break;case lr.Type.GENERALIZEDTIME:n+=" (Generalized time)";break;case lr.Type.BMPSTRING:n+=" (BMP String)"}else n+=e.type;if(n+="\n",n+=a+"Constructed: "+e.constructed+"\n",e.composed){var s=0,o="";for(i=0;i<e.value.length;++i)void 0!==e.value[i]&&(s+=1,o+=lr.prettyPrint(e.value[i],t+1,r),i+1<e.value.length&&(o+=","));n+=a+"Sub values: "+s+o}else{if(n+=a+"Value: ",e.type===lr.Type.OID){var u=lr.derToOid(e.value);n+=u,c.pki&&c.pki.oids&&u in c.pki.oids&&(n+=" ("+c.pki.oids[u]+") ")}if(e.type===lr.Type.INTEGER)try{n+=lr.derToInteger(e.value)}catch(f){n+="0x"+c.util.bytesToHex(e.value)}else if(e.type===lr.Type.BITSTRING){if(e.value.length>1?n+="0x"+c.util.bytesToHex(e.value.slice(1)):n+="(none)",e.value.length>0){var l=e.value.charCodeAt(0);1==l?n+=" (1 unused bit shown)":l>1&&(n+=" ("+l+" unused bits shown)")}}else e.type===lr.Type.OCTETSTRING?(hr.test(e.value)||(n+="("+e.value+") "),n+="0x"+c.util.bytesToHex(e.value)):e.type===lr.Type.UTF8?n+=c.util.decodeUtf8(e.value):e.type===lr.Type.PRINTABLESTRING||e.type===lr.Type.IA5String?n+=e.value:hr.test(e.value)?n+="0x"+c.util.bytesToHex(e.value):0===e.value.length?n+="[null]":n+=e.value}return n};function pr(e,t){c.cipher.registerAlgorithm(e,function(){return new c.des.Algorithm(e,t)})}c.des=c.des||{},c.des.startEncrypting=function(e,t,r,n){var a=Tr({key:e,output:r,decrypt:!1,mode:n||(null===t?"ECB":"CBC")});return a.start(t),a},c.des.createEncryptionCipher=function(e,t){return Tr({key:e,output:null,decrypt:!1,mode:t})},c.des.startDecrypting=function(e,t,r,n){var a=Tr({key:e,output:r,decrypt:!0,mode:n||(null===t?"ECB":"CBC")});return a.start(t),a},c.des.createDecryptionCipher=function(e,t){return Tr({key:e,output:null,decrypt:!0,mode:t})},c.des.Algorithm=function(e,t){var r=this;r.name=e,r.mode=new t({blockSize:8,cipher:{encrypt:function(e,t){return Sr(r._keys,e,t,!1)},decrypt:function(e,t){return Sr(r._keys,e,t,!0)}}}),r._init=!1},c.des.Algorithm.prototype.initialize=function(e){if(!this._init){var t=c.util.createBuffer(e.key);if(0===this.name.indexOf("3DES")&&24!==t.length())throw new Error("Invalid Triple-DES key size: "+8*t.length());this._keys=function(e){for(var t,r=[0,4,536870912,536870916,65536,65540,536936448,536936452,512,516,536871424,536871428,66048,66052,536936960,536936964],n=[0,1,1048576,1048577,67108864,67108865,68157440,68157441,256,257,1048832,1048833,67109120,67109121,68157696,68157697],a=[0,8,2048,2056,16777216,16777224,16779264,16779272,0,8,2048,2056,16777216,16777224,16779264,16779272],i=[0,2097152,134217728,136314880,8192,2105344,134225920,136323072,131072,2228224,134348800,136445952,139264,2236416,134356992,136454144],s=[0,262144,16,262160,0,262144,16,262160,4096,266240,4112,266256,4096,266240,4112,266256],o=[0,1024,32,1056,0,1024,32,1056,33554432,33555456,33554464,33555488,33554432,33555456,33554464,33555488],u=[0,268435456,524288,268959744,2,268435458,524290,268959746,0,268435456,524288,268959744,2,268435458,524290,268959746],c=[0,65536,2048,67584,536870912,536936448,536872960,536938496,131072,196608,133120,198656,537001984,537067520,537004032,537069568],l=[0,262144,0,262144,2,262146,2,262146,33554432,33816576,33554432,33816576,33554434,33816578,33554434,33816578],f=[0,268435456,8,268435464,0,268435456,8,268435464,1024,268436480,1032,268436488,1024,268436480,1032,268436488],h=[0,32,0,32,1048576,1048608,1048576,1048608,8192,8224,8192,8224,1056768,1056800,1056768,1056800],p=[0,16777216,512,16777728,2097152,18874368,2097664,18874880,67108864,83886080,67109376,83886592,69206016,85983232,69206528,85983744],d=[0,4096,134217728,134221824,524288,528384,134742016,134746112,16,4112,134217744,134221840,524304,528400,134742032,134746128],y=[0,4,256,260,0,4,256,260,1,5,257,261,1,5,257,261],g=e.length()>8?3:1,m=[],v=[0,0,1,1,1,1,1,1,0,1,1,1,1,1,1,0],E=0,C=0;C<g;C++){var b=e.getInt32(),S=e.getInt32();b^=(t=252645135&(b>>>4^S))<<4,b^=t=65535&((S^=t)>>>-16^b),b^=(t=858993459&(b>>>2^(S^=t<<-16)))<<2,b^=t=65535&((S^=t)>>>-16^b),b^=(t=1431655765&(b>>>1^(S^=t<<-16)))<<1,b^=t=16711935&((S^=t)>>>8^b),t=(b^=(t=1431655765&(b>>>1^(S^=t<<8)))<<1)<<8|(S^=t)>>>20&240,b=S<<24|S<<8&16711680|S>>>8&65280|S>>>24&240,S=t;for(var T=0;T<v.length;++T){v[T]?(b=b<<2|b>>>26,S=S<<2|S>>>26):(b=b<<1|b>>>27,S=S<<1|S>>>27);var I=r[(b&=-15)>>>28]|n[b>>>24&15]|a[b>>>20&15]|i[b>>>16&15]|s[b>>>12&15]|o[b>>>8&15]|u[b>>>4&15],A=c[(S&=-15)>>>28]|l[S>>>24&15]|f[S>>>20&15]|h[S>>>16&15]|p[S>>>12&15]|d[S>>>8&15]|y[S>>>4&15];t=65535&(A>>>16^I),m[E++]=I^t,m[E++]=A^t<<16}}return m}(t),this._init=!0}},pr("DES-ECB",c.cipher.modes.ecb),pr("DES-CBC",c.cipher.modes.cbc),pr("DES-CFB",c.cipher.modes.cfb),pr("DES-OFB",c.cipher.modes.ofb),pr("DES-CTR",c.cipher.modes.ctr),pr("3DES-ECB",c.cipher.modes.ecb),pr("3DES-CBC",c.cipher.modes.cbc),pr("3DES-CFB",c.cipher.modes.cfb),pr("3DES-OFB",c.cipher.modes.ofb),pr("3DES-CTR",c.cipher.modes.ctr);var dr=[16843776,0,65536,16843780,16842756,66564,4,65536,1024,16843776,16843780,1024,16778244,16842756,16777216,4,1028,16778240,16778240,66560,66560,16842752,16842752,16778244,65540,16777220,16777220,65540,0,1028,66564,16777216,65536,16843780,4,16842752,16843776,16777216,16777216,1024,16842756,65536,66560,16777220,1024,4,16778244,66564,16843780,65540,16842752,16778244,16777220,1028,66564,16843776,1028,16778240,16778240,0,65540,66560,0,16842756],yr=[-2146402272,-2147450880,32768,1081376,1048576,32,-2146435040,-2147450848,-2147483616,-2146402272,-2146402304,-2147483648,-2147450880,1048576,32,-2146435040,1081344,1048608,-2147450848,0,-2147483648,32768,1081376,-2146435072,1048608,-2147483616,0,1081344,32800,-2146402304,-2146435072,32800,0,1081376,-2146435040,1048576,-2147450848,-2146435072,-2146402304,32768,-2146435072,-2147450880,32,-2146402272,1081376,32,32768,-2147483648,32800,-2146402304,1048576,-2147483616,1048608,-2147450848,-2147483616,1048608,1081344,0,-2147450880,32800,-2147483648,-2146435040,-2146402272,1081344],gr=[520,134349312,0,134348808,134218240,0,131592,134218240,131080,134217736,134217736,131072,134349320,131080,134348800,520,134217728,8,134349312,512,131584,134348800,134348808,131592,134218248,131584,131072,134218248,8,134349320,512,134217728,134349312,134217728,131080,520,131072,134349312,134218240,0,512,131080,134349320,134218240,134217736,512,0,134348808,134218248,131072,134217728,134349320,8,131592,131584,134217736,134348800,134218248,520,134348800,131592,8,134348808,131584],mr=[8396801,8321,8321,128,8396928,8388737,8388609,8193,0,8396800,8396800,8396929,129,0,8388736,8388609,1,8192,8388608,8396801,128,8388608,8193,8320,8388737,1,8320,8388736,8192,8396928,8396929,129,8388736,8388609,8396800,8396929,129,0,0,8396800,8320,8388736,8388737,1,8396801,8321,8321,128,8396929,129,1,8192,8388609,8193,8396928,8388737,8193,8320,8388608,8396801,128,8388608,8192,8396928],vr=[256,34078976,34078720,1107296512,524288,256,1073741824,34078720,1074266368,524288,33554688,1074266368,1107296512,1107820544,524544,1073741824,33554432,1074266112,1074266112,0,1073742080,1107820800,1107820800,33554688,1107820544,1073742080,0,1107296256,34078976,33554432,1107296256,524544,524288,1107296512,256,33554432,1073741824,34078720,1107296512,1074266368,33554688,1073741824,1107820544,34078976,1074266368,256,33554432,1107820544,1107820800,524544,1107296256,1107820800,34078720,0,1074266112,1107296256,524544,33554688,1073742080,524288,0,1074266112,34078976,1073742080],Er=[536870928,541065216,16384,541081616,541065216,16,541081616,4194304,536887296,4210704,4194304,536870928,4194320,536887296,536870912,16400,0,4194320,536887312,16384,4210688,536887312,16,541065232,541065232,0,4210704,541081600,16400,4210688,541081600,536870912,536887296,16,541065232,4210688,541081616,4194304,16400,536870928,4194304,536887296,536870912,16400,536870928,541081616,4210688,541065216,4210704,541081600,0,541065232,16,16384,541065216,4210704,16384,4194320,536887312,0,541081600,536870912,4194320,536887312],Cr=[2097152,69206018,67110914,0,2048,67110914,2099202,69208064,69208066,2097152,0,67108866,2,67108864,69206018,2050,67110912,2099202,2097154,67110912,67108866,69206016,69208064,2097154,69206016,2048,2050,69208066,2099200,2,67108864,2099200,67108864,2099200,2097152,67110914,67110914,69206018,69206018,2,2097154,67108864,67110912,2097152,69208064,2050,2099202,69208064,2050,67108866,69208066,69206016,2099200,0,2,69208066,0,2099202,69206016,2048,67108866,67110912,2048,2097154],br=[268439616,4096,262144,268701760,268435456,268439616,64,268435456,262208,268697600,268701760,266240,268701696,266304,4096,64,268697600,268435520,268439552,4160,266240,262208,268697664,268701696,4160,0,0,268697664,268435520,268439552,266304,262144,266304,262144,268701696,4096,64,268697664,4096,266304,268439552,64,268435520,268697600,268697664,268435456,262144,268439616,0,268701760,262208,268435520,268697600,268439552,268439616,0,268701760,266240,266240,4160,4160,262208,268435456,268701696];function Sr(e,t,r,n){var a,i,s=32===e.length?3:9;a=3===s?n?[30,-2,-2]:[0,32,2]:n?[94,62,-2,32,64,2,30,-2,-2]:[0,32,2,62,30,-2,64,96,2];var o=t[0],u=t[1];o^=(i=252645135&(o>>>4^u))<<4,o^=(i=65535&(o>>>16^(u^=i)))<<16,o^=i=858993459&((u^=i)>>>2^o),o^=i=16711935&((u^=i<<2)>>>8^o),o=(o^=(i=1431655765&(o>>>1^(u^=i<<8)))<<1)<<1|o>>>31,u=(u^=i)<<1|u>>>31;for(var c=0;c<s;c+=3){for(var l=a[c+1],f=a[c+2],h=a[c];h!=l;h+=f){var p=u^e[h],d=(u>>>4|u<<28)^e[h+1];i=o,o=u,u=i^(yr[p>>>24&63]|mr[p>>>16&63]|Er[p>>>8&63]|br[63&p]|dr[d>>>24&63]|gr[d>>>16&63]|vr[d>>>8&63]|Cr[63&d])}i=o,o=u,u=i}u=u>>>1|u<<31,u^=i=1431655765&((o=o>>>1|o<<31)>>>1^u),u^=(i=16711935&(u>>>8^(o^=i<<1)))<<8,u^=(i=858993459&(u>>>2^(o^=i)))<<2,u^=i=65535&((o^=i)>>>16^u),u^=i=252645135&((o^=i<<16)>>>4^u),o^=i<<4,r[0]=o,r[1]=u}function Tr(e){var t,r="DES-"+((e=e||{}).mode||"CBC").toUpperCase(),n=(t=e.decrypt?c.cipher.createDecipher(r,e.key):c.cipher.createCipher(r,e.key)).start;return t.start=function(e,r){var a=null;r instanceof c.util.ByteBuffer&&(a=r,r={}),(r=r||{}).output=a,r.iv=e,n.call(t,r)},t}(function(e){var t,r=c.pkcs5=c.pkcs5||{};c.util.isNodejs&&!c.options.usePureJavaScript&&(t=l),c.pbkdf2=r.pbkdf2=function(r,n,a,i,s,o){if("function"==typeof s&&(o=s,s=null),c.util.isNodejs&&!c.options.usePureJavaScript&&t.pbkdf2&&(null===s||"object"!=typeof s)&&(t.pbkdf2Sync.length>4||!s||"sha1"===s))return"string"!=typeof s&&(s="sha1"),r=e.from(r,"binary"),n=e.from(n,"binary"),o?4===t.pbkdf2Sync.length?t.pbkdf2(r,n,a,i,function(e,t){if(e)return o(e);o(null,t.toString("binary"))}):t.pbkdf2(r,n,a,i,s,function(e,t){if(e)return o(e);o(null,t.toString("binary"))}):4===t.pbkdf2Sync.length?t.pbkdf2Sync(r,n,a,i).toString("binary"):t.pbkdf2Sync(r,n,a,i,s).toString("binary");if(null==s&&(s="sha1"),"string"==typeof s){if(!(s in c.md.algorithms))throw new Error("Unknown hash algorithm: "+s);s=c.md[s].create()}var u=s.digestLength;if(i>4294967295*u){var l=new Error("Derived key is too long.");if(o)return o(l);throw l}var f=Math.ceil(i/u),h=i-(f-1)*u,p=c.hmac.create();p.start(s,r);var d,y,g,m="";if(!o){for(var v=1;v<=f;++v){p.start(null,null),p.update(n),p.update(c.util.int32ToBytes(v)),d=g=p.digest().getBytes();for(var E=2;E<=a;++E)p.start(null,null),p.update(g),y=p.digest().getBytes(),d=c.util.xorBytes(d,y,u),g=y;m+=v<f?d:d.substr(0,h)}return m}function C(){if(v>f)return o(null,m);p.start(null,null),p.update(n),p.update(c.util.int32ToBytes(v)),d=g=p.digest().getBytes(),E=2,b()}function b(){if(E<=a)return p.start(null,null),p.update(g),y=p.digest().getBytes(),d=c.util.xorBytes(d,y,u),g=y,++E,c.util.setImmediate(b);m+=v<f?d:d.substr(0,h),++v,C()}v=1,C()}}).call(this,l.Buffer);var Ir=c.pem=c.pem||{};function Ar(e){for(var t=e.name+": ",r=[],n=function(e,t){return" "+t},a=0;a<e.values.length;++a)r.push(e.values[a].replace(/^(\S+\r\n)/,n));t+=r.join(",")+"\r\n";var i=0,s=-1;for(a=0;a<t.length;++a,++i)if(i>65&&-1!==s){var o=t[s];","===o?(++s,t=t.substr(0,s)+"\r\n "+t.substr(s)):t=t.substr(0,s)+"\r\n"+o+t.substr(s+1),i=a-s-1,s=-1,++a}else" "!==t[a]&&"\t"!==t[a]&&","!==t[a]||(s=a);return t}function wr(e){return e.replace(/^\s+/,"")}Ir.encode=function(e,t){t=t||{};var r,n="-----BEGIN "+e.type+"-----\r\n";if(e.procType&&(n+=Ar(r={name:"Proc-Type",values:[String(e.procType.version),e.procType.type]})),e.contentDomain&&(n+=Ar(r={name:"Content-Domain",values:[e.contentDomain]})),e.dekInfo&&(r={name:"DEK-Info",values:[e.dekInfo.algorithm]},e.dekInfo.parameters&&r.values.push(e.dekInfo.parameters),n+=Ar(r)),e.headers)for(var a=0;a<e.headers.length;++a)n+=Ar(e.headers[a]);return e.procType&&(n+="\r\n"),(n+=c.util.encode64(e.body,t.maxline||64)+"\r\n")+"-----END "+e.type+"-----\r\n"},Ir.decode=function(e){for(var t,r=[],n=/\s*-----BEGIN ([A-Z0-9- ]+)-----\r?\n?([\x21-\x7e\s]+?(?:\r?\n\r?\n))?([:A-Za-z0-9+\/=\s]+?)-----END \1-----/g,a=/([\x21-\x7e]+):\s*([\x21-\x7e\s^:]+)/,i=/\r?\n/;t=n.exec(e);){var s={type:t[1],procType:null,contentDomain:null,dekInfo:null,headers:[],body:c.util.decode64(t[3])};if(r.push(s),t[2]){for(var o=t[2].split(i),u=0;t&&u<o.length;){for(var l=o[u].replace(/\s+$/,""),f=u+1;f<o.length;++f){var h=o[f];if(!/\s/.test(h[0]))break;l+=h,u=f}if(t=l.match(a)){for(var p={name:t[1],values:[]},d=t[2].split(","),y=0;y<d.length;++y)p.values.push(wr(d[y]));if(s.procType)if(s.contentDomain||"Content-Domain"!==p.name)if(s.dekInfo||"DEK-Info"!==p.name)s.headers.push(p);else{if(0===p.values.length)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must have at least one subfield.');s.dekInfo={algorithm:d[0],parameters:d[1]||null}}else s.contentDomain=d[0]||"";else{if("Proc-Type"!==p.name)throw new Error('Invalid PEM formatted message. The first encapsulated header must be "Proc-Type".');if(2!==p.values.length)throw new Error('Invalid PEM formatted message. The "Proc-Type" header must have two subfields.');s.procType={version:d[0],type:d[1]}}}++u}if("ENCRYPTED"===s.procType&&!s.dekInfo)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must be present if "Proc-Type" is "ENCRYPTED".')}}if(0===r.length)throw new Error("Invalid PEM formatted message.");return r};var Br=[217,120,249,196,25,221,181,237,40,233,253,121,74,160,216,157,198,126,55,131,43,118,83,142,98,76,100,136,68,139,251,162,23,154,89,245,135,179,79,19,97,69,109,141,9,129,125,50,189,143,64,235,134,183,123,11,240,149,33,34,92,107,78,130,84,214,101,147,206,96,178,28,115,86,192,20,167,140,241,220,18,117,202,31,59,190,228,209,66,61,212,48,163,60,182,38,111,191,14,218,70,105,7,87,39,242,29,155,188,148,67,3,248,17,199,246,144,239,62,231,6,195,213,47,200,102,30,215,8,232,234,222,128,82,238,247,132,170,114,172,53,77,106,42,150,26,210,113,90,21,73,116,75,159,208,94,4,24,164,236,194,224,65,110,15,81,203,204,36,145,175,80,161,244,112,57,153,124,58,133,35,184,180,122,252,2,54,91,37,85,151,49,45,93,250,152,227,138,146,174,5,223,41,16,103,108,186,201,211,0,230,207,225,158,168,44,99,22,1,63,88,226,137,169,13,56,52,27,171,51,255,176,187,72,12,95,185,177,205,46,197,243,219,71,229,165,156,119,10,166,32,104,254,127,193,173],Nr=[1,2,3,5];c.rc2=c.rc2||{},c.rc2.expandKey=function(e,t){"string"==typeof e&&(e=c.util.createBuffer(e)),t=t||128;var r,n=e,a=e.length(),i=t,s=Math.ceil(i/8),o=255>>(7&i);for(r=a;r<128;r++)n.putByte(Br[n.at(r-1)+n.at(r-a)&255]);for(n.setAt(128-s,Br[n.at(128-s)&o]),r=127-s;r>=0;r--)n.setAt(r,Br[n.at(r+1)^n.at(r+s)]);return n};var kr,Rr=function(e,t,r){var n,a,i,s,o=!1,u=null,l=null,f=null,h=[];for(e=c.rc2.expandKey(e,t),i=0;i<64;i++)h.push(e.getInt16Le());r?(n=function(e){for(i=0;i<4;i++)e[i]+=h[s]+(e[(i+3)%4]&e[(i+2)%4])+(~e[(i+3)%4]&e[(i+1)%4]),e[i]=(t=e[i])<<(r=Nr[i])&65535|(65535&t)>>16-r,s++;var t,r},a=function(e){for(i=0;i<4;i++)e[i]+=h[63&e[(i+3)%4]]}):(n=function(e){for(i=3;i>=0;i--)e[i]=(65535&(t=e[i]))>>(r=Nr[i])|t<<16-r&65535,e[i]-=h[s]+(e[(i+3)%4]&e[(i+2)%4])+(~e[(i+3)%4]&e[(i+1)%4]),s--;var t,r},a=function(e){for(i=3;i>=0;i--)e[i]-=h[63&e[(i+3)%4]]});var p=function(e){var t=[];for(i=0;i<4;i++){var n=u.getInt16Le();null!==f&&(r?n^=f.getInt16Le():f.putInt16Le(n)),t.push(65535&n)}s=r?0:63;for(var a=0;a<e.length;a++)for(var o=0;o<e[a][0];o++)e[a][1](t);for(i=0;i<4;i++)null!==f&&(r?f.putInt16Le(t[i]):t[i]^=f.getInt16Le()),l.putInt16Le(t[i])},d=null;return d={start:function(e,t){e&&"string"==typeof e&&(e=c.util.createBuffer(e)),o=!1,u=c.util.createBuffer(),l=t||new c.util.createBuffer,f=e,d.output=l},update:function(e){for(o||u.putBuffer(e);u.length()>=8;)p([[5,n],[1,a],[6,n],[1,a],[5,n]])},finish:function(e){var t=!0;if(r)if(e)t=e(8,u,!r);else{var n=8===u.length()?8:8-u.length();u.fillWithByte(n,n)}if(t&&(o=!0,d.update()),!r&&(t=0===u.length()))if(e)t=e(8,l,!r);else{var a=l.length(),i=l.at(a-1);i>a?t=!1:l.truncate(i)}return t}}};c.rc2.startEncrypting=function(e,t,r){var n=c.rc2.createEncryptionCipher(e,128);return n.start(t,r),n},c.rc2.createEncryptionCipher=function(e,t){return Rr(e,t,!0)},c.rc2.startDecrypting=function(e,t,r){var n=c.rc2.createDecryptionCipher(e,128);return n.start(t,r),n},c.rc2.createDecryptionCipher=function(e,t){return Rr(e,t,!1)};c.jsbn=c.jsbn||{};function Ur(e,t,r){this.data=[],null!=e&&("number"==typeof e?this.fromNumber(e,t,r):null==t&&"string"!=typeof e?this.fromString(e,256):this.fromString(e,t))}function Lr(){return new Ur(null)}function _r(e,t,r,n,a,i){for(var s=16383&t,o=t>>14;--i>=0;){var u=16383&this.data[e],c=this.data[e++]>>14,l=o*u+c*s;a=((u=s*u+((16383&l)<<14)+r.data[n]+a)>>28)+(l>>14)+o*c,r.data[n++]=268435455&u}return a}c.jsbn.BigInteger=Ur,"undefined"==typeof navigator?(Ur.prototype.am=_r,kr=28):"Microsoft Internet Explorer"==navigator.appName?(Ur.prototype.am=function(e,t,r,n,a,i){for(var s=32767&t,o=t>>15;--i>=0;){var u=32767&this.data[e],c=this.data[e++]>>15,l=o*u+c*s;a=((u=s*u+((32767&l)<<15)+r.data[n]+(1073741823&a))>>>30)+(l>>>15)+o*c+(a>>>30),r.data[n++]=1073741823&u}return a},kr=30):"Netscape"!=navigator.appName?(Ur.prototype.am=function(e,t,r,n,a,i){for(;--i>=0;){var s=t*this.data[e++]+r.data[n]+a;a=Math.floor(s/67108864),r.data[n++]=67108863&s}return a},kr=26):(Ur.prototype.am=_r,kr=28),Ur.prototype.DB=kr,Ur.prototype.DM=(1<<kr)-1,Ur.prototype.DV=1<<kr,Ur.prototype.FV=Math.pow(2,52),Ur.prototype.F1=52-kr,Ur.prototype.F2=2*kr-52;var Pr,Dr,Or="0123456789abcdefghijklmnopqrstuvwxyz",Vr=new Array;for(Pr="0".charCodeAt(0),Dr=0;Dr<=9;++Dr)Vr[Pr++]=Dr;for(Pr="a".charCodeAt(0),Dr=10;Dr<36;++Dr)Vr[Pr++]=Dr;for(Pr="A".charCodeAt(0),Dr=10;Dr<36;++Dr)Vr[Pr++]=Dr;function Kr(e){return Or.charAt(e)}function xr(e,t){var r=Vr[e.charCodeAt(t)];return null==r?-1:r}function Mr(e){var t=Lr();return t.fromInt(e),t}function jr(e){var t,r=1;return 0!=(t=e>>>16)&&(e=t,r+=16),0!=(t=e>>8)&&(e=t,r+=8),0!=(t=e>>4)&&(e=t,r+=4),0!=(t=e>>2)&&(e=t,r+=2),0!=(t=e>>1)&&(e=t,r+=1),r}function Fr(e){this.m=e}function zr(e){this.m=e,this.mp=e.invDigit(),this.mpl=32767&this.mp,this.mph=this.mp>>15,this.um=(1<<e.DB-15)-1,this.mt2=2*e.t}function qr(e,t){return e&t}function Gr(e,t){return e|t}function Qr(e,t){return e^t}function Hr(e,t){return e&~t}function Wr(e){if(0==e)return-1;var t=0;return 0==(65535&e)&&(e>>=16,t+=16),0==(255&e)&&(e>>=8,t+=8),0==(15&e)&&(e>>=4,t+=4),0==(3&e)&&(e>>=2,t+=2),0==(1&e)&&++t,t}function Xr(e){for(var t=0;0!=e;)e&=e-1,++t;return t}function Yr(){}function Zr(e){return e}function Jr(e){this.r2=Lr(),this.q3=Lr(),Ur.ONE.dlShiftTo(2*e.t,this.r2),this.mu=this.r2.divide(e),this.m=e}Fr.prototype.convert=function(e){return e.s<0||e.compareTo(this.m)>=0?e.mod(this.m):e},Fr.prototype.revert=function(e){return e},Fr.prototype.reduce=function(e){e.divRemTo(this.m,null,e)},Fr.prototype.mulTo=function(e,t,r){e.multiplyTo(t,r),this.reduce(r)},Fr.prototype.sqrTo=function(e,t){e.squareTo(t),this.reduce(t)},zr.prototype.convert=function(e){var t=Lr();return e.abs().dlShiftTo(this.m.t,t),t.divRemTo(this.m,null,t),e.s<0&&t.compareTo(Ur.ZERO)>0&&this.m.subTo(t,t),t},zr.prototype.revert=function(e){var t=Lr();return e.copyTo(t),this.reduce(t),t},zr.prototype.reduce=function(e){for(;e.t<=this.mt2;)e.data[e.t++]=0;for(var t=0;t<this.m.t;++t){var r=32767&e.data[t],n=r*this.mpl+((r*this.mph+(e.data[t]>>15)*this.mpl&this.um)<<15)&e.DM;for(r=t+this.m.t,e.data[r]+=this.m.am(0,n,e,t,0,this.m.t);e.data[r]>=e.DV;)e.data[r]-=e.DV,e.data[++r]++}e.clamp(),e.drShiftTo(this.m.t,e),e.compareTo(this.m)>=0&&e.subTo(this.m,e)},zr.prototype.mulTo=function(e,t,r){e.multiplyTo(t,r),this.reduce(r)},zr.prototype.sqrTo=function(e,t){e.squareTo(t),this.reduce(t)},Ur.prototype.copyTo=function(e){for(var t=this.t-1;t>=0;--t)e.data[t]=this.data[t];e.t=this.t,e.s=this.s},Ur.prototype.fromInt=function(e){this.t=1,this.s=e<0?-1:0,e>0?this.data[0]=e:e<-1?this.data[0]=e+this.DV:this.t=0},Ur.prototype.fromString=function(e,t){var r;if(16==t)r=4;else if(8==t)r=3;else if(256==t)r=8;else if(2==t)r=1;else if(32==t)r=5;else{if(4!=t)return void this.fromRadix(e,t);r=2}this.t=0,this.s=0;for(var n=e.length,a=!1,i=0;--n>=0;){var s=8==r?255&e[n]:xr(e,n);s<0?"-"==e.charAt(n)&&(a=!0):(a=!1,0==i?this.data[this.t++]=s:i+r>this.DB?(this.data[this.t-1]|=(s&(1<<this.DB-i)-1)<<i,this.data[this.t++]=s>>this.DB-i):this.data[this.t-1]|=s<<i,(i+=r)>=this.DB&&(i-=this.DB))}8==r&&0!=(128&e[0])&&(this.s=-1,i>0&&(this.data[this.t-1]|=(1<<this.DB-i)-1<<i)),this.clamp(),a&&Ur.ZERO.subTo(this,this)},Ur.prototype.clamp=function(){for(var e=this.s&this.DM;this.t>0&&this.data[this.t-1]==e;)--this.t},Ur.prototype.dlShiftTo=function(e,t){var r;for(r=this.t-1;r>=0;--r)t.data[r+e]=this.data[r];for(r=e-1;r>=0;--r)t.data[r]=0;t.t=this.t+e,t.s=this.s},Ur.prototype.drShiftTo=function(e,t){for(var r=e;r<this.t;++r)t.data[r-e]=this.data[r];t.t=Math.max(this.t-e,0),t.s=this.s},Ur.prototype.lShiftTo=function(e,t){var r,n=e%this.DB,a=this.DB-n,i=(1<<a)-1,s=Math.floor(e/this.DB),o=this.s<<n&this.DM;for(r=this.t-1;r>=0;--r)t.data[r+s+1]=this.data[r]>>a|o,o=(this.data[r]&i)<<n;for(r=s-1;r>=0;--r)t.data[r]=0;t.data[s]=o,t.t=this.t+s+1,t.s=this.s,t.clamp()},Ur.prototype.rShiftTo=function(e,t){t.s=this.s;var r=Math.floor(e/this.DB);if(r>=this.t)t.t=0;else{var n=e%this.DB,a=this.DB-n,i=(1<<n)-1;t.data[0]=this.data[r]>>n;for(var s=r+1;s<this.t;++s)t.data[s-r-1]|=(this.data[s]&i)<<a,t.data[s-r]=this.data[s]>>n;n>0&&(t.data[this.t-r-1]|=(this.s&i)<<a),t.t=this.t-r,t.clamp()}},Ur.prototype.subTo=function(e,t){for(var r=0,n=0,a=Math.min(e.t,this.t);r<a;)n+=this.data[r]-e.data[r],t.data[r++]=n&this.DM,n>>=this.DB;if(e.t<this.t){for(n-=e.s;r<this.t;)n+=this.data[r],t.data[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<e.t;)n-=e.data[r],t.data[r++]=n&this.DM,n>>=this.DB;n-=e.s}t.s=n<0?-1:0,n<-1?t.data[r++]=this.DV+n:n>0&&(t.data[r++]=n),t.t=r,t.clamp()},Ur.prototype.multiplyTo=function(e,t){var r=this.abs(),n=e.abs(),a=r.t;for(t.t=a+n.t;--a>=0;)t.data[a]=0;for(a=0;a<n.t;++a)t.data[a+r.t]=r.am(0,n.data[a],t,a,0,r.t);t.s=0,t.clamp(),this.s!=e.s&&Ur.ZERO.subTo(t,t)},Ur.prototype.squareTo=function(e){for(var t=this.abs(),r=e.t=2*t.t;--r>=0;)e.data[r]=0;for(r=0;r<t.t-1;++r){var n=t.am(r,t.data[r],e,2*r,0,1);(e.data[r+t.t]+=t.am(r+1,2*t.data[r],e,2*r+1,n,t.t-r-1))>=t.DV&&(e.data[r+t.t]-=t.DV,e.data[r+t.t+1]=1)}e.t>0&&(e.data[e.t-1]+=t.am(r,t.data[r],e,2*r,0,1)),e.s=0,e.clamp()},Ur.prototype.divRemTo=function(e,t,r){var n=e.abs();if(!(n.t<=0)){var a=this.abs();if(a.t<n.t)return null!=t&&t.fromInt(0),void(null!=r&&this.copyTo(r));null==r&&(r=Lr());var i=Lr(),s=this.s,o=e.s,u=this.DB-jr(n.data[n.t-1]);u>0?(n.lShiftTo(u,i),a.lShiftTo(u,r)):(n.copyTo(i),a.copyTo(r));var c=i.t,l=i.data[c-1];if(0!=l){var f=l*(1<<this.F1)+(c>1?i.data[c-2]>>this.F2:0),h=this.FV/f,p=(1<<this.F1)/f,d=1<<this.F2,y=r.t,g=y-c,m=null==t?Lr():t;for(i.dlShiftTo(g,m),r.compareTo(m)>=0&&(r.data[r.t++]=1,r.subTo(m,r)),Ur.ONE.dlShiftTo(c,m),m.subTo(i,i);i.t<c;)i.data[i.t++]=0;for(;--g>=0;){var v=r.data[--y]==l?this.DM:Math.floor(r.data[y]*h+(r.data[y-1]+d)*p);if((r.data[y]+=i.am(0,v,r,g,0,c))<v)for(i.dlShiftTo(g,m),r.subTo(m,r);r.data[y]<--v;)r.subTo(m,r)}null!=t&&(r.drShiftTo(c,t),s!=o&&Ur.ZERO.subTo(t,t)),r.t=c,r.clamp(),u>0&&r.rShiftTo(u,r),s<0&&Ur.ZERO.subTo(r,r)}}},Ur.prototype.invDigit=function(){if(this.t<1)return 0;var e=this.data[0];if(0==(1&e))return 0;var t=3&e;return(t=(t=(t=(t=t*(2-(15&e)*t)&15)*(2-(255&e)*t)&255)*(2-((65535&e)*t&65535))&65535)*(2-e*t%this.DV)%this.DV)>0?this.DV-t:-t},Ur.prototype.isEven=function(){return 0==(this.t>0?1&this.data[0]:this.s)},Ur.prototype.exp=function(e,t){if(e>4294967295||e<1)return Ur.ONE;var r=Lr(),n=Lr(),a=t.convert(this),i=jr(e)-1;for(a.copyTo(r);--i>=0;)if(t.sqrTo(r,n),(e&1<<i)>0)t.mulTo(n,a,r);else{var s=r;r=n,n=s}return t.revert(r)},Ur.prototype.toString=function(e){if(this.s<0)return"-"+this.negate().toString(e);var t;if(16==e)t=4;else if(8==e)t=3;else if(2==e)t=1;else if(32==e)t=5;else{if(4!=e)return this.toRadix(e);t=2}var r,n=(1<<t)-1,a=!1,i="",s=this.t,o=this.DB-s*this.DB%t;if(s-- >0)for(o<this.DB&&(r=this.data[s]>>o)>0&&(a=!0,i=Kr(r));s>=0;)o<t?(r=(this.data[s]&(1<<o)-1)<<t-o,r|=this.data[--s]>>(o+=this.DB-t)):(r=this.data[s]>>(o-=t)&n,o<=0&&(o+=this.DB,--s)),r>0&&(a=!0),a&&(i+=Kr(r));return a?i:"0"},Ur.prototype.negate=function(){var e=Lr();return Ur.ZERO.subTo(this,e),e},Ur.prototype.abs=function(){return this.s<0?this.negate():this},Ur.prototype.compareTo=function(e){var t=this.s-e.s;if(0!=t)return t;var r=this.t;if(0!=(t=r-e.t))return this.s<0?-t:t;for(;--r>=0;)if(0!=(t=this.data[r]-e.data[r]))return t;return 0},Ur.prototype.bitLength=function(){return this.t<=0?0:this.DB*(this.t-1)+jr(this.data[this.t-1]^this.s&this.DM)},Ur.prototype.mod=function(e){var t=Lr();return this.abs().divRemTo(e,null,t),this.s<0&&t.compareTo(Ur.ZERO)>0&&e.subTo(t,t),t},Ur.prototype.modPowInt=function(e,t){var r;return r=e<256||t.isEven()?new Fr(t):new zr(t),this.exp(e,r)},Ur.ZERO=Mr(0),Ur.ONE=Mr(1),Yr.prototype.convert=Zr,Yr.prototype.revert=Zr,Yr.prototype.mulTo=function(e,t,r){e.multiplyTo(t,r)},Yr.prototype.sqrTo=function(e,t){e.squareTo(t)},Jr.prototype.convert=function(e){if(e.s<0||e.t>2*this.m.t)return e.mod(this.m);if(e.compareTo(this.m)<0)return e;var t=Lr();return e.copyTo(t),this.reduce(t),t},Jr.prototype.revert=function(e){return e},Jr.prototype.reduce=function(e){for(e.drShiftTo(this.m.t-1,this.r2),e.t>this.m.t+1&&(e.t=this.m.t+1,e.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);e.compareTo(this.r2)<0;)e.dAddOffset(1,this.m.t+1);for(e.subTo(this.r2,e);e.compareTo(this.m)>=0;)e.subTo(this.m,e)},Jr.prototype.mulTo=function(e,t,r){e.multiplyTo(t,r),this.reduce(r)},Jr.prototype.sqrTo=function(e,t){e.squareTo(t),this.reduce(t)};var $r=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509],en=(1<<26)/$r[$r.length-1];Ur.prototype.chunkSize=function(e){return Math.floor(Math.LN2*this.DB/Math.log(e))},Ur.prototype.toRadix=function(e){if(null==e&&(e=10),0==this.signum()||e<2||e>36)return"0";var t=this.chunkSize(e),r=Math.pow(e,t),n=Mr(r),a=Lr(),i=Lr(),s="";for(this.divRemTo(n,a,i);a.signum()>0;)s=(r+i.intValue()).toString(e).substr(1)+s,a.divRemTo(n,a,i);return i.intValue().toString(e)+s},Ur.prototype.fromRadix=function(e,t){this.fromInt(0),null==t&&(t=10);for(var r=this.chunkSize(t),n=Math.pow(t,r),a=!1,i=0,s=0,o=0;o<e.length;++o){var u=xr(e,o);u<0?"-"==e.charAt(o)&&0==this.signum()&&(a=!0):(s=t*s+u,++i>=r&&(this.dMultiply(n),this.dAddOffset(s,0),i=0,s=0))}i>0&&(this.dMultiply(Math.pow(t,i)),this.dAddOffset(s,0)),a&&Ur.ZERO.subTo(this,this)},Ur.prototype.fromNumber=function(e,t,r){if("number"==typeof t)if(e<2)this.fromInt(1);else for(this.fromNumber(e,r),this.testBit(e-1)||this.bitwiseTo(Ur.ONE.shiftLeft(e-1),Gr,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(t);)this.dAddOffset(2,0),this.bitLength()>e&&this.subTo(Ur.ONE.shiftLeft(e-1),this);else{var n=new Array,a=7&e;n.length=1+(e>>3),t.nextBytes(n),a>0?n[0]&=(1<<a)-1:n[0]=0,this.fromString(n,256)}},Ur.prototype.bitwiseTo=function(e,t,r){var n,a,i=Math.min(e.t,this.t);for(n=0;n<i;++n)r.data[n]=t(this.data[n],e.data[n]);if(e.t<this.t){for(a=e.s&this.DM,n=i;n<this.t;++n)r.data[n]=t(this.data[n],a);r.t=this.t}else{for(a=this.s&this.DM,n=i;n<e.t;++n)r.data[n]=t(a,e.data[n]);r.t=e.t}r.s=t(this.s,e.s),r.clamp()},Ur.prototype.changeBit=function(e,t){var r=Ur.ONE.shiftLeft(e);return this.bitwiseTo(r,t,r),r},Ur.prototype.addTo=function(e,t){for(var r=0,n=0,a=Math.min(e.t,this.t);r<a;)n+=this.data[r]+e.data[r],t.data[r++]=n&this.DM,n>>=this.DB;if(e.t<this.t){for(n+=e.s;r<this.t;)n+=this.data[r],t.data[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<e.t;)n+=e.data[r],t.data[r++]=n&this.DM,n>>=this.DB;n+=e.s}t.s=n<0?-1:0,n>0?t.data[r++]=n:n<-1&&(t.data[r++]=this.DV+n),t.t=r,t.clamp()},Ur.prototype.dMultiply=function(e){this.data[this.t]=this.am(0,e-1,this,0,0,this.t),++this.t,this.clamp()},Ur.prototype.dAddOffset=function(e,t){if(0!=e){for(;this.t<=t;)this.data[this.t++]=0;for(this.data[t]+=e;this.data[t]>=this.DV;)this.data[t]-=this.DV,++t>=this.t&&(this.data[this.t++]=0),++this.data[t]}},Ur.prototype.multiplyLowerTo=function(e,t,r){var n,a=Math.min(this.t+e.t,t);for(r.s=0,r.t=a;a>0;)r.data[--a]=0;for(n=r.t-this.t;a<n;++a)r.data[a+this.t]=this.am(0,e.data[a],r,a,0,this.t);for(n=Math.min(e.t,t);a<n;++a)this.am(0,e.data[a],r,a,0,t-a);r.clamp()},Ur.prototype.multiplyUpperTo=function(e,t,r){--t;var n=r.t=this.t+e.t-t;for(r.s=0;--n>=0;)r.data[n]=0;for(n=Math.max(t-this.t,0);n<e.t;++n)r.data[this.t+n-t]=this.am(t-n,e.data[n],r,0,0,this.t+n-t);r.clamp(),r.drShiftTo(1,r)},Ur.prototype.modInt=function(e){if(e<=0)return 0;var t=this.DV%e,r=this.s<0?e-1:0;if(this.t>0)if(0==t)r=this.data[0]%e;else for(var n=this.t-1;n>=0;--n)r=(t*r+this.data[n])%e;return r},Ur.prototype.millerRabin=function(e){var t=this.subtract(Ur.ONE),r=t.getLowestSetBit();if(r<=0)return!1;for(var n,a=t.shiftRight(r),i={nextBytes:function(e){for(var t=0;t<e.length;++t)e[t]=Math.floor(256*Math.random())}},s=0;s<e;++s){do{n=new Ur(this.bitLength(),i)}while(n.compareTo(Ur.ONE)<=0||n.compareTo(t)>=0);var o=n.modPow(a,this);if(0!=o.compareTo(Ur.ONE)&&0!=o.compareTo(t)){for(var u=1;u++<r&&0!=o.compareTo(t);)if(0==(o=o.modPowInt(2,this)).compareTo(Ur.ONE))return!1;if(0!=o.compareTo(t))return!1}}return!0},Ur.prototype.clone=function(){var e=Lr();return this.copyTo(e),e},Ur.prototype.intValue=function(){if(this.s<0){if(1==this.t)return this.data[0]-this.DV;if(0==this.t)return-1}else{if(1==this.t)return this.data[0];if(0==this.t)return 0}return(this.data[1]&(1<<32-this.DB)-1)<<this.DB|this.data[0]},Ur.prototype.byteValue=function(){return 0==this.t?this.s:this.data[0]<<24>>24},Ur.prototype.shortValue=function(){return 0==this.t?this.s:this.data[0]<<16>>16},Ur.prototype.signum=function(){return this.s<0?-1:this.t<=0||1==this.t&&this.data[0]<=0?0:1},Ur.prototype.toByteArray=function(){var e=this.t,t=new Array;t[0]=this.s;var r,n=this.DB-e*this.DB%8,a=0;if(e-- >0)for(n<this.DB&&(r=this.data[e]>>n)!=(this.s&this.DM)>>n&&(t[a++]=r|this.s<<this.DB-n);e>=0;)n<8?(r=(this.data[e]&(1<<n)-1)<<8-n,r|=this.data[--e]>>(n+=this.DB-8)):(r=this.data[e]>>(n-=8)&255,n<=0&&(n+=this.DB,--e)),0!=(128&r)&&(r|=-256),0==a&&(128&this.s)!=(128&r)&&++a,(a>0||r!=this.s)&&(t[a++]=r);return t},Ur.prototype.equals=function(e){return 0==this.compareTo(e)},Ur.prototype.min=function(e){return this.compareTo(e)<0?this:e},Ur.prototype.max=function(e){return this.compareTo(e)>0?this:e},Ur.prototype.and=function(e){var t=Lr();return this.bitwiseTo(e,qr,t),t},Ur.prototype.or=function(e){var t=Lr();return this.bitwiseTo(e,Gr,t),t},Ur.prototype.xor=function(e){var t=Lr();return this.bitwiseTo(e,Qr,t),t},Ur.prototype.andNot=function(e){var t=Lr();return this.bitwiseTo(e,Hr,t),t},Ur.prototype.not=function(){for(var e=Lr(),t=0;t<this.t;++t)e.data[t]=this.DM&~this.data[t];return e.t=this.t,e.s=~this.s,e},Ur.prototype.shiftLeft=function(e){var t=Lr();return e<0?this.rShiftTo(-e,t):this.lShiftTo(e,t),t},Ur.prototype.shiftRight=function(e){var t=Lr();return e<0?this.lShiftTo(-e,t):this.rShiftTo(e,t),t},Ur.prototype.getLowestSetBit=function(){for(var e=0;e<this.t;++e)if(0!=this.data[e])return e*this.DB+Wr(this.data[e]);return this.s<0?this.t*this.DB:-1},Ur.prototype.bitCount=function(){for(var e=0,t=this.s&this.DM,r=0;r<this.t;++r)e+=Xr(this.data[r]^t);return e},Ur.prototype.testBit=function(e){var t=Math.floor(e/this.DB);return t>=this.t?0!=this.s:0!=(this.data[t]&1<<e%this.DB)},Ur.prototype.setBit=function(e){return this.changeBit(e,Gr)},Ur.prototype.clearBit=function(e){return this.changeBit(e,Hr)},Ur.prototype.flipBit=function(e){return this.changeBit(e,Qr)},Ur.prototype.add=function(e){var t=Lr();return this.addTo(e,t),t},Ur.prototype.subtract=function(e){var t=Lr();return this.subTo(e,t),t},Ur.prototype.multiply=function(e){var t=Lr();return this.multiplyTo(e,t),t},Ur.prototype.divide=function(e){var t=Lr();return this.divRemTo(e,t,null),t},Ur.prototype.remainder=function(e){var t=Lr();return this.divRemTo(e,null,t),t},Ur.prototype.divideAndRemainder=function(e){var t=Lr(),r=Lr();return this.divRemTo(e,t,r),new Array(t,r)},Ur.prototype.modPow=function(e,t){var r,n,a=e.bitLength(),i=Mr(1);if(a<=0)return i;r=a<18?1:a<48?3:a<144?4:a<768?5:6,n=a<8?new Fr(t):t.isEven()?new Jr(t):new zr(t);var s=new Array,o=3,u=r-1,c=(1<<r)-1;if(s[1]=n.convert(this),r>1){var l=Lr();for(n.sqrTo(s[1],l);o<=c;)s[o]=Lr(),n.mulTo(l,s[o-2],s[o]),o+=2}var f,h,p=e.t-1,d=!0,y=Lr();for(a=jr(e.data[p])-1;p>=0;){for(a>=u?f=e.data[p]>>a-u&c:(f=(e.data[p]&(1<<a+1)-1)<<u-a,p>0&&(f|=e.data[p-1]>>this.DB+a-u)),o=r;0==(1&f);)f>>=1,--o;if((a-=o)<0&&(a+=this.DB,--p),d)s[f].copyTo(i),d=!1;else{for(;o>1;)n.sqrTo(i,y),n.sqrTo(y,i),o-=2;o>0?n.sqrTo(i,y):(h=i,i=y,y=h),n.mulTo(y,s[f],i)}for(;p>=0&&0==(e.data[p]&1<<a);)n.sqrTo(i,y),h=i,i=y,y=h,--a<0&&(a=this.DB-1,--p)}return n.revert(i)},Ur.prototype.modInverse=function(e){var t=e.isEven();if(this.isEven()&&t||0==e.signum())return Ur.ZERO;for(var r=e.clone(),n=this.clone(),a=Mr(1),i=Mr(0),s=Mr(0),o=Mr(1);0!=r.signum();){for(;r.isEven();)r.rShiftTo(1,r),t?(a.isEven()&&i.isEven()||(a.addTo(this,a),i.subTo(e,i)),a.rShiftTo(1,a)):i.isEven()||i.subTo(e,i),i.rShiftTo(1,i);for(;n.isEven();)n.rShiftTo(1,n),t?(s.isEven()&&o.isEven()||(s.addTo(this,s),o.subTo(e,o)),s.rShiftTo(1,s)):o.isEven()||o.subTo(e,o),o.rShiftTo(1,o);r.compareTo(n)>=0?(r.subTo(n,r),t&&a.subTo(s,a),i.subTo(o,i)):(n.subTo(r,n),t&&s.subTo(a,s),o.subTo(i,o))}return 0!=n.compareTo(Ur.ONE)?Ur.ZERO:o.compareTo(e)>=0?o.subtract(e):o.signum()<0?(o.addTo(e,o),o.signum()<0?o.add(e):o):o},Ur.prototype.pow=function(e){return this.exp(e,new Yr)},Ur.prototype.gcd=function(e){var t=this.s<0?this.negate():this.clone(),r=e.s<0?e.negate():e.clone();if(t.compareTo(r)<0){var n=t;t=r,r=n}var a=t.getLowestSetBit(),i=r.getLowestSetBit();if(i<0)return t;for(a<i&&(i=a),i>0&&(t.rShiftTo(i,t),r.rShiftTo(i,r));t.signum()>0;)(a=t.getLowestSetBit())>0&&t.rShiftTo(a,t),(a=r.getLowestSetBit())>0&&r.rShiftTo(a,r),t.compareTo(r)>=0?(t.subTo(r,t),t.rShiftTo(1,t)):(r.subTo(t,r),r.rShiftTo(1,r));return i>0&&r.lShiftTo(i,r),r},Ur.prototype.isProbablePrime=function(e){var t,r=this.abs();if(1==r.t&&r.data[0]<=$r[$r.length-1]){for(t=0;t<$r.length;++t)if(r.data[0]==$r[t])return!0;return!1}if(r.isEven())return!1;for(t=1;t<$r.length;){for(var n=$r[t],a=t+1;a<$r.length&&n<en;)n*=$r[a++];for(n=r.modInt(n);t<a;)if(n%$r[t++]==0)return!1}return r.millerRabin(e)};var tn=c.sha1=c.sha1||{};c.md.sha1=c.md.algorithms.sha1=tn,tn.create=function(){nn||(rn=String.fromCharCode(128),rn+=c.util.fillString(String.fromCharCode(0),64),nn=!0);var e=null,t=c.util.createBuffer(),r=new Array(80),n={algorithm:"sha1",blockLength:64,digestLength:20,messageLength:0,fullMessageLength:null,messageLengthSize:8,start:function(){n.messageLength=0,n.fullMessageLength=n.messageLength64=[];for(var r=n.messageLengthSize/4,a=0;a<r;++a)n.fullMessageLength.push(0);return t=c.util.createBuffer(),e={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878,h4:3285377520},n}};return n.start(),n.update=function(a,i){"utf8"===i&&(a=c.util.encodeUtf8(a));var s=a.length;n.messageLength+=s,s=[s/4294967296>>>0,s>>>0];for(var o=n.fullMessageLength.length-1;o>=0;--o)n.fullMessageLength[o]+=s[1],s[1]=s[0]+(n.fullMessageLength[o]/4294967296>>>0),n.fullMessageLength[o]=n.fullMessageLength[o]>>>0,s[0]=s[1]/4294967296>>>0;return t.putBytes(a),an(e,r,t),(t.read>2048||0===t.length())&&t.compact(),n},n.digest=function(){var a=c.util.createBuffer();a.putBytes(t.bytes());var i,s=n.fullMessageLength[n.fullMessageLength.length-1]+n.messageLengthSize&n.blockLength-1;a.putBytes(rn.substr(0,n.blockLength-s));for(var o=8*n.fullMessageLength[0],u=0;u<n.fullMessageLength.length-1;++u)o+=(i=8*n.fullMessageLength[u+1])/4294967296>>>0,a.putInt32(o>>>0),o=i>>>0;a.putInt32(o);var l={h0:e.h0,h1:e.h1,h2:e.h2,h3:e.h3,h4:e.h4};an(l,r,a);var f=c.util.createBuffer();return f.putInt32(l.h0),f.putInt32(l.h1),f.putInt32(l.h2),f.putInt32(l.h3),f.putInt32(l.h4),f},n};var rn=null,nn=!1;function an(e,t,r){for(var n,a,i,s,o,u,c,l=r.length();l>=64;){for(a=e.h0,i=e.h1,s=e.h2,o=e.h3,u=e.h4,c=0;c<16;++c)n=r.getInt32(),t[c]=n,n=(a<<5|a>>>27)+(o^i&(s^o))+u+1518500249+n,u=o,o=s,s=(i<<30|i>>>2)>>>0,i=a,a=n;for(;c<20;++c)n=(n=t[c-3]^t[c-8]^t[c-14]^t[c-16])<<1|n>>>31,t[c]=n,n=(a<<5|a>>>27)+(o^i&(s^o))+u+1518500249+n,u=o,o=s,s=(i<<30|i>>>2)>>>0,i=a,a=n;for(;c<32;++c)n=(n=t[c-3]^t[c-8]^t[c-14]^t[c-16])<<1|n>>>31,t[c]=n,n=(a<<5|a>>>27)+(i^s^o)+u+1859775393+n,u=o,o=s,s=(i<<30|i>>>2)>>>0,i=a,a=n;for(;c<40;++c)n=(n=t[c-6]^t[c-16]^t[c-28]^t[c-32])<<2|n>>>30,t[c]=n,n=(a<<5|a>>>27)+(i^s^o)+u+1859775393+n,u=o,o=s,s=(i<<30|i>>>2)>>>0,i=a,a=n;for(;c<60;++c)n=(n=t[c-6]^t[c-16]^t[c-28]^t[c-32])<<2|n>>>30,t[c]=n,n=(a<<5|a>>>27)+(i&s|o&(i^s))+u+2400959708+n,u=o,o=s,s=(i<<30|i>>>2)>>>0,i=a,a=n;for(;c<80;++c)n=(n=t[c-6]^t[c-16]^t[c-28]^t[c-32])<<2|n>>>30,t[c]=n,n=(a<<5|a>>>27)+(i^s^o)+u+3395469782+n,u=o,o=s,s=(i<<30|i>>>2)>>>0,i=a,a=n;e.h0=e.h0+a|0,e.h1=e.h1+i|0,e.h2=e.h2+s|0,e.h3=e.h3+o|0,e.h4=e.h4+u|0,l-=64}}var sn=c.pkcs1=c.pkcs1||{};function on(e,t,r){r||(r=c.md.sha1.create());for(var n="",a=Math.ceil(t/r.digestLength),i=0;i<a;++i){var s=String.fromCharCode(i>>24&255,i>>16&255,i>>8&255,255&i);r.start(),r.update(e+s),n+=r.digest().getBytes()}return n.substring(0,t)}sn.encode_rsa_oaep=function(e,t,r){var n,a,i,s;"string"==typeof r?(n=r,a=arguments[3]||void 0,i=arguments[4]||void 0):r&&(n=r.label||void 0,a=r.seed||void 0,i=r.md||void 0,r.mgf1&&r.mgf1.md&&(s=r.mgf1.md)),i?i.start():i=c.md.sha1.create(),s||(s=i);var o=Math.ceil(e.n.bitLength()/8),u=o-2*i.digestLength-2;if(t.length>u)throw(d=new Error("RSAES-OAEP input message length is too long.")).length=t.length,d.maxLength=u,d;n||(n=""),i.update(n,"raw");for(var l=i.digest(),f="",h=u-t.length,p=0;p<h;p++)f+="\0";var d,y=l.getBytes()+f+"\x01"+t;if(a){if(a.length!==i.digestLength)throw(d=new Error("Invalid RSAES-OAEP seed. The seed length must match the digest length.")).seedLength=a.length,d.digestLength=i.digestLength,d}else a=c.random.getBytes(i.digestLength);var g=on(a,o-i.digestLength-1,s),m=c.util.xorBytes(y,g,y.length),v=on(m,i.digestLength,s);return"\0"+c.util.xorBytes(a,v,a.length)+m},sn.decode_rsa_oaep=function(e,t,r){var n,a,i;"string"==typeof r?(n=r,a=arguments[3]||void 0):r&&(n=r.label||void 0,a=r.md||void 0,r.mgf1&&r.mgf1.md&&(i=r.mgf1.md));var s=Math.ceil(e.n.bitLength()/8);if(t.length!==s)throw(g=new Error("RSAES-OAEP encoded message length is invalid.")).length=t.length,g.expectedLength=s,g;if(void 0===a?a=c.md.sha1.create():a.start(),i||(i=a),s<2*a.digestLength+2)throw new Error("RSAES-OAEP key is too short for the hash function.");n||(n=""),a.update(n,"raw");for(var o=a.digest().getBytes(),u=t.charAt(0),l=t.substring(1,a.digestLength+1),f=t.substring(1+a.digestLength),h=on(f,a.digestLength,i),p=on(c.util.xorBytes(l,h,l.length),s-a.digestLength-1,i),d=c.util.xorBytes(f,p,f.length),y=d.substring(0,a.digestLength),g="\0"!==u,m=0;m<a.digestLength;++m)g|=o.charAt(m)!==y.charAt(m);for(var v=1,E=a.digestLength,C=a.digestLength;C<d.length;C++){var b=d.charCodeAt(C);g|=b&(v?65534:0),E+=v&=1&b^1}if(g||1!==d.charCodeAt(E))throw new Error("Invalid RSAES-OAEP padding.");return d.substring(E+1)};!function(){if(c.prime)c.prime;else{var e=c.prime=c.prime||{},t=c.jsbn.BigInteger,r=[6,4,2,4,2,4,6,2],n=new t(null);n.fromInt(30);var a=function(e,t){return e|t};e.generateProbablePrime=function(e,r,n){"function"==typeof r&&(n=r,r={});var a=(r=r||{}).algorithm||"PRIMEINC";"string"==typeof a&&(a={name:a}),a.options=a.options||{};var o=r.prng||c.random,u={nextBytes:function(e){for(var t=o.getBytesSync(e.length),r=0;r<e.length;++r)e[r]=t.charCodeAt(r)}};if("PRIMEINC"===a.name)return function(e,r,n,a){return"workers"in n?function(e,r,n,a){if("undefined"==typeof Worker)return i(e,r,n,a);var o=s(e,r),u=n.workers,l=n.workLoad||100,f=30*l/8,h=n.workerScript||"forge/prime.worker.js";if(-1===u)return c.util.estimateCores(function(e,t){e&&(t=2),u=t-1,p()});function p(){u=Math.max(1,u);for(var n=[],i=0;i<u;++i)n[i]=new Worker(h);for(i=0;i<u;++i)n[i].addEventListener("message",p);var c=!1;function p(i){if(!c){var u=i.data;if(u.found){for(var h=0;h<n.length;++h)n[h].terminate();return c=!0,a(null,new t(u.prime,16))}o.bitLength()>e&&(o=s(e,r));var p=o.toString(16);i.target.postMessage({hex:p,workLoad:l}),o.dAddOffset(f,0)}}}p()}(e,r,n,a):i(e,r,n,a)}(e,u,a.options,n);throw new Error("Invalid prime generation algorithm: "+a.name)}}function i(e,t,n,a){var i=s(e,t),o=function(e){return e<=100?27:e<=150?18:e<=200?15:e<=250?12:e<=300?9:e<=350?8:e<=400?7:e<=500?6:e<=600?5:e<=800?4:e<=1250?3:2}(i.bitLength());"millerRabinTests"in n&&(o=n.millerRabinTests);var u=10;"maxBlockTime"in n&&(u=n.maxBlockTime),function e(t,n,a,i,o,u,l){var f=+new Date;do{if(t.bitLength()>n&&(t=s(n,a)),t.isProbablePrime(o))return l(null,t);t.dAddOffset(r[i++%8],0)}while(u<0||+new Date-f<u);c.util.setImmediate(function(){e(t,n,a,i,o,u,l)})}(i,e,t,0,o,u,a)}function s(e,r){var i=new t(e,r),s=e-1;return i.testBit(s)||i.bitwiseTo(t.ONE.shiftLeft(s),a,i),i.dAddOffset(31-i.mod(n).byteValue(),0),i}}();if(void 0===un)var un=c.jsbn.BigInteger;var cn=c.util.isNodejs?l:null,ln=c.asn1,fn=c.util;c.pki=c.pki||{},c.pki.rsa=c.rsa=c.rsa||{};var hn=c.pki,pn=[6,4,2,4,2,4,6,2],dn={name:"PrivateKeyInfo",tagClass:ln.Class.UNIVERSAL,type:ln.Type.SEQUENCE,constructed:!0,value:[{name:"PrivateKeyInfo.version",tagClass:ln.Class.UNIVERSAL,type:ln.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:ln.Class.UNIVERSAL,type:ln.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:ln.Class.UNIVERSAL,type:ln.Type.OID,constructed:!1,capture:"privateKeyOid"}]},{name:"PrivateKeyInfo",tagClass:ln.Class.UNIVERSAL,type:ln.Type.OCTETSTRING,constructed:!1,capture:"privateKey"}]},yn={name:"RSAPrivateKey",tagClass:ln.Class.UNIVERSAL,type:ln.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPrivateKey.version",tagClass:ln.Class.UNIVERSAL,type:ln.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"RSAPrivateKey.modulus",tagClass:ln.Class.UNIVERSAL,type:ln.Type.INTEGER,constructed:!1,capture:"privateKeyModulus"},{name:"RSAPrivateKey.publicExponent",tagClass:ln.Class.UNIVERSAL,type:ln.Type.INTEGER,constructed:!1,capture:"privateKeyPublicExponent"},{name:"RSAPrivateKey.privateExponent",tagClass:ln.Class.UNIVERSAL,type:ln.Type.INTEGER,constructed:!1,capture:"privateKeyPrivateExponent"},{name:"RSAPrivateKey.prime1",tagClass:ln.Class.UNIVERSAL,type:ln.Type.INTEGER,constructed:!1,capture:"privateKeyPrime1"},{name:"RSAPrivateKey.prime2",tagClass:ln.Class.UNIVERSAL,type:ln.Type.INTEGER,constructed:!1,capture:"privateKeyPrime2"},{name:"RSAPrivateKey.exponent1",tagClass:ln.Class.UNIVERSAL,type:ln.Type.INTEGER,constructed:!1,capture:"privateKeyExponent1"},{name:"RSAPrivateKey.exponent2",tagClass:ln.Class.UNIVERSAL,type:ln.Type.INTEGER,constructed:!1,capture:"privateKeyExponent2"},{name:"RSAPrivateKey.coefficient",tagClass:ln.Class.UNIVERSAL,type:ln.Type.INTEGER,constructed:!1,capture:"privateKeyCoefficient"}]},gn={name:"RSAPublicKey",tagClass:ln.Class.UNIVERSAL,type:ln.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPublicKey.modulus",tagClass:ln.Class.UNIVERSAL,type:ln.Type.INTEGER,constructed:!1,capture:"publicKeyModulus"},{name:"RSAPublicKey.exponent",tagClass:ln.Class.UNIVERSAL,type:ln.Type.INTEGER,constructed:!1,capture:"publicKeyExponent"}]},mn=c.pki.rsa.publicKeyValidator={name:"SubjectPublicKeyInfo",tagClass:ln.Class.UNIVERSAL,type:ln.Type.SEQUENCE,constructed:!0,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:ln.Class.UNIVERSAL,type:ln.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:ln.Class.UNIVERSAL,type:ln.Type.OID,constructed:!1,capture:"publicKeyOid"}]},{name:"SubjectPublicKeyInfo.subjectPublicKey",tagClass:ln.Class.UNIVERSAL,type:ln.Type.BITSTRING,constructed:!1,value:[{name:"SubjectPublicKeyInfo.subjectPublicKey.RSAPublicKey",tagClass:ln.Class.UNIVERSAL,type:ln.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"rsaPublicKey"}]}]},vn=function(e){var t;if(!(e.algorithm in hn.oids)){var r=new Error("Unknown message digest algorithm.");throw r.algorithm=e.algorithm,r}t=hn.oids[e.algorithm];var n=ln.oidToDer(t).getBytes(),a=ln.create(ln.Class.UNIVERSAL,ln.Type.SEQUENCE,!0,[]),i=ln.create(ln.Class.UNIVERSAL,ln.Type.SEQUENCE,!0,[]);i.value.push(ln.create(ln.Class.UNIVERSAL,ln.Type.OID,!1,n)),i.value.push(ln.create(ln.Class.UNIVERSAL,ln.Type.NULL,!1,""));var s=ln.create(ln.Class.UNIVERSAL,ln.Type.OCTETSTRING,!1,e.digest().getBytes());return a.value.push(i),a.value.push(s),ln.toDer(a).getBytes()},En=function(e,t,r){if(r)return e.modPow(t.e,t.n);if(!t.p||!t.q)return e.modPow(t.d,t.n);var n;t.dP||(t.dP=t.d.mod(t.p.subtract(un.ONE))),t.dQ||(t.dQ=t.d.mod(t.q.subtract(un.ONE))),t.qInv||(t.qInv=t.q.modInverse(t.p));do{n=new un(c.util.bytesToHex(c.random.getBytes(t.n.bitLength()/8)),16)}while(n.compareTo(t.n)>=0||!n.gcd(t.n).equals(un.ONE));for(var a=(e=e.multiply(n.modPow(t.e,t.n)).mod(t.n)).mod(t.p).modPow(t.dP,t.p),i=e.mod(t.q).modPow(t.dQ,t.q);a.compareTo(i)<0;)a=a.add(t.p);var s=a.subtract(i).multiply(t.qInv).mod(t.p).multiply(t.q).add(i);return s.multiply(n.modInverse(t.n)).mod(t.n)};function Cn(e,t,r){var n=c.util.createBuffer(),a=Math.ceil(t.n.bitLength()/8);if(e.length>a-11){var i=new Error("Message is too long for PKCS#1 v1.5 padding.");throw i.length=e.length,i.max=a-11,i}n.putByte(0),n.putByte(r);var s,o=a-3-e.length;if(0===r||1===r){s=0===r?0:255;for(var u=0;u<o;++u)n.putByte(s)}else for(;o>0;){var l=0,f=c.random.getBytes(o);for(u=0;u<o;++u)0===(s=f.charCodeAt(u))?++l:n.putByte(s);o=l}return n.putByte(0),n.putBytes(e),n}function bn(e,t,r,n){var a=Math.ceil(t.n.bitLength()/8),i=c.util.createBuffer(e),s=i.getByte(),o=i.getByte();if(0!==s||r&&0!==o&&1!==o||!r&&2!=o||r&&0===o&&void 0===n)throw new Error("Encryption block is invalid.");var u=0;if(0===o){u=a-3-n;for(var l=0;l<u;++l)if(0!==i.getByte())throw new Error("Encryption block is invalid.")}else if(1===o)for(u=0;i.length()>1;){if(255!==i.getByte()){--i.read;break}++u}else if(2===o)for(u=0;i.length()>1;){if(0===i.getByte()){--i.read;break}++u}if(0!==i.getByte()||u!==a-3-i.length())throw new Error("Encryption block is invalid.");return i.getBytes()}function Sn(e){var t=e.toString(16);t[0]>="8"&&(t="00"+t);var r=c.util.hexToBytes(t);return r.length>1&&(0===r.charCodeAt(0)&&0==(128&r.charCodeAt(1))||255===r.charCodeAt(0)&&128==(128&r.charCodeAt(1)))?r.substr(1):r}function Tn(e){return e<=100?27:e<=150?18:e<=200?15:e<=250?12:e<=300?9:e<=350?8:e<=400?7:e<=500?6:e<=600?5:e<=800?4:e<=1250?3:2}function In(e){return c.util.isNodejs&&"function"==typeof cn[e]}function An(e){return void 0!==fn.globalScope&&"object"==typeof fn.globalScope.crypto&&"object"==typeof fn.globalScope.crypto.subtle&&"function"==typeof fn.globalScope.crypto.subtle[e]}function wn(e){return void 0!==fn.globalScope&&"object"==typeof fn.globalScope.msCrypto&&"object"==typeof fn.globalScope.msCrypto.subtle&&"function"==typeof fn.globalScope.msCrypto.subtle[e]}function Bn(e){for(var t=c.util.hexToBytes(e.toString(16)),r=new Uint8Array(t.length),n=0;n<t.length;++n)r[n]=t.charCodeAt(n);return r}if(hn.rsa.encrypt=function(e,t,r){var n,a=r,i=Math.ceil(t.n.bitLength()/8);!1!==r&&!0!==r?(a=2===r,n=Cn(e,t,r)):(n=c.util.createBuffer()).putBytes(e);for(var s=new un(n.toHex(),16),o=En(s,t,a).toString(16),u=c.util.createBuffer(),l=i-Math.ceil(o.length/2);l>0;)u.putByte(0),--l;return u.putBytes(c.util.hexToBytes(o)),u.getBytes()},hn.rsa.decrypt=function(e,t,r,n){var a=Math.ceil(t.n.bitLength()/8);if(e.length!==a){var i=new Error("Encrypted message length is invalid.");throw i.length=e.length,i.expected=a,i}var s=new un(c.util.createBuffer(e).toHex(),16);if(s.compareTo(t.n)>=0)throw new Error("Encrypted message is invalid.");for(var o=En(s,t,r).toString(16),u=c.util.createBuffer(),l=a-Math.ceil(o.length/2);l>0;)u.putByte(0),--l;return u.putBytes(c.util.hexToBytes(o)),!1!==n?bn(u.getBytes(),t,r):u.getBytes()},hn.rsa.createKeyPairGenerationState=function(e,t,r){"string"==typeof e&&(e=parseInt(e,10)),e=e||2048;var n,a=(r=r||{}).prng||c.random,i={nextBytes:function(e){for(var t=a.getBytesSync(e.length),r=0;r<e.length;++r)e[r]=t.charCodeAt(r)}},s=r.algorithm||"PRIMEINC";if("PRIMEINC"!==s)throw new Error("Invalid key generation algorithm: "+s);return(n={algorithm:s,state:0,bits:e,rng:i,eInt:t||65537,e:new un(null),p:null,q:null,qBits:e>>1,pBits:e-(e>>1),pqState:0,num:null,keys:null}).e.fromInt(n.eInt),n},hn.rsa.stepKeyPairGenerationState=function(e,t){"algorithm"in e||(e.algorithm="PRIMEINC");var r=new un(null);r.fromInt(30);for(var n,a=0,i=function(e,t){return e|t},s=+new Date,o=0;null===e.keys&&(t<=0||o<t);){if(0===e.state){var u=null===e.p?e.pBits:e.qBits,c=u-1;0===e.pqState?(e.num=new un(u,e.rng),e.num.testBit(c)||e.num.bitwiseTo(un.ONE.shiftLeft(c),i,e.num),e.num.dAddOffset(31-e.num.mod(r).byteValue(),0),a=0,++e.pqState):1===e.pqState?e.num.bitLength()>u?e.pqState=0:e.num.isProbablePrime(Tn(e.num.bitLength()))?++e.pqState:e.num.dAddOffset(pn[a++%8],0):2===e.pqState?e.pqState=0===e.num.subtract(un.ONE).gcd(e.e).compareTo(un.ONE)?3:0:3===e.pqState&&(e.pqState=0,null===e.p?e.p=e.num:e.q=e.num,null!==e.p&&null!==e.q&&++e.state,e.num=null)}else if(1===e.state)e.p.compareTo(e.q)<0&&(e.num=e.p,e.p=e.q,e.q=e.num),++e.state;else if(2===e.state)e.p1=e.p.subtract(un.ONE),e.q1=e.q.subtract(un.ONE),e.phi=e.p1.multiply(e.q1),++e.state;else if(3===e.state)0===e.phi.gcd(e.e).compareTo(un.ONE)?++e.state:(e.p=null,e.q=null,e.state=0);else if(4===e.state)e.n=e.p.multiply(e.q),e.n.bitLength()===e.bits?++e.state:(e.q=null,e.state=0);else if(5===e.state){var l=e.e.modInverse(e.phi);e.keys={privateKey:hn.rsa.setPrivateKey(e.n,e.e,l,e.p,e.q,l.mod(e.p1),l.mod(e.q1),e.q.modInverse(e.p)),publicKey:hn.rsa.setPublicKey(e.n,e.e)}}o+=(n=+new Date)-s,s=n}return null!==e.keys},hn.rsa.generateKeyPair=function(e,t,r,n){if(1===arguments.length?"object"==typeof e?(r=e,e=void 0):"function"==typeof e&&(n=e,e=void 0):2===arguments.length?"number"==typeof e?"function"==typeof t?(n=t,t=void 0):"number"!=typeof t&&(r=t,t=void 0):(r=e,n=t,e=void 0,t=void 0):3===arguments.length&&("number"==typeof t?"function"==typeof r&&(n=r,r=void 0):(n=r,r=t,t=void 0)),r=r||{},void 0===e&&(e=r.bits||2048),void 0===t&&(t=r.e||65537),!c.options.usePureJavaScript&&!r.prng&&e>=256&&e<=16384&&(65537===t||3===t))if(n){if(In("generateKeyPair"))return cn.generateKeyPair("rsa",{modulusLength:e,publicExponent:t,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}},function(e,t,r){if(e)return n(e);n(null,{privateKey:hn.privateKeyFromPem(r),publicKey:hn.publicKeyFromPem(t)})});if(An("generateKey")&&An("exportKey"))return fn.globalScope.crypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:e,publicExponent:Bn(t),hash:{name:"SHA-256"}},!0,["sign","verify"]).then(function(e){return fn.globalScope.crypto.subtle.exportKey("pkcs8",e.privateKey)}).then(void 0,function(e){n(e)}).then(function(e){if(e){var t=hn.privateKeyFromAsn1(ln.fromDer(c.util.createBuffer(e)));n(null,{privateKey:t,publicKey:hn.setRsaPublicKey(t.n,t.e)})}});if(wn("generateKey")&&wn("exportKey")){var a=fn.globalScope.msCrypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:e,publicExponent:Bn(t),hash:{name:"SHA-256"}},!0,["sign","verify"]);return a.oncomplete=function(e){var t=e.target.result,r=fn.globalScope.msCrypto.subtle.exportKey("pkcs8",t.privateKey);r.oncomplete=function(e){var t=e.target.result,r=hn.privateKeyFromAsn1(ln.fromDer(c.util.createBuffer(t)));n(null,{privateKey:r,publicKey:hn.setRsaPublicKey(r.n,r.e)})},r.onerror=function(e){n(e)}},void(a.onerror=function(e){n(e)})}}else if(In("generateKeyPairSync")){var i=cn.generateKeyPairSync("rsa",{modulusLength:e,publicExponent:t,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}});return{privateKey:hn.privateKeyFromPem(i.privateKey),publicKey:hn.publicKeyFromPem(i.publicKey)}}var s=hn.rsa.createKeyPairGenerationState(e,t,r);if(!n)return hn.rsa.stepKeyPairGenerationState(s,0),s.keys;!function(e,t,r){"function"==typeof t&&(r=t,t={});var n={algorithm:{name:(t=t||{}).algorithm||"PRIMEINC",options:{workers:t.workers||2,workLoad:t.workLoad||100,workerScript:t.workerScript}}};function a(){i(e.pBits,function(t,n){return t?r(t):(e.p=n,null!==e.q?s(t,e.q):void i(e.qBits,s))})}function i(e,t){c.prime.generateProbablePrime(e,n,t)}function s(t,n){if(t)return r(t);if(e.q=n,e.p.compareTo(e.q)<0){var o=e.p;e.p=e.q,e.q=o}if(0!==e.p.subtract(un.ONE).gcd(e.e).compareTo(un.ONE))return e.p=null,void a();if(0!==e.q.subtract(un.ONE).gcd(e.e).compareTo(un.ONE))return e.q=null,void i(e.qBits,s);if(e.p1=e.p.subtract(un.ONE),e.q1=e.q.subtract(un.ONE),e.phi=e.p1.multiply(e.q1),0!==e.phi.gcd(e.e).compareTo(un.ONE))return e.p=e.q=null,void a();if(e.n=e.p.multiply(e.q),e.n.bitLength()!==e.bits)return e.q=null,void i(e.qBits,s);var u=e.e.modInverse(e.phi);e.keys={privateKey:hn.rsa.setPrivateKey(e.n,e.e,u,e.p,e.q,u.mod(e.p1),u.mod(e.q1),e.q.modInverse(e.p)),publicKey:hn.rsa.setPublicKey(e.n,e.e)},r(null,e.keys)}"prng"in t&&(n.prng=t.prng),a()}(s,r,n)},hn.setRsaPublicKey=hn.rsa.setPublicKey=function(e,t){var r={n:e,e:t,encrypt:function(e,t,n){if("string"==typeof t?t=t.toUpperCase():void 0===t&&(t="RSAES-PKCS1-V1_5"),"RSAES-PKCS1-V1_5"===t)t={encode:function(e,t,r){return Cn(e,t,2).getBytes()}};else if("RSA-OAEP"===t||"RSAES-OAEP"===t)t={encode:function(e,t){return c.pkcs1.encode_rsa_oaep(t,e,n)}};else if(-1!==["RAW","NONE","NULL",null].indexOf(t))t={encode:function(e){return e}};else if("string"==typeof t)throw new Error('Unsupported encryption scheme: "'+t+'".');var a=t.encode(e,r,!0);return hn.rsa.encrypt(a,r,!0)},verify:function(e,t,n){"string"==typeof n?n=n.toUpperCase():void 0===n&&(n="RSASSA-PKCS1-V1_5"),"RSASSA-PKCS1-V1_5"===n?n={verify:function(e,t){return t=bn(t,r,!0),e===ln.fromDer(t).value[1].value}}:"NONE"!==n&&"NULL"!==n&&null!==n||(n={verify:function(e,t){return e===bn(t,r,!0)}});var a=hn.rsa.decrypt(t,r,!0,!1);return n.verify(e,a,r.n.bitLength())}};return r},hn.setRsaPrivateKey=hn.rsa.setPrivateKey=function(e,t,r,n,a,i,s,o){var u={n:e,e:t,d:r,p:n,q:a,dP:i,dQ:s,qInv:o,decrypt:function(e,t,r){"string"==typeof t?t=t.toUpperCase():void 0===t&&(t="RSAES-PKCS1-V1_5");var n=hn.rsa.decrypt(e,u,!1,!1);if("RSAES-PKCS1-V1_5"===t)t={decode:bn};else if("RSA-OAEP"===t||"RSAES-OAEP"===t)t={decode:function(e,t){return c.pkcs1.decode_rsa_oaep(t,e,r)}};else{if(-1===["RAW","NONE","NULL",null].indexOf(t))throw new Error('Unsupported encryption scheme: "'+t+'".');t={decode:function(e){return e}}}return t.decode(n,u,!1)},sign:function(e,t){var r=!1;"string"==typeof t&&(t=t.toUpperCase()),void 0===t||"RSASSA-PKCS1-V1_5"===t?(t={encode:vn},r=1):"NONE"!==t&&"NULL"!==t&&null!==t||(t={encode:function(){return e}},r=1);var n=t.encode(e,u.n.bitLength());return hn.rsa.encrypt(n,u,r)}};return u},hn.wrapRsaPrivateKey=function(e){return ln.create(ln.Class.UNIVERSAL,ln.Type.SEQUENCE,!0,[ln.create(ln.Class.UNIVERSAL,ln.Type.INTEGER,!1,ln.integerToDer(0).getBytes()),ln.create(ln.Class.UNIVERSAL,ln.Type.SEQUENCE,!0,[ln.create(ln.Class.UNIVERSAL,ln.Type.OID,!1,ln.oidToDer(hn.oids.rsaEncryption).getBytes()),ln.create(ln.Class.UNIVERSAL,ln.Type.NULL,!1,"")]),ln.create(ln.Class.UNIVERSAL,ln.Type.OCTETSTRING,!1,ln.toDer(e).getBytes())])},hn.privateKeyFromAsn1=function(e){var t,r,n,a,i,s,o,u,l={},f=[];if(ln.validate(e,dn,l,f)&&(e=ln.fromDer(c.util.createBuffer(l.privateKey))),l={},f=[],!ln.validate(e,yn,l,f)){var h=new Error("Cannot read private key. ASN.1 object does not contain an RSAPrivateKey.");throw h.errors=f,h}return t=c.util.createBuffer(l.privateKeyModulus).toHex(),r=c.util.createBuffer(l.privateKeyPublicExponent).toHex(),n=c.util.createBuffer(l.privateKeyPrivateExponent).toHex(),a=c.util.createBuffer(l.privateKeyPrime1).toHex(),i=c.util.createBuffer(l.privateKeyPrime2).toHex(),s=c.util.createBuffer(l.privateKeyExponent1).toHex(),o=c.util.createBuffer(l.privateKeyExponent2).toHex(),u=c.util.createBuffer(l.privateKeyCoefficient).toHex(),hn.setRsaPrivateKey(new un(t,16),new un(r,16),new un(n,16),new un(a,16),new un(i,16),new un(s,16),new un(o,16),new un(u,16))},hn.privateKeyToAsn1=hn.privateKeyToRSAPrivateKey=function(e){return ln.create(ln.Class.UNIVERSAL,ln.Type.SEQUENCE,!0,[ln.create(ln.Class.UNIVERSAL,ln.Type.INTEGER,!1,ln.integerToDer(0).getBytes()),ln.create(ln.Class.UNIVERSAL,ln.Type.INTEGER,!1,Sn(e.n)),ln.create(ln.Class.UNIVERSAL,ln.Type.INTEGER,!1,Sn(e.e)),ln.create(ln.Class.UNIVERSAL,ln.Type.INTEGER,!1,Sn(e.d)),ln.create(ln.Class.UNIVERSAL,ln.Type.INTEGER,!1,Sn(e.p)),ln.create(ln.Class.UNIVERSAL,ln.Type.INTEGER,!1,Sn(e.q)),ln.create(ln.Class.UNIVERSAL,ln.Type.INTEGER,!1,Sn(e.dP)),ln.create(ln.Class.UNIVERSAL,ln.Type.INTEGER,!1,Sn(e.dQ)),ln.create(ln.Class.UNIVERSAL,ln.Type.INTEGER,!1,Sn(e.qInv))])},hn.publicKeyFromAsn1=function(e){var t={},r=[];if(ln.validate(e,mn,t,r)){var n,a=ln.derToOid(t.publicKeyOid);if(a!==hn.oids.rsaEncryption)throw(n=new Error("Cannot read public key. Unknown OID.")).oid=a,n;e=t.rsaPublicKey}if(r=[],!ln.validate(e,gn,t,r))throw(n=new Error("Cannot read public key. ASN.1 object does not contain an RSAPublicKey.")).errors=r,n;var i=c.util.createBuffer(t.publicKeyModulus).toHex(),s=c.util.createBuffer(t.publicKeyExponent).toHex();return hn.setRsaPublicKey(new un(i,16),new un(s,16))},hn.publicKeyToAsn1=hn.publicKeyToSubjectPublicKeyInfo=function(e){return ln.create(ln.Class.UNIVERSAL,ln.Type.SEQUENCE,!0,[ln.create(ln.Class.UNIVERSAL,ln.Type.SEQUENCE,!0,[ln.create(ln.Class.UNIVERSAL,ln.Type.OID,!1,ln.oidToDer(hn.oids.rsaEncryption).getBytes()),ln.create(ln.Class.UNIVERSAL,ln.Type.NULL,!1,"")]),ln.create(ln.Class.UNIVERSAL,ln.Type.BITSTRING,!1,[hn.publicKeyToRSAPublicKey(e)])])},hn.publicKeyToRSAPublicKey=function(e){return ln.create(ln.Class.UNIVERSAL,ln.Type.SEQUENCE,!0,[ln.create(ln.Class.UNIVERSAL,ln.Type.INTEGER,!1,Sn(e.n)),ln.create(ln.Class.UNIVERSAL,ln.Type.INTEGER,!1,Sn(e.e))])},void 0===Nn)var Nn=c.jsbn.BigInteger;var kn=c.asn1,Rn=c.pki=c.pki||{},Un=(Rn.pbe=c.pbe=c.pbe||{},Rn.oids),Ln={name:"EncryptedPrivateKeyInfo",tagClass:kn.Class.UNIVERSAL,type:kn.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedPrivateKeyInfo.encryptionAlgorithm",tagClass:kn.Class.UNIVERSAL,type:kn.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:kn.Class.UNIVERSAL,type:kn.Type.OID,constructed:!1,capture:"encryptionOid"},{name:"AlgorithmIdentifier.parameters",tagClass:kn.Class.UNIVERSAL,type:kn.Type.SEQUENCE,constructed:!0,captureAsn1:"encryptionParams"}]},{name:"EncryptedPrivateKeyInfo.encryptedData",tagClass:kn.Class.UNIVERSAL,type:kn.Type.OCTETSTRING,constructed:!1,capture:"encryptedData"}]},_n={name:"PBES2Algorithms",tagClass:kn.Class.UNIVERSAL,type:kn.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc",tagClass:kn.Class.UNIVERSAL,type:kn.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc.oid",tagClass:kn.Class.UNIVERSAL,type:kn.Type.OID,constructed:!1,capture:"kdfOid"},{name:"PBES2Algorithms.params",tagClass:kn.Class.UNIVERSAL,type:kn.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.params.salt",tagClass:kn.Class.UNIVERSAL,type:kn.Type.OCTETSTRING,constructed:!1,capture:"kdfSalt"},{name:"PBES2Algorithms.params.iterationCount",tagClass:kn.Class.UNIVERSAL,type:kn.Type.INTEGER,constructed:!1,capture:"kdfIterationCount"},{name:"PBES2Algorithms.params.keyLength",tagClass:kn.Class.UNIVERSAL,type:kn.Type.INTEGER,constructed:!1,optional:!0,capture:"keyLength"},{name:"PBES2Algorithms.params.prf",tagClass:kn.Class.UNIVERSAL,type:kn.Type.SEQUENCE,constructed:!0,optional:!0,value:[{name:"PBES2Algorithms.params.prf.algorithm",tagClass:kn.Class.UNIVERSAL,type:kn.Type.OID,constructed:!1,capture:"prfOid"}]}]}]},{name:"PBES2Algorithms.encryptionScheme",tagClass:kn.Class.UNIVERSAL,type:kn.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.encryptionScheme.oid",tagClass:kn.Class.UNIVERSAL,type:kn.Type.OID,constructed:!1,capture:"encOid"},{name:"PBES2Algorithms.encryptionScheme.iv",tagClass:kn.Class.UNIVERSAL,type:kn.Type.OCTETSTRING,constructed:!1,capture:"encIv"}]}]},Pn={name:"pkcs-12PbeParams",tagClass:kn.Class.UNIVERSAL,type:kn.Type.SEQUENCE,constructed:!0,value:[{name:"pkcs-12PbeParams.salt",tagClass:kn.Class.UNIVERSAL,type:kn.Type.OCTETSTRING,constructed:!1,capture:"salt"},{name:"pkcs-12PbeParams.iterations",tagClass:kn.Class.UNIVERSAL,type:kn.Type.INTEGER,constructed:!1,capture:"iterations"}]};function Dn(e,t){return e.start().update(t).digest().getBytes()}function On(e){var t;if(e){if(!(t=Rn.oids[kn.derToOid(e)])){var r=new Error("Unsupported PRF OID.");throw r.oid=e,r.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],r}}else t="hmacWithSHA1";return Vn(t)}function Vn(e){var t=c.md;switch(e){case"hmacWithSHA224":t=c.md.sha512;case"hmacWithSHA1":case"hmacWithSHA256":case"hmacWithSHA384":case"hmacWithSHA512":e=e.substr(8).toLowerCase();break;default:var r=new Error("Unsupported PRF algorithm.");throw r.algorithm=e,r.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],r}if(!(t&&e in t))throw new Error("Unknown hash algorithm: "+e);return t[e].create()}Rn.encryptPrivateKeyInfo=function(e,t,r){(r=r||{}).saltSize=r.saltSize||8,r.count=r.count||2048,r.algorithm=r.algorithm||"aes128",r.prfAlgorithm=r.prfAlgorithm||"sha1";var n,a,i,s=c.random.getBytesSync(r.saltSize),o=r.count,u=kn.integerToDer(o);if(0===r.algorithm.indexOf("aes")||"des"===r.algorithm){var l,f,h;switch(r.algorithm){case"aes128":n=16,l=16,f=Un["aes128-CBC"],h=c.aes.createEncryptionCipher;break;case"aes192":n=24,l=16,f=Un["aes192-CBC"],h=c.aes.createEncryptionCipher;break;case"aes256":n=32,l=16,f=Un["aes256-CBC"],h=c.aes.createEncryptionCipher;break;case"des":n=8,l=8,f=Un.desCBC,h=c.des.createEncryptionCipher;break;default:throw(v=new Error("Cannot encrypt private key. Unknown encryption algorithm.")).algorithm=r.algorithm,v}var p="hmacWith"+r.prfAlgorithm.toUpperCase(),d=Vn(p),y=c.pkcs5.pbkdf2(t,s,o,n,d),g=c.random.getBytesSync(l);(E=h(y)).start(g),E.update(kn.toDer(e)),E.finish(),i=E.output.getBytes();var m=function(e,t,r,n){var a=kn.create(kn.Class.UNIVERSAL,kn.Type.SEQUENCE,!0,[kn.create(kn.Class.UNIVERSAL,kn.Type.OCTETSTRING,!1,e),kn.create(kn.Class.UNIVERSAL,kn.Type.INTEGER,!1,t.getBytes())]);return"hmacWithSHA1"!==n&&a.value.push(kn.create(kn.Class.UNIVERSAL,kn.Type.INTEGER,!1,c.util.hexToBytes(r.toString(16))),kn.create(kn.Class.UNIVERSAL,kn.Type.SEQUENCE,!0,[kn.create(kn.Class.UNIVERSAL,kn.Type.OID,!1,kn.oidToDer(Rn.oids[n]).getBytes()),kn.create(kn.Class.UNIVERSAL,kn.Type.NULL,!1,"")])),a}(s,u,n,p);a=kn.create(kn.Class.UNIVERSAL,kn.Type.SEQUENCE,!0,[kn.create(kn.Class.UNIVERSAL,kn.Type.OID,!1,kn.oidToDer(Un.pkcs5PBES2).getBytes()),kn.create(kn.Class.UNIVERSAL,kn.Type.SEQUENCE,!0,[kn.create(kn.Class.UNIVERSAL,kn.Type.SEQUENCE,!0,[kn.create(kn.Class.UNIVERSAL,kn.Type.OID,!1,kn.oidToDer(Un.pkcs5PBKDF2).getBytes()),m]),kn.create(kn.Class.UNIVERSAL,kn.Type.SEQUENCE,!0,[kn.create(kn.Class.UNIVERSAL,kn.Type.OID,!1,kn.oidToDer(f).getBytes()),kn.create(kn.Class.UNIVERSAL,kn.Type.OCTETSTRING,!1,g)])])])}else{var v;if("3des"!==r.algorithm)throw(v=new Error("Cannot encrypt private key. Unknown encryption algorithm.")).algorithm=r.algorithm,v;n=24;var E,C=new c.util.ByteBuffer(s);y=Rn.pbe.generatePkcs12Key(t,C,1,o,n),g=Rn.pbe.generatePkcs12Key(t,C,2,o,n),(E=c.des.createEncryptionCipher(y)).start(g),E.update(kn.toDer(e)),E.finish(),i=E.output.getBytes(),a=kn.create(kn.Class.UNIVERSAL,kn.Type.SEQUENCE,!0,[kn.create(kn.Class.UNIVERSAL,kn.Type.OID,!1,kn.oidToDer(Un["pbeWithSHAAnd3-KeyTripleDES-CBC"]).getBytes()),kn.create(kn.Class.UNIVERSAL,kn.Type.SEQUENCE,!0,[kn.create(kn.Class.UNIVERSAL,kn.Type.OCTETSTRING,!1,s),kn.create(kn.Class.UNIVERSAL,kn.Type.INTEGER,!1,u.getBytes())])])}return kn.create(kn.Class.UNIVERSAL,kn.Type.SEQUENCE,!0,[a,kn.create(kn.Class.UNIVERSAL,kn.Type.OCTETSTRING,!1,i)])},Rn.decryptPrivateKeyInfo=function(e,t){var r=null,n={},a=[];if(!kn.validate(e,Ln,n,a)){var i=new Error("Cannot read encrypted private key. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw i.errors=a,i}var s=kn.derToOid(n.encryptionOid),o=Rn.pbe.getCipher(s,n.encryptionParams,t),u=c.util.createBuffer(n.encryptedData);return o.update(u),o.finish()&&(r=kn.fromDer(o.output)),r},Rn.encryptedPrivateKeyToPem=function(e,t){var r={type:"ENCRYPTED PRIVATE KEY",body:kn.toDer(e).getBytes()};return c.pem.encode(r,{maxline:t})},Rn.encryptedPrivateKeyFromPem=function(e){var t=c.pem.decode(e)[0];if("ENCRYPTED PRIVATE KEY"!==t.type){var r=new Error('Could not convert encrypted private key from PEM; PEM header type is "ENCRYPTED PRIVATE KEY".');throw r.headerType=t.type,r}if(t.procType&&"ENCRYPTED"===t.procType.type)throw new Error("Could not convert encrypted private key from PEM; PEM is encrypted.");return kn.fromDer(t.body)},Rn.encryptRsaPrivateKey=function(e,t,r){if(!(r=r||{}).legacy){var n=Rn.wrapRsaPrivateKey(Rn.privateKeyToAsn1(e));return n=Rn.encryptPrivateKeyInfo(n,t,r),Rn.encryptedPrivateKeyToPem(n)}var a,i,s,o;switch(r.algorithm){case"aes128":a="AES-128-CBC",s=16,i=c.random.getBytesSync(16),o=c.aes.createEncryptionCipher;break;case"aes192":a="AES-192-CBC",s=24,i=c.random.getBytesSync(16),o=c.aes.createEncryptionCipher;break;case"aes256":a="AES-256-CBC",s=32,i=c.random.getBytesSync(16),o=c.aes.createEncryptionCipher;break;case"3des":a="DES-EDE3-CBC",s=24,i=c.random.getBytesSync(8),o=c.des.createEncryptionCipher;break;case"des":a="DES-CBC",s=8,i=c.random.getBytesSync(8),o=c.des.createEncryptionCipher;break;default:var u=new Error('Could not encrypt RSA private key; unsupported encryption algorithm "'+r.algorithm+'".');throw u.algorithm=r.algorithm,u}var l=o(c.pbe.opensslDeriveBytes(t,i.substr(0,8),s));l.start(i),l.update(kn.toDer(Rn.privateKeyToAsn1(e))),l.finish();var f={type:"RSA PRIVATE KEY",procType:{version:"4",type:"ENCRYPTED"},dekInfo:{algorithm:a,parameters:c.util.bytesToHex(i).toUpperCase()},body:l.output.getBytes()};return c.pem.encode(f)},Rn.decryptRsaPrivateKey=function(e,t){var r=null,n=c.pem.decode(e)[0];if("ENCRYPTED PRIVATE KEY"!==n.type&&"PRIVATE KEY"!==n.type&&"RSA PRIVATE KEY"!==n.type)throw(s=new Error('Could not convert private key from PEM; PEM header type is not "ENCRYPTED PRIVATE KEY", "PRIVATE KEY", or "RSA PRIVATE KEY".')).headerType=s,s;if(n.procType&&"ENCRYPTED"===n.procType.type){var a,i;switch(n.dekInfo.algorithm){case"DES-CBC":a=8,i=c.des.createDecryptionCipher;break;case"DES-EDE3-CBC":a=24,i=c.des.createDecryptionCipher;break;case"AES-128-CBC":a=16,i=c.aes.createDecryptionCipher;break;case"AES-192-CBC":a=24,i=c.aes.createDecryptionCipher;break;case"AES-256-CBC":a=32,i=c.aes.createDecryptionCipher;break;case"RC2-40-CBC":a=5,i=function(e){return c.rc2.createDecryptionCipher(e,40)};break;case"RC2-64-CBC":a=8,i=function(e){return c.rc2.createDecryptionCipher(e,64)};break;case"RC2-128-CBC":a=16,i=function(e){return c.rc2.createDecryptionCipher(e,128)};break;default:var s;throw(s=new Error('Could not decrypt private key; unsupported encryption algorithm "'+n.dekInfo.algorithm+'".')).algorithm=n.dekInfo.algorithm,s}var o=c.util.hexToBytes(n.dekInfo.parameters),u=i(c.pbe.opensslDeriveBytes(t,o.substr(0,8),a));if(u.start(o),u.update(c.util.createBuffer(n.body)),!u.finish())return r;r=u.output.getBytes()}else r=n.body;return null!==(r="ENCRYPTED PRIVATE KEY"===n.type?Rn.decryptPrivateKeyInfo(kn.fromDer(r),t):kn.fromDer(r))&&(r=Rn.privateKeyFromAsn1(r)),r},Rn.pbe.generatePkcs12Key=function(e,t,r,n,a,i){var s,o;if(null==i){if(!("sha1"in c.md))throw new Error('"sha1" hash algorithm unavailable.');i=c.md.sha1.create()}var u=i.digestLength,l=i.blockLength,f=new c.util.ByteBuffer,h=new c.util.ByteBuffer;if(null!=e){for(o=0;o<e.length;o++)h.putInt16(e.charCodeAt(o));h.putInt16(0)}var p=h.length(),d=t.length(),y=new c.util.ByteBuffer;y.fillWithByte(r,l);var g=l*Math.ceil(d/l),m=new c.util.ByteBuffer;for(o=0;o<g;o++)m.putByte(t.at(o%d));var v=l*Math.ceil(p/l),E=new c.util.ByteBuffer;for(o=0;o<v;o++)E.putByte(h.at(o%p));var C=m;C.putBuffer(E);for(var b=Math.ceil(a/u),S=1;S<=b;S++){var T=new c.util.ByteBuffer;T.putBytes(y.bytes()),T.putBytes(C.bytes());for(var I=0;I<n;I++)i.start(),i.update(T.getBytes()),T=i.digest();var A=new c.util.ByteBuffer;for(o=0;o<l;o++)A.putByte(T.at(o%u));var w=Math.ceil(d/l)+Math.ceil(p/l),B=new c.util.ByteBuffer;for(s=0;s<w;s++){var N=new c.util.ByteBuffer(C.getBytes(l)),k=511;for(o=A.length()-1;o>=0;o--)k>>=8,k+=A.at(o)+N.at(o),N.setAt(o,255&k);B.putBuffer(N)}C=B,f.putBuffer(T)}return f.truncate(f.length()-a),f},Rn.pbe.getCipher=function(e,t,r){switch(e){case Rn.oids.pkcs5PBES2:return Rn.pbe.getCipherForPBES2(e,t,r);case Rn.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:case Rn.oids["pbewithSHAAnd40BitRC2-CBC"]:return Rn.pbe.getCipherForPKCS12PBE(e,t,r);default:var n=new Error("Cannot read encrypted PBE data block. Unsupported OID.");throw n.oid=e,n.supportedOids=["pkcs5PBES2","pbeWithSHAAnd3-KeyTripleDES-CBC","pbewithSHAAnd40BitRC2-CBC"],n}},Rn.pbe.getCipherForPBES2=function(e,t,r){var n,a={},i=[];if(!kn.validate(t,_n,a,i))throw(n=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.")).errors=i,n;if((e=kn.derToOid(a.kdfOid))!==Rn.oids.pkcs5PBKDF2)throw(n=new Error("Cannot read encrypted private key. Unsupported key derivation function OID.")).oid=e,n.supportedOids=["pkcs5PBKDF2"],n;if((e=kn.derToOid(a.encOid))!==Rn.oids["aes128-CBC"]&&e!==Rn.oids["aes192-CBC"]&&e!==Rn.oids["aes256-CBC"]&&e!==Rn.oids["des-EDE3-CBC"]&&e!==Rn.oids.desCBC)throw(n=new Error("Cannot read encrypted private key. Unsupported encryption scheme OID.")).oid=e,n.supportedOids=["aes128-CBC","aes192-CBC","aes256-CBC","des-EDE3-CBC","desCBC"],n;var s,o,u=a.kdfSalt,l=c.util.createBuffer(a.kdfIterationCount);switch(l=l.getInt(l.length()<<3),Rn.oids[e]){case"aes128-CBC":s=16,o=c.aes.createDecryptionCipher;break;case"aes192-CBC":s=24,o=c.aes.createDecryptionCipher;break;case"aes256-CBC":s=32,o=c.aes.createDecryptionCipher;break;case"des-EDE3-CBC":s=24,o=c.des.createDecryptionCipher;break;case"desCBC":s=8,o=c.des.createDecryptionCipher}var f=On(a.prfOid),h=c.pkcs5.pbkdf2(r,u,l,s,f),p=a.encIv,d=o(h);return d.start(p),d},Rn.pbe.getCipherForPKCS12PBE=function(e,t,r){var n={},a=[];if(!kn.validate(t,Pn,n,a))throw(f=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.")).errors=a,f;var i,s,o,u=c.util.createBuffer(n.salt),l=c.util.createBuffer(n.iterations);switch(l=l.getInt(l.length()<<3),e){case Rn.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:i=24,s=8,o=c.des.startDecrypting;break;case Rn.oids["pbewithSHAAnd40BitRC2-CBC"]:i=5,s=8,o=function(e,t){var r=c.rc2.createDecryptionCipher(e,40);return r.start(t,null),r};break;default:var f;throw(f=new Error("Cannot read PKCS #12 PBE data block. Unsupported OID.")).oid=e,f}var h=On(n.prfOid),p=Rn.pbe.generatePkcs12Key(r,u,1,l,i,h);return h.start(),o(p,Rn.pbe.generatePkcs12Key(r,u,2,l,s,h))},Rn.pbe.opensslDeriveBytes=function(e,t,r,n){if(null==n){if(!("md5"in c.md))throw new Error('"md5" hash algorithm unavailable.');n=c.md.md5.create()}null===t&&(t="");for(var a=[Dn(n,e+t)],i=16,s=1;i<r;++s,i+=16)a.push(Dn(n,a[s-1]+e+t));return a.join("").substr(0,r)};var Kn=c.asn1,xn=c.pkcs7asn1=c.pkcs7asn1||{};c.pkcs7=c.pkcs7||{},c.pkcs7.asn1=xn;var Mn={name:"ContentInfo",tagClass:Kn.Class.UNIVERSAL,type:Kn.Type.SEQUENCE,constructed:!0,value:[{name:"ContentInfo.ContentType",tagClass:Kn.Class.UNIVERSAL,type:Kn.Type.OID,constructed:!1,capture:"contentType"},{name:"ContentInfo.content",tagClass:Kn.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,captureAsn1:"content"}]};xn.contentInfoValidator=Mn;var jn={name:"EncryptedContentInfo",tagClass:Kn.Class.UNIVERSAL,type:Kn.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedContentInfo.contentType",tagClass:Kn.Class.UNIVERSAL,type:Kn.Type.OID,constructed:!1,capture:"contentType"},{name:"EncryptedContentInfo.contentEncryptionAlgorithm",tagClass:Kn.Class.UNIVERSAL,type:Kn.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedContentInfo.contentEncryptionAlgorithm.algorithm",tagClass:Kn.Class.UNIVERSAL,type:Kn.Type.OID,constructed:!1,capture:"encAlgorithm"},{name:"EncryptedContentInfo.contentEncryptionAlgorithm.parameter",tagClass:Kn.Class.UNIVERSAL,captureAsn1:"encParameter"}]},{name:"EncryptedContentInfo.encryptedContent",tagClass:Kn.Class.CONTEXT_SPECIFIC,type:0,capture:"encryptedContent",captureAsn1:"encryptedContentAsn1"}]};xn.envelopedDataValidator={name:"EnvelopedData",tagClass:Kn.Class.UNIVERSAL,type:Kn.Type.SEQUENCE,constructed:!0,value:[{name:"EnvelopedData.Version",tagClass:Kn.Class.UNIVERSAL,type:Kn.Type.INTEGER,constructed:!1,capture:"version"},{name:"EnvelopedData.RecipientInfos",tagClass:Kn.Class.UNIVERSAL,type:Kn.Type.SET,constructed:!0,captureAsn1:"recipientInfos"}].concat(jn)},xn.encryptedDataValidator={name:"EncryptedData",tagClass:Kn.Class.UNIVERSAL,type:Kn.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedData.Version",tagClass:Kn.Class.UNIVERSAL,type:Kn.Type.INTEGER,constructed:!1,capture:"version"}].concat(jn)};var Fn={name:"SignerInfo",tagClass:Kn.Class.UNIVERSAL,type:Kn.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.version",tagClass:Kn.Class.UNIVERSAL,type:Kn.Type.INTEGER,constructed:!1},{name:"SignerInfo.issuerAndSerialNumber",tagClass:Kn.Class.UNIVERSAL,type:Kn.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.issuerAndSerialNumber.issuer",tagClass:Kn.Class.UNIVERSAL,type:Kn.Type.SEQUENCE,constructed:!0,captureAsn1:"issuer"},{name:"SignerInfo.issuerAndSerialNumber.serialNumber",tagClass:Kn.Class.UNIVERSAL,type:Kn.Type.INTEGER,constructed:!1,capture:"serial"}]},{name:"SignerInfo.digestAlgorithm",tagClass:Kn.Class.UNIVERSAL,type:Kn.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.digestAlgorithm.algorithm",tagClass:Kn.Class.UNIVERSAL,type:Kn.Type.OID,constructed:!1,capture:"digestAlgorithm"},{name:"SignerInfo.digestAlgorithm.parameter",tagClass:Kn.Class.UNIVERSAL,constructed:!1,captureAsn1:"digestParameter",optional:!0}]},{name:"SignerInfo.authenticatedAttributes",tagClass:Kn.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,capture:"authenticatedAttributes"},{name:"SignerInfo.digestEncryptionAlgorithm",tagClass:Kn.Class.UNIVERSAL,type:Kn.Type.SEQUENCE,constructed:!0,capture:"signatureAlgorithm"},{name:"SignerInfo.encryptedDigest",tagClass:Kn.Class.UNIVERSAL,type:Kn.Type.OCTETSTRING,constructed:!1,capture:"signature"},{name:"SignerInfo.unauthenticatedAttributes",tagClass:Kn.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,optional:!0,capture:"unauthenticatedAttributes"}]};xn.signedDataValidator={name:"SignedData",tagClass:Kn.Class.UNIVERSAL,type:Kn.Type.SEQUENCE,constructed:!0,value:[{name:"SignedData.Version",tagClass:Kn.Class.UNIVERSAL,type:Kn.Type.INTEGER,constructed:!1,capture:"version"},{name:"SignedData.DigestAlgorithms",tagClass:Kn.Class.UNIVERSAL,type:Kn.Type.SET,constructed:!0,captureAsn1:"digestAlgorithms"},Mn,{name:"SignedData.Certificates",tagClass:Kn.Class.CONTEXT_SPECIFIC,type:0,optional:!0,captureAsn1:"certificates"},{name:"SignedData.CertificateRevocationLists",tagClass:Kn.Class.CONTEXT_SPECIFIC,type:1,optional:!0,captureAsn1:"crls"},{name:"SignedData.SignerInfos",tagClass:Kn.Class.UNIVERSAL,type:Kn.Type.SET,capture:"signerInfos",optional:!0,value:[Fn]}]},xn.recipientInfoValidator={name:"RecipientInfo",tagClass:Kn.Class.UNIVERSAL,type:Kn.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.version",tagClass:Kn.Class.UNIVERSAL,type:Kn.Type.INTEGER,constructed:!1,capture:"version"},{name:"RecipientInfo.issuerAndSerial",tagClass:Kn.Class.UNIVERSAL,type:Kn.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.issuerAndSerial.issuer",tagClass:Kn.Class.UNIVERSAL,type:Kn.Type.SEQUENCE,constructed:!0,captureAsn1:"issuer"},{name:"RecipientInfo.issuerAndSerial.serialNumber",tagClass:Kn.Class.UNIVERSAL,type:Kn.Type.INTEGER,constructed:!1,capture:"serial"}]},{name:"RecipientInfo.keyEncryptionAlgorithm",tagClass:Kn.Class.UNIVERSAL,type:Kn.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.keyEncryptionAlgorithm.algorithm",tagClass:Kn.Class.UNIVERSAL,type:Kn.Type.OID,constructed:!1,capture:"encAlgorithm"},{name:"RecipientInfo.keyEncryptionAlgorithm.parameter",tagClass:Kn.Class.UNIVERSAL,constructed:!1,captureAsn1:"encParameter"}]},{name:"RecipientInfo.encryptedKey",tagClass:Kn.Class.UNIVERSAL,type:Kn.Type.OCTETSTRING,constructed:!1,capture:"encKey"}]};c.mgf=c.mgf||{},(c.mgf.mgf1=c.mgf1=c.mgf1||{}).create=function(e){return{generate:function(t,r){for(var n=new c.util.ByteBuffer,a=Math.ceil(r/e.digestLength),i=0;i<a;i++){var s=new c.util.ByteBuffer;s.putInt32(i),e.start(),e.update(t+s.getBytes()),n.putBuffer(e.digest())}return n.truncate(n.length()-r),n.getBytes()}}};c.mgf=c.mgf||{},c.mgf.mgf1=c.mgf1;(c.pss=c.pss||{}).create=function(e){3===arguments.length&&(e={md:arguments[0],mgf:arguments[1],saltLength:arguments[2]});var t,r=e.md,n=e.mgf,a=r.digestLength,i=e.salt||null;if("string"==typeof i&&(i=c.util.createBuffer(i)),"saltLength"in e)t=e.saltLength;else{if(null===i)throw new Error("Salt length not specified or specific salt not given.");t=i.length()}if(null!==i&&i.length()!==t)throw new Error("Given salt length does not match length of given salt.");var s=e.prng||c.random;return{encode:function(e,o){var u,l,f=o-1,h=Math.ceil(f/8),p=e.digest().getBytes();if(h<a+t+2)throw new Error("Message is too long to encrypt.");l=null===i?s.getBytesSync(t):i.bytes();var d=new c.util.ByteBuffer;d.fillWithByte(0,8),d.putBytes(p),d.putBytes(l),r.start(),r.update(d.getBytes());var y=r.digest().getBytes(),g=new c.util.ByteBuffer;g.fillWithByte(0,h-t-a-2),g.putByte(1),g.putBytes(l);var m=g.getBytes(),v=h-a-1,E=n.generate(y,v),C="";for(u=0;u<v;u++)C+=String.fromCharCode(m.charCodeAt(u)^E.charCodeAt(u));var b=65280>>8*h-f&255;return(C=String.fromCharCode(C.charCodeAt(0)&~b)+C.substr(1))+y+String.fromCharCode(188)},verify:function(e,i,s){var o,u=s-1,l=Math.ceil(u/8);if(i=i.substr(-l),l<a+t+2)throw new Error("Inconsistent parameters to PSS signature verification.");if(188!==i.charCodeAt(l-1))throw new Error("Encoded message does not end in 0xBC.");var f=l-a-1,h=i.substr(0,f),p=i.substr(f,a),d=65280>>8*l-u&255;if(0!=(h.charCodeAt(0)&d))throw new Error("Bits beyond keysize not zero as expected.");var y=n.generate(p,f),g="";for(o=0;o<f;o++)g+=String.fromCharCode(h.charCodeAt(o)^y.charCodeAt(o));g=String.fromCharCode(g.charCodeAt(0)&~d)+g.substr(1);var m=l-a-t-2;for(o=0;o<m;o++)if(0!==g.charCodeAt(o))throw new Error("Leftmost octets not zero as expected");if(1!==g.charCodeAt(m))throw new Error("Inconsistent PSS signature, 0x01 marker not found");var v=g.substr(-t),E=new c.util.ByteBuffer;return E.fillWithByte(0,8),E.putBytes(e),E.putBytes(v),r.start(),r.update(E.getBytes()),p===r.digest().getBytes()}}};var zn=c.asn1,qn=c.pki=c.pki||{},Gn=qn.oids,Qn={};Qn.CN=Gn.commonName,Qn.commonName="CN",Qn.C=Gn.countryName,Qn.countryName="C",Qn.L=Gn.localityName,Qn.localityName="L",Qn.ST=Gn.stateOrProvinceName,Qn.stateOrProvinceName="ST",Qn.O=Gn.organizationName,Qn.organizationName="O",Qn.OU=Gn.organizationalUnitName,Qn.organizationalUnitName="OU",Qn.E=Gn.emailAddress,Qn.emailAddress="E";var Hn=c.pki.rsa.publicKeyValidator,Wn={name:"Certificate",tagClass:zn.Class.UNIVERSAL,type:zn.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate",tagClass:zn.Class.UNIVERSAL,type:zn.Type.SEQUENCE,constructed:!0,captureAsn1:"tbsCertificate",value:[{name:"Certificate.TBSCertificate.version",tagClass:zn.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.version.integer",tagClass:zn.Class.UNIVERSAL,type:zn.Type.INTEGER,constructed:!1,capture:"certVersion"}]},{name:"Certificate.TBSCertificate.serialNumber",tagClass:zn.Class.UNIVERSAL,type:zn.Type.INTEGER,constructed:!1,capture:"certSerialNumber"},{name:"Certificate.TBSCertificate.signature",tagClass:zn.Class.UNIVERSAL,type:zn.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate.signature.algorithm",tagClass:zn.Class.UNIVERSAL,type:zn.Type.OID,constructed:!1,capture:"certinfoSignatureOid"},{name:"Certificate.TBSCertificate.signature.parameters",tagClass:zn.Class.UNIVERSAL,optional:!0,captureAsn1:"certinfoSignatureParams"}]},{name:"Certificate.TBSCertificate.issuer",tagClass:zn.Class.UNIVERSAL,type:zn.Type.SEQUENCE,constructed:!0,captureAsn1:"certIssuer"},{name:"Certificate.TBSCertificate.validity",tagClass:zn.Class.UNIVERSAL,type:zn.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate.validity.notBefore (utc)",tagClass:zn.Class.UNIVERSAL,type:zn.Type.UTCTIME,constructed:!1,optional:!0,capture:"certValidity1UTCTime"},{name:"Certificate.TBSCertificate.validity.notBefore (generalized)",tagClass:zn.Class.UNIVERSAL,type:zn.Type.GENERALIZEDTIME,constructed:!1,optional:!0,capture:"certValidity2GeneralizedTime"},{name:"Certificate.TBSCertificate.validity.notAfter (utc)",tagClass:zn.Class.UNIVERSAL,type:zn.Type.UTCTIME,constructed:!1,optional:!0,capture:"certValidity3UTCTime"},{name:"Certificate.TBSCertificate.validity.notAfter (generalized)",tagClass:zn.Class.UNIVERSAL,type:zn.Type.GENERALIZEDTIME,constructed:!1,optional:!0,capture:"certValidity4GeneralizedTime"}]},{name:"Certificate.TBSCertificate.subject",tagClass:zn.Class.UNIVERSAL,type:zn.Type.SEQUENCE,constructed:!0,captureAsn1:"certSubject"},Hn,{name:"Certificate.TBSCertificate.issuerUniqueID",tagClass:zn.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.issuerUniqueID.id",tagClass:zn.Class.UNIVERSAL,type:zn.Type.BITSTRING,constructed:!1,captureBitStringValue:"certIssuerUniqueId"}]},{name:"Certificate.TBSCertificate.subjectUniqueID",tagClass:zn.Class.CONTEXT_SPECIFIC,type:2,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.subjectUniqueID.id",tagClass:zn.Class.UNIVERSAL,type:zn.Type.BITSTRING,constructed:!1,captureBitStringValue:"certSubjectUniqueId"}]},{name:"Certificate.TBSCertificate.extensions",tagClass:zn.Class.CONTEXT_SPECIFIC,type:3,constructed:!0,captureAsn1:"certExtensions",optional:!0}]},{name:"Certificate.signatureAlgorithm",tagClass:zn.Class.UNIVERSAL,type:zn.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.signatureAlgorithm.algorithm",tagClass:zn.Class.UNIVERSAL,type:zn.Type.OID,constructed:!1,capture:"certSignatureOid"},{name:"Certificate.TBSCertificate.signature.parameters",tagClass:zn.Class.UNIVERSAL,optional:!0,captureAsn1:"certSignatureParams"}]},{name:"Certificate.signatureValue",tagClass:zn.Class.UNIVERSAL,type:zn.Type.BITSTRING,constructed:!1,captureBitStringValue:"certSignature"}]},Xn={name:"rsapss",tagClass:zn.Class.UNIVERSAL,type:zn.Type.SEQUENCE,constructed:!0,value:[{name:"rsapss.hashAlgorithm",tagClass:zn.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,value:[{name:"rsapss.hashAlgorithm.AlgorithmIdentifier",tagClass:zn.Class.UNIVERSAL,type:zn.Class.SEQUENCE,constructed:!0,optional:!0,value:[{name:"rsapss.hashAlgorithm.AlgorithmIdentifier.algorithm",tagClass:zn.Class.UNIVERSAL,type:zn.Type.OID,constructed:!1,capture:"hashOid"}]}]},{name:"rsapss.maskGenAlgorithm",tagClass:zn.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier",tagClass:zn.Class.UNIVERSAL,type:zn.Class.SEQUENCE,constructed:!0,optional:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.algorithm",tagClass:zn.Class.UNIVERSAL,type:zn.Type.OID,constructed:!1,capture:"maskGenOid"},{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.params",tagClass:zn.Class.UNIVERSAL,type:zn.Type.SEQUENCE,constructed:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.params.algorithm",tagClass:zn.Class.UNIVERSAL,type:zn.Type.OID,constructed:!1,capture:"maskGenHashOid"}]}]}]},{name:"rsapss.saltLength",tagClass:zn.Class.CONTEXT_SPECIFIC,type:2,optional:!0,value:[{name:"rsapss.saltLength.saltLength",tagClass:zn.Class.UNIVERSAL,type:zn.Class.INTEGER,constructed:!1,capture:"saltLength"}]},{name:"rsapss.trailerField",tagClass:zn.Class.CONTEXT_SPECIFIC,type:3,optional:!0,value:[{name:"rsapss.trailer.trailer",tagClass:zn.Class.UNIVERSAL,type:zn.Class.INTEGER,constructed:!1,capture:"trailer"}]}]},Yn={name:"CertificationRequestInfo",tagClass:zn.Class.UNIVERSAL,type:zn.Type.SEQUENCE,constructed:!0,captureAsn1:"certificationRequestInfo",value:[{name:"CertificationRequestInfo.integer",tagClass:zn.Class.UNIVERSAL,type:zn.Type.INTEGER,constructed:!1,capture:"certificationRequestInfoVersion"},{name:"CertificationRequestInfo.subject",tagClass:zn.Class.UNIVERSAL,type:zn.Type.SEQUENCE,constructed:!0,captureAsn1:"certificationRequestInfoSubject"},Hn,{name:"CertificationRequestInfo.attributes",tagClass:zn.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,capture:"certificationRequestInfoAttributes",value:[{name:"CertificationRequestInfo.attributes",tagClass:zn.Class.UNIVERSAL,type:zn.Type.SEQUENCE,constructed:!0,value:[{name:"CertificationRequestInfo.attributes.type",tagClass:zn.Class.UNIVERSAL,type:zn.Type.OID,constructed:!1},{name:"CertificationRequestInfo.attributes.value",tagClass:zn.Class.UNIVERSAL,type:zn.Type.SET,constructed:!0}]}]}]},Zn={name:"CertificationRequest",tagClass:zn.Class.UNIVERSAL,type:zn.Type.SEQUENCE,constructed:!0,captureAsn1:"csr",value:[Yn,{name:"CertificationRequest.signatureAlgorithm",tagClass:zn.Class.UNIVERSAL,type:zn.Type.SEQUENCE,constructed:!0,value:[{name:"CertificationRequest.signatureAlgorithm.algorithm",tagClass:zn.Class.UNIVERSAL,type:zn.Type.OID,constructed:!1,capture:"csrSignatureOid"},{name:"CertificationRequest.signatureAlgorithm.parameters",tagClass:zn.Class.UNIVERSAL,optional:!0,captureAsn1:"csrSignatureParams"}]},{name:"CertificationRequest.signature",tagClass:zn.Class.UNIVERSAL,type:zn.Type.BITSTRING,constructed:!1,captureBitStringValue:"csrSignature"}]};function Jn(e,t){"string"==typeof t&&(t={shortName:t});for(var r,n=null,a=0;null===n&&a<e.attributes.length;++a)r=e.attributes[a],t.type&&t.type===r.type?n=r:t.name&&t.name===r.name?n=r:t.shortName&&t.shortName===r.shortName&&(n=r);return n}qn.RDNAttributesAsArray=function(e,t){for(var r,n,a,i=[],s=0;s<e.value.length;++s){r=e.value[s];for(var o=0;o<r.value.length;++o)a={},n=r.value[o],a.type=zn.derToOid(n.value[0].value),a.value=n.value[1].value,a.valueTagClass=n.value[1].type,a.type in Gn&&(a.name=Gn[a.type],a.name in Qn&&(a.shortName=Qn[a.name])),t&&(t.update(a.type),t.update(a.value)),i.push(a)}return i},qn.CRIAttributesAsArray=function(e){for(var t=[],r=0;r<e.length;++r)for(var n=e[r],a=zn.derToOid(n.value[0].value),i=n.value[1].value,s=0;s<i.length;++s){var o={};if(o.type=a,o.value=i[s].value,o.valueTagClass=i[s].type,o.type in Gn&&(o.name=Gn[o.type],o.name in Qn&&(o.shortName=Qn[o.name])),o.type===Gn.extensionRequest){o.extensions=[];for(var u=0;u<o.value.length;++u)o.extensions.push(qn.certificateExtensionFromAsn1(o.value[u]))}t.push(o)}return t};var $n=function(e,t,r){var n={};if(e!==Gn["RSASSA-PSS"])return n;r&&(n={hash:{algorithmOid:Gn.sha1},mgf:{algorithmOid:Gn.mgf1,hash:{algorithmOid:Gn.sha1}},saltLength:20});var a={},i=[];if(!zn.validate(t,Xn,a,i)){var s=new Error("Cannot read RSASSA-PSS parameter block.");throw s.errors=i,s}return void 0!==a.hashOid&&(n.hash=n.hash||{},n.hash.algorithmOid=zn.derToOid(a.hashOid)),void 0!==a.maskGenOid&&(n.mgf=n.mgf||{},n.mgf.algorithmOid=zn.derToOid(a.maskGenOid),n.mgf.hash=n.mgf.hash||{},n.mgf.hash.algorithmOid=zn.derToOid(a.maskGenHashOid)),void 0!==a.saltLength&&(n.saltLength=a.saltLength.charCodeAt(0)),n};function ea(e){for(var t,r,n=zn.create(zn.Class.UNIVERSAL,zn.Type.SEQUENCE,!0,[]),a=e.attributes,i=0;i<a.length;++i){var s=(t=a[i]).value,o=zn.Type.PRINTABLESTRING;"valueTagClass"in t&&(o=t.valueTagClass)===zn.Type.UTF8&&(s=c.util.encodeUtf8(s)),r=zn.create(zn.Class.UNIVERSAL,zn.Type.SET,!0,[zn.create(zn.Class.UNIVERSAL,zn.Type.SEQUENCE,!0,[zn.create(zn.Class.UNIVERSAL,zn.Type.OID,!1,zn.oidToDer(t.type).getBytes()),zn.create(zn.Class.UNIVERSAL,o,!1,s)])]),n.value.push(r)}return n}function ta(e){for(var t,r=0;r<e.length;++r){if(void 0===(t=e[r]).name&&(t.type&&t.type in qn.oids?t.name=qn.oids[t.type]:t.shortName&&t.shortName in Qn&&(t.name=qn.oids[Qn[t.shortName]])),void 0===t.type){if(!(t.name&&t.name in qn.oids))throw(a=new Error("Attribute type not specified.")).attribute=t,a;t.type=qn.oids[t.name]}if(void 0===t.shortName&&t.name&&t.name in Qn&&(t.shortName=Qn[t.name]),t.type===Gn.extensionRequest&&(t.valueConstructed=!0,t.valueTagClass=zn.Type.SEQUENCE,!t.value&&t.extensions)){t.value=[];for(var n=0;n<t.extensions.length;++n)t.value.push(qn.certificateExtensionToAsn1(ra(t.extensions[n])))}var a;if(void 0===t.value)throw(a=new Error("Attribute value not specified.")).attribute=t,a}}function ra(e,t){if(t=t||{},void 0===e.name&&e.id&&e.id in qn.oids&&(e.name=qn.oids[e.id]),void 0===e.id){if(!(e.name&&e.name in qn.oids))throw(m=new Error("Extension ID not specified.")).extension=e,m;e.id=qn.oids[e.name]}if(void 0!==e.value)return e;if("keyUsage"===e.name){var r=0,n=0,a=0;e.digitalSignature&&(n|=128,r=7),e.nonRepudiation&&(n|=64,r=6),e.keyEncipherment&&(n|=32,r=5),e.dataEncipherment&&(n|=16,r=4),e.keyAgreement&&(n|=8,r=3),e.keyCertSign&&(n|=4,r=2),e.cRLSign&&(n|=2,r=1),e.encipherOnly&&(n|=1,r=0),e.decipherOnly&&(a|=128,r=7);var i=String.fromCharCode(r);0!==a?i+=String.fromCharCode(n)+String.fromCharCode(a):0!==n&&(i+=String.fromCharCode(n)),e.value=zn.create(zn.Class.UNIVERSAL,zn.Type.BITSTRING,!1,i)}else if("basicConstraints"===e.name)e.value=zn.create(zn.Class.UNIVERSAL,zn.Type.SEQUENCE,!0,[]),e.cA&&e.value.value.push(zn.create(zn.Class.UNIVERSAL,zn.Type.BOOLEAN,!1,String.fromCharCode(255))),"pathLenConstraint"in e&&e.value.value.push(zn.create(zn.Class.UNIVERSAL,zn.Type.INTEGER,!1,zn.integerToDer(e.pathLenConstraint).getBytes()));else if("extKeyUsage"===e.name){e.value=zn.create(zn.Class.UNIVERSAL,zn.Type.SEQUENCE,!0,[]);var s=e.value.value;for(var o in e)!0===e[o]&&(o in Gn?s.push(zn.create(zn.Class.UNIVERSAL,zn.Type.OID,!1,zn.oidToDer(Gn[o]).getBytes())):-1!==o.indexOf(".")&&s.push(zn.create(zn.Class.UNIVERSAL,zn.Type.OID,!1,zn.oidToDer(o).getBytes())))}else if("nsCertType"===e.name)r=0,n=0,e.client&&(n|=128,r=7),e.server&&(n|=64,r=6),e.email&&(n|=32,r=5),e.objsign&&(n|=16,r=4),e.reserved&&(n|=8,r=3),e.sslCA&&(n|=4,r=2),e.emailCA&&(n|=2,r=1),e.objCA&&(n|=1,r=0),i=String.fromCharCode(r),0!==n&&(i+=String.fromCharCode(n)),e.value=zn.create(zn.Class.UNIVERSAL,zn.Type.BITSTRING,!1,i);else if("subjectAltName"===e.name||"issuerAltName"===e.name){e.value=zn.create(zn.Class.UNIVERSAL,zn.Type.SEQUENCE,!0,[]);for(var u=0;u<e.altNames.length;++u){if(i=(d=e.altNames[u]).value,7===d.type&&d.ip){if(null===(i=c.util.bytesFromIP(d.ip)))throw(m=new Error('Extension "ip" value is not a valid IPv4 or IPv6 address.')).extension=e,m}else 8===d.type&&(i=d.oid?zn.oidToDer(zn.oidToDer(d.oid)):zn.oidToDer(i));e.value.value.push(zn.create(zn.Class.CONTEXT_SPECIFIC,d.type,!1,i))}}else if("nsComment"===e.name&&t.cert){if(!/^[\x00-\x7F]*$/.test(e.comment)||e.comment.length<1||e.comment.length>128)throw new Error('Invalid "nsComment" content.');e.value=zn.create(zn.Class.UNIVERSAL,zn.Type.IA5STRING,!1,e.comment)}else if("subjectKeyIdentifier"===e.name&&t.cert){var l=t.cert.generateSubjectKeyIdentifier();e.subjectKeyIdentifier=l.toHex(),e.value=zn.create(zn.Class.UNIVERSAL,zn.Type.OCTETSTRING,!1,l.getBytes())}else if("authorityKeyIdentifier"===e.name&&t.cert){if(e.value=zn.create(zn.Class.UNIVERSAL,zn.Type.SEQUENCE,!0,[]),s=e.value.value,e.keyIdentifier){var f=!0===e.keyIdentifier?t.cert.generateSubjectKeyIdentifier().getBytes():e.keyIdentifier;s.push(zn.create(zn.Class.CONTEXT_SPECIFIC,0,!1,f))}if(e.authorityCertIssuer){var h=[zn.create(zn.Class.CONTEXT_SPECIFIC,4,!0,[ea(!0===e.authorityCertIssuer?t.cert.issuer:e.authorityCertIssuer)])];s.push(zn.create(zn.Class.CONTEXT_SPECIFIC,1,!0,h))}if(e.serialNumber){var p=c.util.hexToBytes(!0===e.serialNumber?t.cert.serialNumber:e.serialNumber);s.push(zn.create(zn.Class.CONTEXT_SPECIFIC,2,!1,p))}}else if("cRLDistributionPoints"===e.name){e.value=zn.create(zn.Class.UNIVERSAL,zn.Type.SEQUENCE,!0,[]),s=e.value.value;var d,y=zn.create(zn.Class.UNIVERSAL,zn.Type.SEQUENCE,!0,[]),g=zn.create(zn.Class.CONTEXT_SPECIFIC,0,!0,[]);for(u=0;u<e.altNames.length;++u){if(i=(d=e.altNames[u]).value,7===d.type&&d.ip){if(null===(i=c.util.bytesFromIP(d.ip)))throw(m=new Error('Extension "ip" value is not a valid IPv4 or IPv6 address.')).extension=e,m}else 8===d.type&&(i=d.oid?zn.oidToDer(zn.oidToDer(d.oid)):zn.oidToDer(i));g.value.push(zn.create(zn.Class.CONTEXT_SPECIFIC,d.type,!1,i))}y.value.push(zn.create(zn.Class.CONTEXT_SPECIFIC,0,!0,[g])),s.push(y)}var m;if(void 0===e.value)throw(m=new Error("Extension value not specified.")).extension=e,m;return e}function na(e,t){switch(e){case Gn["RSASSA-PSS"]:var r=[];return void 0!==t.hash.algorithmOid&&r.push(zn.create(zn.Class.CONTEXT_SPECIFIC,0,!0,[zn.create(zn.Class.UNIVERSAL,zn.Type.SEQUENCE,!0,[zn.create(zn.Class.UNIVERSAL,zn.Type.OID,!1,zn.oidToDer(t.hash.algorithmOid).getBytes()),zn.create(zn.Class.UNIVERSAL,zn.Type.NULL,!1,"")])])),void 0!==t.mgf.algorithmOid&&r.push(zn.create(zn.Class.CONTEXT_SPECIFIC,1,!0,[zn.create(zn.Class.UNIVERSAL,zn.Type.SEQUENCE,!0,[zn.create(zn.Class.UNIVERSAL,zn.Type.OID,!1,zn.oidToDer(t.mgf.algorithmOid).getBytes()),zn.create(zn.Class.UNIVERSAL,zn.Type.SEQUENCE,!0,[zn.create(zn.Class.UNIVERSAL,zn.Type.OID,!1,zn.oidToDer(t.mgf.hash.algorithmOid).getBytes()),zn.create(zn.Class.UNIVERSAL,zn.Type.NULL,!1,"")])])])),void 0!==t.saltLength&&r.push(zn.create(zn.Class.CONTEXT_SPECIFIC,2,!0,[zn.create(zn.Class.UNIVERSAL,zn.Type.INTEGER,!1,zn.integerToDer(t.saltLength).getBytes())])),zn.create(zn.Class.UNIVERSAL,zn.Type.SEQUENCE,!0,r);default:return zn.create(zn.Class.UNIVERSAL,zn.Type.NULL,!1,"")}}function aa(e){var t=zn.create(zn.Class.CONTEXT_SPECIFIC,0,!0,[]);if(0===e.attributes.length)return t;for(var r=e.attributes,n=0;n<r.length;++n){var a=r[n],i=a.value,s=zn.Type.UTF8;"valueTagClass"in a&&(s=a.valueTagClass),s===zn.Type.UTF8&&(i=c.util.encodeUtf8(i));var o=!1;"valueConstructed"in a&&(o=a.valueConstructed);var u=zn.create(zn.Class.UNIVERSAL,zn.Type.SEQUENCE,!0,[zn.create(zn.Class.UNIVERSAL,zn.Type.OID,!1,zn.oidToDer(a.type).getBytes()),zn.create(zn.Class.UNIVERSAL,zn.Type.SET,!0,[zn.create(zn.Class.UNIVERSAL,s,o,i)])]);t.value.push(u)}return t}qn.certificateFromPem=function(e,t,r){var n=c.pem.decode(e)[0];if("CERTIFICATE"!==n.type&&"X509 CERTIFICATE"!==n.type&&"TRUSTED CERTIFICATE"!==n.type){var a=new Error('Could not convert certificate from PEM; PEM header type is not "CERTIFICATE", "X509 CERTIFICATE", or "TRUSTED CERTIFICATE".');throw a.headerType=n.type,a}if(n.procType&&"ENCRYPTED"===n.procType.type)throw new Error("Could not convert certificate from PEM; PEM is encrypted.");var i=zn.fromDer(n.body,r);return qn.certificateFromAsn1(i,t)},qn.certificateToPem=function(e,t){var r={type:"CERTIFICATE",body:zn.toDer(qn.certificateToAsn1(e)).getBytes()};return c.pem.encode(r,{maxline:t})},qn.publicKeyFromPem=function(e){var t=c.pem.decode(e)[0];if("PUBLIC KEY"!==t.type&&"RSA PUBLIC KEY"!==t.type){var r=new Error('Could not convert public key from PEM; PEM header type is not "PUBLIC KEY" or "RSA PUBLIC KEY".');throw r.headerType=t.type,r}if(t.procType&&"ENCRYPTED"===t.procType.type)throw new Error("Could not convert public key from PEM; PEM is encrypted.");var n=zn.fromDer(t.body);return qn.publicKeyFromAsn1(n)},qn.publicKeyToPem=function(e,t){var r={type:"PUBLIC KEY",body:zn.toDer(qn.publicKeyToAsn1(e)).getBytes()};return c.pem.encode(r,{maxline:t})},qn.publicKeyToRSAPublicKeyPem=function(e,t){var r={type:"RSA PUBLIC KEY",body:zn.toDer(qn.publicKeyToRSAPublicKey(e)).getBytes()};return c.pem.encode(r,{maxline:t})},qn.getPublicKeyFingerprint=function(e,t){var r,n=(t=t||{}).md||c.md.sha1.create();switch(t.type||"RSAPublicKey"){case"RSAPublicKey":r=zn.toDer(qn.publicKeyToRSAPublicKey(e)).getBytes();break;case"SubjectPublicKeyInfo":r=zn.toDer(qn.publicKeyToAsn1(e)).getBytes();break;default:throw new Error('Unknown fingerprint type "'+t.type+'".')}n.start(),n.update(r);var a=n.digest();if("hex"===t.encoding){var i=a.toHex();return t.delimiter?i.match(/.{2}/g).join(t.delimiter):i}if("binary"===t.encoding)return a.getBytes();if(t.encoding)throw new Error('Unknown encoding "'+t.encoding+'".');return a},qn.certificationRequestFromPem=function(e,t,r){var n=c.pem.decode(e)[0];if("CERTIFICATE REQUEST"!==n.type){var a=new Error('Could not convert certification request from PEM; PEM header type is not "CERTIFICATE REQUEST".');throw a.headerType=n.type,a}if(n.procType&&"ENCRYPTED"===n.procType.type)throw new Error("Could not convert certification request from PEM; PEM is encrypted.");var i=zn.fromDer(n.body,r);return qn.certificationRequestFromAsn1(i,t)},qn.certificationRequestToPem=function(e,t){var r={type:"CERTIFICATE REQUEST",body:zn.toDer(qn.certificationRequestToAsn1(e)).getBytes()};return c.pem.encode(r,{maxline:t})},qn.createCertificate=function(){var e={version:2,serialNumber:"00",signatureOid:null,signature:null,siginfo:{}};return e.siginfo.algorithmOid=null,e.validity={},e.validity.notBefore=new Date,e.validity.notAfter=new Date,e.issuer={},e.issuer.getField=function(t){return Jn(e.issuer,t)},e.issuer.addField=function(t){ta([t]),e.issuer.attributes.push(t)},e.issuer.attributes=[],e.issuer.hash=null,e.subject={},e.subject.getField=function(t){return Jn(e.subject,t)},e.subject.addField=function(t){ta([t]),e.subject.attributes.push(t)},e.subject.attributes=[],e.subject.hash=null,e.extensions=[],e.publicKey=null,e.md=null,e.setSubject=function(t,r){ta(t),e.subject.attributes=t,delete e.subject.uniqueId,r&&(e.subject.uniqueId=r),e.subject.hash=null},e.setIssuer=function(t,r){ta(t),e.issuer.attributes=t,delete e.issuer.uniqueId,r&&(e.issuer.uniqueId=r),e.issuer.hash=null},e.setExtensions=function(t){for(var r=0;r<t.length;++r)ra(t[r],{cert:e});e.extensions=t},e.getExtension=function(t){"string"==typeof t&&(t={name:t});for(var r,n=null,a=0;null===n&&a<e.extensions.length;++a)r=e.extensions[a],t.id&&r.id===t.id?n=r:t.name&&r.name===t.name&&(n=r);return n},e.sign=function(t,r){e.md=r||c.md.sha1.create();var n=Gn[e.md.algorithm+"WithRSAEncryption"];if(!n){var a=new Error("Could not compute certificate digest. Unknown message digest algorithm OID.");throw a.algorithm=e.md.algorithm,a}e.signatureOid=e.siginfo.algorithmOid=n,e.tbsCertificate=qn.getTBSCertificate(e);var i=zn.toDer(e.tbsCertificate);e.md.update(i.getBytes()),e.signature=t.sign(e.md)},e.verify=function(t){var r=!1;if(!e.issued(t)){var n=t.issuer,a=e.subject;throw(h=new Error("The parent certificate did not issue the given child certificate; the child certificate's issuer does not match the parent's subject.")).expectedIssuer=n.attributes,h.actualIssuer=a.attributes,h}var i=t.md;if(null===i){if(t.signatureOid in Gn)switch(Gn[t.signatureOid]){case"sha1WithRSAEncryption":i=c.md.sha1.create();break;case"md5WithRSAEncryption":i=c.md.md5.create();break;case"sha256WithRSAEncryption":i=c.md.sha256.create();break;case"sha384WithRSAEncryption":i=c.md.sha384.create();break;case"sha512WithRSAEncryption":i=c.md.sha512.create();break;case"RSASSA-PSS":i=c.md.sha256.create()}if(null===i)throw(h=new Error("Could not compute certificate digest. Unknown signature OID.")).signatureOid=t.signatureOid,h;var s=t.tbsCertificate||qn.getTBSCertificate(t),o=zn.toDer(s);i.update(o.getBytes())}if(null!==i){var u;switch(t.signatureOid){case Gn.sha1WithRSAEncryption:u=void 0;break;case Gn["RSASSA-PSS"]:var l,f,h;if(void 0===(l=Gn[t.signatureParameters.mgf.hash.algorithmOid])||void 0===c.md[l])throw(h=new Error("Unsupported MGF hash function.")).oid=t.signatureParameters.mgf.hash.algorithmOid,h.name=l,h;if(void 0===(f=Gn[t.signatureParameters.mgf.algorithmOid])||void 0===c.mgf[f])throw(h=new Error("Unsupported MGF function.")).oid=t.signatureParameters.mgf.algorithmOid,h.name=f,h;if(f=c.mgf[f].create(c.md[l].create()),void 0===(l=Gn[t.signatureParameters.hash.algorithmOid])||void 0===c.md[l])throw{message:"Unsupported RSASSA-PSS hash function.",oid:t.signatureParameters.hash.algorithmOid,name:l};u=c.pss.create(c.md[l].create(),f,t.signatureParameters.saltLength)}r=e.publicKey.verify(i.digest().getBytes(),t.signature,u)}return r},e.isIssuer=function(t){var r=!1,n=e.issuer,a=t.subject;if(n.hash&&a.hash)r=n.hash===a.hash;else if(n.attributes.length===a.attributes.length){var i,s;r=!0;for(var o=0;r&&o<n.attributes.length;++o)i=n.attributes[o],s=a.attributes[o],i.type===s.type&&i.value===s.value||(r=!1)}return r},e.issued=function(t){return t.isIssuer(e)},e.generateSubjectKeyIdentifier=function(){return qn.getPublicKeyFingerprint(e.publicKey,{type:"RSAPublicKey"})},e.verifySubjectKeyIdentifier=function(){for(var t=Gn.subjectKeyIdentifier,r=0;r<e.extensions.length;++r){var n=e.extensions[r];if(n.id===t){var a=e.generateSubjectKeyIdentifier().getBytes();return c.util.hexToBytes(n.subjectKeyIdentifier)===a}}return!1},e},qn.certificateFromAsn1=function(e,t){var r={},n=[];if(!zn.validate(e,Wn,r,n))throw(o=new Error("Cannot read X.509 certificate. ASN.1 object is not an X509v3 Certificate.")).errors=n,o;if(zn.derToOid(r.publicKeyOid)!==qn.oids.rsaEncryption)throw new Error("Cannot read public key. OID is not RSA.");var a=qn.createCertificate();a.version=r.certVersion?r.certVersion.charCodeAt(0):0;var i=c.util.createBuffer(r.certSerialNumber);a.serialNumber=i.toHex(),a.signatureOid=c.asn1.derToOid(r.certSignatureOid),a.signatureParameters=$n(a.signatureOid,r.certSignatureParams,!0),a.siginfo.algorithmOid=c.asn1.derToOid(r.certinfoSignatureOid),a.siginfo.parameters=$n(a.siginfo.algorithmOid,r.certinfoSignatureParams,!1),a.signature=r.certSignature;var s=[];if(void 0!==r.certValidity1UTCTime&&s.push(zn.utcTimeToDate(r.certValidity1UTCTime)),void 0!==r.certValidity2GeneralizedTime&&s.push(zn.generalizedTimeToDate(r.certValidity2GeneralizedTime)),void 0!==r.certValidity3UTCTime&&s.push(zn.utcTimeToDate(r.certValidity3UTCTime)),void 0!==r.certValidity4GeneralizedTime&&s.push(zn.generalizedTimeToDate(r.certValidity4GeneralizedTime)),s.length>2)throw new Error("Cannot read notBefore/notAfter validity times; more than two times were provided in the certificate.");if(s.length<2)throw new Error("Cannot read notBefore/notAfter validity times; they were not provided as either UTCTime or GeneralizedTime.");if(a.validity.notBefore=s[0],a.validity.notAfter=s[1],a.tbsCertificate=r.tbsCertificate,t){var o;if(a.md=null,a.signatureOid in Gn)switch(Gn[a.signatureOid]){case"sha1WithRSAEncryption":a.md=c.md.sha1.create();break;case"md5WithRSAEncryption":a.md=c.md.md5.create();break;case"sha256WithRSAEncryption":a.md=c.md.sha256.create();break;case"sha384WithRSAEncryption":a.md=c.md.sha384.create();break;case"sha512WithRSAEncryption":a.md=c.md.sha512.create();break;case"RSASSA-PSS":a.md=c.md.sha256.create()}if(null===a.md)throw(o=new Error("Could not compute certificate digest. Unknown signature OID.")).signatureOid=a.signatureOid,o;var u=zn.toDer(a.tbsCertificate);a.md.update(u.getBytes())}var l=c.md.sha1.create();a.issuer.getField=function(e){return Jn(a.issuer,e)},a.issuer.addField=function(e){ta([e]),a.issuer.attributes.push(e)},a.issuer.attributes=qn.RDNAttributesAsArray(r.certIssuer,l),r.certIssuerUniqueId&&(a.issuer.uniqueId=r.certIssuerUniqueId),a.issuer.hash=l.digest().toHex();var f=c.md.sha1.create();return a.subject.getField=function(e){return Jn(a.subject,e)},a.subject.addField=function(e){ta([e]),a.subject.attributes.push(e)},a.subject.attributes=qn.RDNAttributesAsArray(r.certSubject,f),r.certSubjectUniqueId&&(a.subject.uniqueId=r.certSubjectUniqueId),a.subject.hash=f.digest().toHex(),r.certExtensions?a.extensions=qn.certificateExtensionsFromAsn1(r.certExtensions):a.extensions=[],a.publicKey=qn.publicKeyFromAsn1(r.subjectPublicKeyInfo),a},qn.certificateExtensionsFromAsn1=function(e){for(var t=[],r=0;r<e.value.length;++r)for(var n=e.value[r],a=0;a<n.value.length;++a)t.push(qn.certificateExtensionFromAsn1(n.value[a]));return t},qn.certificateExtensionFromAsn1=function(e){var t={};if(t.id=zn.derToOid(e.value[0].value),t.critical=!1,e.value[1].type===zn.Type.BOOLEAN?(t.critical=0!==e.value[1].value.charCodeAt(0),t.value=e.value[2].value):t.value=e.value[1].value,t.id in Gn)if(t.name=Gn[t.id],"keyUsage"===t.name){var r=0,n=0;(i=zn.fromDer(t.value)).value.length>1&&(r=i.value.charCodeAt(1),n=i.value.length>2?i.value.charCodeAt(2):0),t.digitalSignature=128==(128&r),t.nonRepudiation=64==(64&r),t.keyEncipherment=32==(32&r),t.dataEncipherment=16==(16&r),t.keyAgreement=8==(8&r),t.keyCertSign=4==(4&r),t.cRLSign=2==(2&r),t.encipherOnly=1==(1&r),t.decipherOnly=128==(128&n)}else if("basicConstraints"===t.name){(i=zn.fromDer(t.value)).value.length>0&&i.value[0].type===zn.Type.BOOLEAN?t.cA=0!==i.value[0].value.charCodeAt(0):t.cA=!1;var a=null;i.value.length>0&&i.value[0].type===zn.Type.INTEGER?a=i.value[0].value:i.value.length>1&&(a=i.value[1].value),null!==a&&(t.pathLenConstraint=zn.derToInteger(a))}else if("extKeyUsage"===t.name)for(var i=zn.fromDer(t.value),s=0;s<i.value.length;++s){var o=zn.derToOid(i.value[s].value);o in Gn?t[Gn[o]]=!0:t[o]=!0}else if("nsCertType"===t.name)r=0,(i=zn.fromDer(t.value)).value.length>1&&(r=i.value.charCodeAt(1)),t.client=128==(128&r),t.server=64==(64&r),t.email=32==(32&r),t.objsign=16==(16&r),t.reserved=8==(8&r),t.sslCA=4==(4&r),t.emailCA=2==(2&r),t.objCA=1==(1&r);else if("subjectAltName"===t.name||"issuerAltName"===t.name){var u;t.altNames=[],i=zn.fromDer(t.value);for(var l=0;l<i.value.length;++l){var f={type:(u=i.value[l]).type,value:u.value};switch(t.altNames.push(f),u.type){case 1:case 2:case 6:break;case 7:f.ip=c.util.bytesToIP(u.value);break;case 8:f.oid=zn.derToOid(u.value)}}}else"subjectKeyIdentifier"===t.name&&(i=zn.fromDer(t.value),t.subjectKeyIdentifier=c.util.bytesToHex(i.value));return t},qn.certificationRequestFromAsn1=function(e,t){var r={},n=[];if(!zn.validate(e,Zn,r,n))throw(i=new Error("Cannot read PKCS#10 certificate request. ASN.1 object is not a PKCS#10 CertificationRequest.")).errors=n,i;if(zn.derToOid(r.publicKeyOid)!==qn.oids.rsaEncryption)throw new Error("Cannot read public key. OID is not RSA.");var a=qn.createCertificationRequest();if(a.version=r.csrVersion?r.csrVersion.charCodeAt(0):0,a.signatureOid=c.asn1.derToOid(r.csrSignatureOid),a.signatureParameters=$n(a.signatureOid,r.csrSignatureParams,!0),a.siginfo.algorithmOid=c.asn1.derToOid(r.csrSignatureOid),a.siginfo.parameters=$n(a.siginfo.algorithmOid,r.csrSignatureParams,!1),a.signature=r.csrSignature,a.certificationRequestInfo=r.certificationRequestInfo,t){var i;if(a.md=null,a.signatureOid in Gn)switch(Gn[a.signatureOid]){case"sha1WithRSAEncryption":a.md=c.md.sha1.create();break;case"md5WithRSAEncryption":a.md=c.md.md5.create();break;case"sha256WithRSAEncryption":a.md=c.md.sha256.create();break;case"sha384WithRSAEncryption":a.md=c.md.sha384.create();break;case"sha512WithRSAEncryption":a.md=c.md.sha512.create();break;case"RSASSA-PSS":a.md=c.md.sha256.create()}if(null===a.md)throw(i=new Error("Could not compute certification request digest. Unknown signature OID.")).signatureOid=a.signatureOid,i;var s=zn.toDer(a.certificationRequestInfo);a.md.update(s.getBytes())}var o=c.md.sha1.create();return a.subject.getField=function(e){return Jn(a.subject,e)},a.subject.addField=function(e){ta([e]),a.subject.attributes.push(e)},a.subject.attributes=qn.RDNAttributesAsArray(r.certificationRequestInfoSubject,o),a.subject.hash=o.digest().toHex(),a.publicKey=qn.publicKeyFromAsn1(r.subjectPublicKeyInfo),a.getAttribute=function(e){return Jn(a,e)},a.addAttribute=function(e){ta([e]),a.attributes.push(e)},a.attributes=qn.CRIAttributesAsArray(r.certificationRequestInfoAttributes||[]),a},qn.createCertificationRequest=function(){var e={version:0,signatureOid:null,signature:null,siginfo:{}};return e.siginfo.algorithmOid=null,e.subject={},e.subject.getField=function(t){return Jn(e.subject,t)},e.subject.addField=function(t){ta([t]),e.subject.attributes.push(t)},e.subject.attributes=[],e.subject.hash=null,e.publicKey=null,e.attributes=[],e.getAttribute=function(t){return Jn(e,t)},e.addAttribute=function(t){ta([t]),e.attributes.push(t)},e.md=null,e.setSubject=function(t){ta(t),e.subject.attributes=t,e.subject.hash=null},e.setAttributes=function(t){ta(t),e.attributes=t},e.sign=function(t,r){e.md=r||c.md.sha1.create();var n=Gn[e.md.algorithm+"WithRSAEncryption"];if(!n){var a=new Error("Could not compute certification request digest. Unknown message digest algorithm OID.");throw a.algorithm=e.md.algorithm,a}e.signatureOid=e.siginfo.algorithmOid=n,e.certificationRequestInfo=qn.getCertificationRequestInfo(e);var i=zn.toDer(e.certificationRequestInfo);e.md.update(i.getBytes()),e.signature=t.sign(e.md)},e.verify=function(){var t=!1,r=e.md;if(null===r){if(e.signatureOid in Gn)switch(Gn[e.signatureOid]){case"sha1WithRSAEncryption":r=c.md.sha1.create();break;case"md5WithRSAEncryption":r=c.md.md5.create();break;case"sha256WithRSAEncryption":r=c.md.sha256.create();break;case"sha384WithRSAEncryption":r=c.md.sha384.create();break;case"sha512WithRSAEncryption":r=c.md.sha512.create();break;case"RSASSA-PSS":r=c.md.sha256.create()}if(null===r)throw(u=new Error("Could not compute certification request digest. Unknown signature OID.")).signatureOid=e.signatureOid,u;var n=e.certificationRequestInfo||qn.getCertificationRequestInfo(e),a=zn.toDer(n);r.update(a.getBytes())}if(null!==r){var i;switch(e.signatureOid){case Gn.sha1WithRSAEncryption:break;case Gn["RSASSA-PSS"]:var s,o,u;if(void 0===(s=Gn[e.signatureParameters.mgf.hash.algorithmOid])||void 0===c.md[s])throw(u=new Error("Unsupported MGF hash function.")).oid=e.signatureParameters.mgf.hash.algorithmOid,u.name=s,u;if(void 0===(o=Gn[e.signatureParameters.mgf.algorithmOid])||void 0===c.mgf[o])throw(u=new Error("Unsupported MGF function.")).oid=e.signatureParameters.mgf.algorithmOid,u.name=o,u;if(o=c.mgf[o].create(c.md[s].create()),void 0===(s=Gn[e.signatureParameters.hash.algorithmOid])||void 0===c.md[s])throw(u=new Error("Unsupported RSASSA-PSS hash function.")).oid=e.signatureParameters.hash.algorithmOid,u.name=s,u;i=c.pss.create(c.md[s].create(),o,e.signatureParameters.saltLength)}t=e.publicKey.verify(r.digest().getBytes(),e.signature,i)}return t},e};var ia=new Date("1950-01-01T00:00:00Z"),sa=new Date("2050-01-01T00:00:00Z");function oa(e){return e>=ia&&e<sa?zn.create(zn.Class.UNIVERSAL,zn.Type.UTCTIME,!1,zn.dateToUtcTime(e)):zn.create(zn.Class.UNIVERSAL,zn.Type.GENERALIZEDTIME,!1,zn.dateToGeneralizedTime(e))}qn.getTBSCertificate=function(e){var t=oa(e.validity.notBefore),r=oa(e.validity.notAfter),n=zn.create(zn.Class.UNIVERSAL,zn.Type.SEQUENCE,!0,[zn.create(zn.Class.CONTEXT_SPECIFIC,0,!0,[zn.create(zn.Class.UNIVERSAL,zn.Type.INTEGER,!1,zn.integerToDer(e.version).getBytes())]),zn.create(zn.Class.UNIVERSAL,zn.Type.INTEGER,!1,c.util.hexToBytes(e.serialNumber)),zn.create(zn.Class.UNIVERSAL,zn.Type.SEQUENCE,!0,[zn.create(zn.Class.UNIVERSAL,zn.Type.OID,!1,zn.oidToDer(e.siginfo.algorithmOid).getBytes()),na(e.siginfo.algorithmOid,e.siginfo.parameters)]),ea(e.issuer),zn.create(zn.Class.UNIVERSAL,zn.Type.SEQUENCE,!0,[t,r]),ea(e.subject),qn.publicKeyToAsn1(e.publicKey)]);return e.issuer.uniqueId&&n.value.push(zn.create(zn.Class.CONTEXT_SPECIFIC,1,!0,[zn.create(zn.Class.UNIVERSAL,zn.Type.BITSTRING,!1,String.fromCharCode(0)+e.issuer.uniqueId)])),e.subject.uniqueId&&n.value.push(zn.create(zn.Class.CONTEXT_SPECIFIC,2,!0,[zn.create(zn.Class.UNIVERSAL,zn.Type.BITSTRING,!1,String.fromCharCode(0)+e.subject.uniqueId)])),e.extensions.length>0&&n.value.push(qn.certificateExtensionsToAsn1(e.extensions)),n},qn.getCertificationRequestInfo=function(e){return zn.create(zn.Class.UNIVERSAL,zn.Type.SEQUENCE,!0,[zn.create(zn.Class.UNIVERSAL,zn.Type.INTEGER,!1,zn.integerToDer(e.version).getBytes()),ea(e.subject),qn.publicKeyToAsn1(e.publicKey),aa(e)])},qn.distinguishedNameToAsn1=function(e){return ea(e)},qn.certificateToAsn1=function(e){var t=e.tbsCertificate||qn.getTBSCertificate(e);return zn.create(zn.Class.UNIVERSAL,zn.Type.SEQUENCE,!0,[t,zn.create(zn.Class.UNIVERSAL,zn.Type.SEQUENCE,!0,[zn.create(zn.Class.UNIVERSAL,zn.Type.OID,!1,zn.oidToDer(e.signatureOid).getBytes()),na(e.signatureOid,e.signatureParameters)]),zn.create(zn.Class.UNIVERSAL,zn.Type.BITSTRING,!1,String.fromCharCode(0)+e.signature)])},qn.certificateExtensionsToAsn1=function(e){var t=zn.create(zn.Class.CONTEXT_SPECIFIC,3,!0,[]),r=zn.create(zn.Class.UNIVERSAL,zn.Type.SEQUENCE,!0,[]);t.value.push(r);for(var n=0;n<e.length;++n)r.value.push(qn.certificateExtensionToAsn1(e[n]));return t},qn.certificateExtensionToAsn1=function(e){var t=zn.create(zn.Class.UNIVERSAL,zn.Type.SEQUENCE,!0,[]);t.value.push(zn.create(zn.Class.UNIVERSAL,zn.Type.OID,!1,zn.oidToDer(e.id).getBytes())),e.critical&&t.value.push(zn.create(zn.Class.UNIVERSAL,zn.Type.BOOLEAN,!1,String.fromCharCode(255)));var r=e.value;return"string"!=typeof e.value&&(r=zn.toDer(r).getBytes()),t.value.push(zn.create(zn.Class.UNIVERSAL,zn.Type.OCTETSTRING,!1,r)),t},qn.certificationRequestToAsn1=function(e){var t=e.certificationRequestInfo||qn.getCertificationRequestInfo(e);return zn.create(zn.Class.UNIVERSAL,zn.Type.SEQUENCE,!0,[t,zn.create(zn.Class.UNIVERSAL,zn.Type.SEQUENCE,!0,[zn.create(zn.Class.UNIVERSAL,zn.Type.OID,!1,zn.oidToDer(e.signatureOid).getBytes()),na(e.signatureOid,e.signatureParameters)]),zn.create(zn.Class.UNIVERSAL,zn.Type.BITSTRING,!1,String.fromCharCode(0)+e.signature)])},qn.createCaStore=function(e){var t={certs:{}};function r(e){return n(e),t.certs[e.hash]||null}function n(e){if(!e.hash){var t=c.md.sha1.create();e.attributes=qn.RDNAttributesAsArray(ea(e),t),e.hash=t.digest().toHex()}}if(t.getIssuer=function(e){return r(e.issuer)},t.addCertificate=function(e){if("string"==typeof e&&(e=c.pki.certificateFromPem(e)),n(e.subject),!t.hasCertificate(e))if(e.subject.hash in t.certs){var r=t.certs[e.subject.hash];c.util.isArray(r)||(r=[r]),r.push(e),t.certs[e.subject.hash]=r}else t.certs[e.subject.hash]=e},t.hasCertificate=function(e){"string"==typeof e&&(e=c.pki.certificateFromPem(e));var t=r(e.subject);if(!t)return!1;c.util.isArray(t)||(t=[t]);for(var n=zn.toDer(qn.certificateToAsn1(e)).getBytes(),a=0;a<t.length;++a)if(n===zn.toDer(qn.certificateToAsn1(t[a])).getBytes())return!0;return!1},t.listAllCertificates=function(){var e=[];for(var r in t.certs)if(t.certs.hasOwnProperty(r)){var n=t.certs[r];if(c.util.isArray(n))for(var a=0;a<n.length;++a)e.push(n[a]);else e.push(n)}return e},t.removeCertificate=function(e){var a;if("string"==typeof e&&(e=c.pki.certificateFromPem(e)),n(e.subject),!t.hasCertificate(e))return null;var i=r(e.subject);if(!c.util.isArray(i))return a=t.certs[e.subject.hash],delete t.certs[e.subject.hash],a;for(var s=zn.toDer(qn.certificateToAsn1(e)).getBytes(),o=0;o<i.length;++o)s===zn.toDer(qn.certificateToAsn1(i[o])).getBytes()&&(a=i[o],i.splice(o,1));return 0===i.length&&delete t.certs[e.subject.hash],a},e)for(var a=0;a<e.length;++a){var i=e[a];t.addCertificate(i)}return t},qn.certificateError={bad_certificate:"forge.pki.BadCertificate",unsupported_certificate:"forge.pki.UnsupportedCertificate",certificate_revoked:"forge.pki.CertificateRevoked",certificate_expired:"forge.pki.CertificateExpired",certificate_unknown:"forge.pki.CertificateUnknown",unknown_ca:"forge.pki.UnknownCertificateAuthority"},qn.verifyCertificateChain=function(e,t,r){"function"==typeof r&&(r={verify:r}),r=r||{};var n=(t=t.slice(0)).slice(0),a=r.validityCheckDate;void 0===a&&(a=new Date);var i=!0,s=null,o=0;do{var u=t.shift(),l=null,f=!1;if(a&&(a<u.validity.notBefore||a>u.validity.notAfter)&&(s={message:"Certificate is not valid yet or has expired.",error:qn.certificateError.certificate_expired,notBefore:u.validity.notBefore,notAfter:u.validity.notAfter,now:a}),null===s){if(null===(l=t[0]||e.getIssuer(u))&&u.isIssuer(u)&&(f=!0,l=u),l){var h=l;c.util.isArray(h)||(h=[h]);for(var p=!1;!p&&h.length>0;){l=h.shift();try{p=l.verify(u)}catch(b){}}p||(s={message:"Certificate signature is invalid.",error:qn.certificateError.bad_certificate})}null!==s||l&&!f||e.hasCertificate(u)||(s={message:"Certificate is not trusted.",error:qn.certificateError.unknown_ca})}if(null===s&&l&&!u.isIssuer(l)&&(s={message:"Certificate issuer is invalid.",error:qn.certificateError.bad_certificate}),null===s)for(var d={keyUsage:!0,basicConstraints:!0},y=0;null===s&&y<u.extensions.length;++y){var g=u.extensions[y];!g.critical||g.name in d||(s={message:"Certificate has an unsupported critical extension.",error:qn.certificateError.unsupported_certificate})}if(null===s&&(!i||0===t.length&&(!l||f))){var m=u.getExtension("basicConstraints"),v=u.getExtension("keyUsage");null!==v&&(v.keyCertSign&&null!==m||(s={message:"Certificate keyUsage or basicConstraints conflict or indicate that the certificate is not a CA. If the certificate is the only one in the chain or isn't the first then the certificate must be a valid CA.",error:qn.certificateError.bad_certificate})),null!==s||null===m||m.cA||(s={message:"Certificate basicConstraints indicates the certificate is not a CA.",error:qn.certificateError.bad_certificate}),null===s&&null!==v&&"pathLenConstraint"in m&&o-1>m.pathLenConstraint&&(s={message:"Certificate basicConstraints pathLenConstraint violated.",error:qn.certificateError.bad_certificate})}var E=null===s||s.error,C=r.verify?r.verify(E,o,n):E;if(!0!==C)throw!0===E&&(s={message:"The application rejected the certificate.",error:qn.certificateError.bad_certificate}),(C||0===C)&&("object"!=typeof C||c.util.isArray(C)?"string"==typeof C&&(s.error=C):(C.message&&(s.message=C.message),C.error&&(s.error=C.error))),s;s=null,i=!1,++o}while(t.length>0);return!0};var ua=c.asn1,ca=c.pki,la=c.pkcs12=c.pkcs12||{},fa={name:"ContentInfo",tagClass:ua.Class.UNIVERSAL,type:ua.Type.SEQUENCE,constructed:!0,value:[{name:"ContentInfo.contentType",tagClass:ua.Class.UNIVERSAL,type:ua.Type.OID,constructed:!1,capture:"contentType"},{name:"ContentInfo.content",tagClass:ua.Class.CONTEXT_SPECIFIC,constructed:!0,captureAsn1:"content"}]},ha={name:"PFX",tagClass:ua.Class.UNIVERSAL,type:ua.Type.SEQUENCE,constructed:!0,value:[{name:"PFX.version",tagClass:ua.Class.UNIVERSAL,type:ua.Type.INTEGER,constructed:!1,capture:"version"},fa,{name:"PFX.macData",tagClass:ua.Class.UNIVERSAL,type:ua.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"mac",value:[{name:"PFX.macData.mac",tagClass:ua.Class.UNIVERSAL,type:ua.Type.SEQUENCE,constructed:!0,value:[{name:"PFX.macData.mac.digestAlgorithm",tagClass:ua.Class.UNIVERSAL,type:ua.Type.SEQUENCE,constructed:!0,value:[{name:"PFX.macData.mac.digestAlgorithm.algorithm",tagClass:ua.Class.UNIVERSAL,type:ua.Type.OID,constructed:!1,capture:"macAlgorithm"},{name:"PFX.macData.mac.digestAlgorithm.parameters",tagClass:ua.Class.UNIVERSAL,captureAsn1:"macAlgorithmParameters"}]},{name:"PFX.macData.mac.digest",tagClass:ua.Class.UNIVERSAL,type:ua.Type.OCTETSTRING,constructed:!1,capture:"macDigest"}]},{name:"PFX.macData.macSalt",tagClass:ua.Class.UNIVERSAL,type:ua.Type.OCTETSTRING,constructed:!1,capture:"macSalt"},{name:"PFX.macData.iterations",tagClass:ua.Class.UNIVERSAL,type:ua.Type.INTEGER,constructed:!1,optional:!0,capture:"macIterations"}]}]},pa={name:"SafeBag",tagClass:ua.Class.UNIVERSAL,type:ua.Type.SEQUENCE,constructed:!0,value:[{name:"SafeBag.bagId",tagClass:ua.Class.UNIVERSAL,type:ua.Type.OID,constructed:!1,capture:"bagId"},{name:"SafeBag.bagValue",tagClass:ua.Class.CONTEXT_SPECIFIC,constructed:!0,captureAsn1:"bagValue"},{name:"SafeBag.bagAttributes",tagClass:ua.Class.UNIVERSAL,type:ua.Type.SET,constructed:!0,optional:!0,capture:"bagAttributes"}]},da={name:"Attribute",tagClass:ua.Class.UNIVERSAL,type:ua.Type.SEQUENCE,constructed:!0,value:[{name:"Attribute.attrId",tagClass:ua.Class.UNIVERSAL,type:ua.Type.OID,constructed:!1,capture:"oid"},{name:"Attribute.attrValues",tagClass:ua.Class.UNIVERSAL,type:ua.Type.SET,constructed:!0,capture:"values"}]},ya={name:"CertBag",tagClass:ua.Class.UNIVERSAL,type:ua.Type.SEQUENCE,constructed:!0,value:[{name:"CertBag.certId",tagClass:ua.Class.UNIVERSAL,type:ua.Type.OID,constructed:!1,capture:"certId"},{name:"CertBag.certValue",tagClass:ua.Class.CONTEXT_SPECIFIC,constructed:!0,value:[{name:"CertBag.certValue[0]",tagClass:ua.Class.UNIVERSAL,type:ua.Class.OCTETSTRING,constructed:!1,capture:"cert"}]}]};function ga(e,t,r,n){for(var a=[],i=0;i<e.length;i++)for(var s=0;s<e[i].safeBags.length;s++){var o=e[i].safeBags[s];void 0!==n&&o.type!==n||(null!==t?void 0!==o.attributes[t]&&o.attributes[t].indexOf(r)>=0&&a.push(o):a.push(o))}return a}function ma(e){if(e.composed||e.constructed){for(var t=c.util.createBuffer(),r=0;r<e.value.length;++r)t.putBytes(e.value[r].value);e.composed=e.constructed=!1,e.value=t.getBytes()}return e}function va(e,t){var r={},n=[];if(!ua.validate(e,c.pkcs7.asn1.encryptedDataValidator,r,n))throw(a=new Error("Cannot read EncryptedContentInfo.")).errors=n,a;var a,i=ua.derToOid(r.contentType);if(i!==ca.oids.data)throw(a=new Error("PKCS#12 EncryptedContentInfo ContentType is not Data.")).oid=i,a;i=ua.derToOid(r.encAlgorithm);var s=ca.pbe.getCipher(i,r.encParameter,t),o=ma(r.encryptedContentAsn1),u=c.util.createBuffer(o.value);if(s.update(u),!s.finish())throw new Error("Failed to decrypt PKCS#12 SafeContents.");return s.output.getBytes()}function Ea(e,t,r){if(!t&&0===e.length)return[];if((e=ua.fromDer(e,t)).tagClass!==ua.Class.UNIVERSAL||e.type!==ua.Type.SEQUENCE||!0!==e.constructed)throw new Error("PKCS#12 SafeContents expected to be a SEQUENCE OF SafeBag.");for(var n=[],a=0;a<e.value.length;a++){var i=e.value[a],s={},o=[];if(!ua.validate(i,pa,s,o))throw(h=new Error("Cannot read SafeBag.")).errors=o,h;var u,c,l={type:ua.derToOid(s.bagId),attributes:Ca(s.bagAttributes)};n.push(l);var f=s.bagValue.value[0];switch(l.type){case ca.oids.pkcs8ShroudedKeyBag:if(null===(f=ca.decryptPrivateKeyInfo(f,r)))throw new Error("Unable to decrypt PKCS#8 ShroudedKeyBag, wrong password?");case ca.oids.keyBag:try{l.key=ca.privateKeyFromAsn1(f)}catch(p){l.key=null,l.asn1=f}continue;case ca.oids.certBag:u=ya,c=function(){if(ua.derToOid(s.certId)!==ca.oids.x509Certificate){var e=new Error("Unsupported certificate type, only X.509 supported.");throw e.oid=ua.derToOid(s.certId),e}var r=ua.fromDer(s.cert,t);try{l.cert=ca.certificateFromAsn1(r,!0)}catch(p){l.cert=null,l.asn1=r}};break;default:var h;throw(h=new Error("Unsupported PKCS#12 SafeBag type.")).oid=l.type,h}if(void 0!==u&&!ua.validate(f,u,s,o))throw(h=new Error("Cannot read PKCS#12 "+u.name)).errors=o,h;c()}return n}function Ca(e){var t={};if(void 0!==e)for(var r=0;r<e.length;++r){var n={},a=[];if(!ua.validate(e[r],da,n,a)){var i=new Error("Cannot read PKCS#12 BagAttribute.");throw i.errors=a,i}var s=ua.derToOid(n.oid);if(void 0!==ca.oids[s]){t[ca.oids[s]]=[];for(var o=0;o<n.values.length;++o)t[ca.oids[s]].push(n.values[o].value)}}return t}la.pkcs12FromAsn1=function(e,t,r){"string"==typeof t?(r=t,t=!0):void 0===t&&(t=!0);var n={};if(!ua.validate(e,ha,n,[]))throw(a=new Error("Cannot read PKCS#12 PFX. ASN.1 object is not an PKCS#12 PFX.")).errors=a,a;var a,i={version:n.version.charCodeAt(0),safeContents:[],getBags:function(e){var t,r={};return"localKeyId"in e?t=e.localKeyId:"localKeyIdHex"in e&&(t=c.util.hexToBytes(e.localKeyIdHex)),void 0===t&&!("friendlyName"in e)&&"bagType"in e&&(r[e.bagType]=ga(i.safeContents,null,null,e.bagType)),void 0!==t&&(r.localKeyId=ga(i.safeContents,"localKeyId",t,e.bagType)),"friendlyName"in e&&(r.friendlyName=ga(i.safeContents,"friendlyName",e.friendlyName,e.bagType)),r},getBagsByFriendlyName:function(e,t){return ga(i.safeContents,"friendlyName",e,t)},getBagsByLocalKeyId:function(e,t){return ga(i.safeContents,"localKeyId",e,t)}};if(3!==n.version.charCodeAt(0))throw(a=new Error("PKCS#12 PFX of version other than 3 not supported.")).version=n.version.charCodeAt(0),a;if(ua.derToOid(n.contentType)!==ca.oids.data)throw(a=new Error("Only PKCS#12 PFX in password integrity mode supported.")).oid=ua.derToOid(n.contentType),a;var s=n.content.value[0];if(s.tagClass!==ua.Class.UNIVERSAL||s.type!==ua.Type.OCTETSTRING)throw new Error("PKCS#12 authSafe content data is not an OCTET STRING.");if(s=ma(s),n.mac){var o=null,u=0,l=ua.derToOid(n.macAlgorithm);switch(l){case ca.oids.sha1:o=c.md.sha1.create(),u=20;break;case ca.oids.sha256:o=c.md.sha256.create(),u=32;break;case ca.oids.sha384:o=c.md.sha384.create(),u=48;break;case ca.oids.sha512:o=c.md.sha512.create(),u=64;break;case ca.oids.md5:o=c.md.md5.create(),u=16}if(null===o)throw new Error("PKCS#12 uses unsupported MAC algorithm: "+l);var f=new c.util.ByteBuffer(n.macSalt),h="macIterations"in n?parseInt(c.util.bytesToHex(n.macIterations),16):1,p=la.generateKey(r,f,3,h,u,o),d=c.hmac.create();if(d.start(o,p),d.update(s.value),d.getMac().getBytes()!==n.macDigest)throw new Error("PKCS#12 MAC could not be verified. Invalid password?")}return function(e,t,r,n){if((t=ua.fromDer(t,r)).tagClass!==ua.Class.UNIVERSAL||t.type!==ua.Type.SEQUENCE||!0!==t.constructed)throw new Error("PKCS#12 AuthenticatedSafe expected to be a SEQUENCE OF ContentInfo");for(var a=0;a<t.value.length;a++){var i=t.value[a],s={},o=[];if(!ua.validate(i,fa,s,o))throw(f=new Error("Cannot read ContentInfo.")).errors=o,f;var u={encrypted:!1},c=null,l=s.content.value[0];switch(ua.derToOid(s.contentType)){case ca.oids.data:if(l.tagClass!==ua.Class.UNIVERSAL||l.type!==ua.Type.OCTETSTRING)throw new Error("PKCS#12 SafeContents Data is not an OCTET STRING.");c=ma(l).value;break;case ca.oids.encryptedData:c=va(l,n),u.encrypted=!0;break;default:var f;throw(f=new Error("Unsupported PKCS#12 contentType.")).contentType=ua.derToOid(s.contentType),f}u.safeBags=Ea(c,r,n),e.safeContents.push(u)}}(i,s.value,t,r),i},la.toPkcs12Asn1=function(e,t,r,n){(n=n||{}).saltSize=n.saltSize||8,n.count=n.count||2048,n.algorithm=n.algorithm||n.encAlgorithm||"aes128","useMac"in n||(n.useMac=!0),"localKeyId"in n||(n.localKeyId=null),"generateLocalKeyId"in n||(n.generateLocalKeyId=!0);var a,i=n.localKeyId;if(null!==i)i=c.util.hexToBytes(i);else if(n.generateLocalKeyId)if(t){var s=c.util.isArray(t)?t[0]:t;"string"==typeof s&&(s=ca.certificateFromPem(s)),(I=c.md.sha1.create()).update(ua.toDer(ca.certificateToAsn1(s)).getBytes()),i=I.digest().getBytes()}else i=c.random.getBytes(20);var o=[];null!==i&&o.push(ua.create(ua.Class.UNIVERSAL,ua.Type.SEQUENCE,!0,[ua.create(ua.Class.UNIVERSAL,ua.Type.OID,!1,ua.oidToDer(ca.oids.localKeyId).getBytes()),ua.create(ua.Class.UNIVERSAL,ua.Type.SET,!0,[ua.create(ua.Class.UNIVERSAL,ua.Type.OCTETSTRING,!1,i)])])),"friendlyName"in n&&o.push(ua.create(ua.Class.UNIVERSAL,ua.Type.SEQUENCE,!0,[ua.create(ua.Class.UNIVERSAL,ua.Type.OID,!1,ua.oidToDer(ca.oids.friendlyName).getBytes()),ua.create(ua.Class.UNIVERSAL,ua.Type.SET,!0,[ua.create(ua.Class.UNIVERSAL,ua.Type.BMPSTRING,!1,n.friendlyName)])])),o.length>0&&(a=ua.create(ua.Class.UNIVERSAL,ua.Type.SET,!0,o));var u=[],l=[];null!==t&&(l=c.util.isArray(t)?t:[t]);for(var f=[],h=0;h<l.length;++h){"string"==typeof(t=l[h])&&(t=ca.certificateFromPem(t));var p=0===h?a:void 0,d=ca.certificateToAsn1(t),y=ua.create(ua.Class.UNIVERSAL,ua.Type.SEQUENCE,!0,[ua.create(ua.Class.UNIVERSAL,ua.Type.OID,!1,ua.oidToDer(ca.oids.certBag).getBytes()),ua.create(ua.Class.CONTEXT_SPECIFIC,0,!0,[ua.create(ua.Class.UNIVERSAL,ua.Type.SEQUENCE,!0,[ua.create(ua.Class.UNIVERSAL,ua.Type.OID,!1,ua.oidToDer(ca.oids.x509Certificate).getBytes()),ua.create(ua.Class.CONTEXT_SPECIFIC,0,!0,[ua.create(ua.Class.UNIVERSAL,ua.Type.OCTETSTRING,!1,ua.toDer(d).getBytes())])])]),p]);f.push(y)}if(f.length>0){var g=ua.create(ua.Class.UNIVERSAL,ua.Type.SEQUENCE,!0,f),m=ua.create(ua.Class.UNIVERSAL,ua.Type.SEQUENCE,!0,[ua.create(ua.Class.UNIVERSAL,ua.Type.OID,!1,ua.oidToDer(ca.oids.data).getBytes()),ua.create(ua.Class.CONTEXT_SPECIFIC,0,!0,[ua.create(ua.Class.UNIVERSAL,ua.Type.OCTETSTRING,!1,ua.toDer(g).getBytes())])]);u.push(m)}var v=null;if(null!==e){var E=ca.wrapRsaPrivateKey(ca.privateKeyToAsn1(e));v=null===r?ua.create(ua.Class.UNIVERSAL,ua.Type.SEQUENCE,!0,[ua.create(ua.Class.UNIVERSAL,ua.Type.OID,!1,ua.oidToDer(ca.oids.keyBag).getBytes()),ua.create(ua.Class.CONTEXT_SPECIFIC,0,!0,[E]),a]):ua.create(ua.Class.UNIVERSAL,ua.Type.SEQUENCE,!0,[ua.create(ua.Class.UNIVERSAL,ua.Type.OID,!1,ua.oidToDer(ca.oids.pkcs8ShroudedKeyBag).getBytes()),ua.create(ua.Class.CONTEXT_SPECIFIC,0,!0,[ca.encryptPrivateKeyInfo(E,r,n)]),a]);var C=ua.create(ua.Class.UNIVERSAL,ua.Type.SEQUENCE,!0,[v]),b=ua.create(ua.Class.UNIVERSAL,ua.Type.SEQUENCE,!0,[ua.create(ua.Class.UNIVERSAL,ua.Type.OID,!1,ua.oidToDer(ca.oids.data).getBytes()),ua.create(ua.Class.CONTEXT_SPECIFIC,0,!0,[ua.create(ua.Class.UNIVERSAL,ua.Type.OCTETSTRING,!1,ua.toDer(C).getBytes())])]);u.push(b)}var S,T=ua.create(ua.Class.UNIVERSAL,ua.Type.SEQUENCE,!0,u);if(n.useMac){var I=c.md.sha1.create(),A=new c.util.ByteBuffer(c.random.getBytes(n.saltSize)),w=n.count,B=(e=la.generateKey(r,A,3,w,20),c.hmac.create());B.start(I,e),B.update(ua.toDer(T).getBytes());var N=B.getMac();S=ua.create(ua.Class.UNIVERSAL,ua.Type.SEQUENCE,!0,[ua.create(ua.Class.UNIVERSAL,ua.Type.SEQUENCE,!0,[ua.create(ua.Class.UNIVERSAL,ua.Type.SEQUENCE,!0,[ua.create(ua.Class.UNIVERSAL,ua.Type.OID,!1,ua.oidToDer(ca.oids.sha1).getBytes()),ua.create(ua.Class.UNIVERSAL,ua.Type.NULL,!1,"")]),ua.create(ua.Class.UNIVERSAL,ua.Type.OCTETSTRING,!1,N.getBytes())]),ua.create(ua.Class.UNIVERSAL,ua.Type.OCTETSTRING,!1,A.getBytes()),ua.create(ua.Class.UNIVERSAL,ua.Type.INTEGER,!1,ua.integerToDer(w).getBytes())])}return ua.create(ua.Class.UNIVERSAL,ua.Type.SEQUENCE,!0,[ua.create(ua.Class.UNIVERSAL,ua.Type.INTEGER,!1,ua.integerToDer(3).getBytes()),ua.create(ua.Class.UNIVERSAL,ua.Type.SEQUENCE,!0,[ua.create(ua.Class.UNIVERSAL,ua.Type.OID,!1,ua.oidToDer(ca.oids.data).getBytes()),ua.create(ua.Class.CONTEXT_SPECIFIC,0,!0,[ua.create(ua.Class.UNIVERSAL,ua.Type.OCTETSTRING,!1,ua.toDer(T).getBytes())])]),S])},la.generateKey=c.pbe.generatePkcs12Key;var ba,Sa=c.asn1,Ta=ba=c.pki=c.pki||{};Ta.pemToDer=function(e){var t=c.pem.decode(e)[0];if(t.procType&&"ENCRYPTED"===t.procType.type)throw new Error("Could not convert PEM to DER; PEM is encrypted.");return c.util.createBuffer(t.body)},Ta.privateKeyFromPem=function(e){var t=c.pem.decode(e)[0];if("PRIVATE KEY"!==t.type&&"RSA PRIVATE KEY"!==t.type){var r=new Error('Could not convert private key from PEM; PEM header type is not "PRIVATE KEY" or "RSA PRIVATE KEY".');throw r.headerType=t.type,r}if(t.procType&&"ENCRYPTED"===t.procType.type)throw new Error("Could not convert private key from PEM; PEM is encrypted.");var n=Sa.fromDer(t.body);return Ta.privateKeyFromAsn1(n)},Ta.privateKeyToPem=function(e,t){var r={type:"RSA PRIVATE KEY",body:Sa.toDer(Ta.privateKeyToAsn1(e)).getBytes()};return c.pem.encode(r,{maxline:t})},Ta.privateKeyInfoToPem=function(e,t){var r={type:"PRIVATE KEY",body:Sa.toDer(e).getBytes()};return c.pem.encode(r,{maxline:t})};var Ia,Aa=Ia=c.md5=c.md5||{};c.md.md5=c.md.algorithms.md5=Aa,Aa.create=function(){Ra||function(){wa=String.fromCharCode(128),wa+=c.util.fillString(String.fromCharCode(0),64),Ba=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,1,6,11,0,5,10,15,4,9,14,3,8,13,2,7,12,5,8,11,14,1,4,7,10,13,0,3,6,9,12,15,2,0,7,14,5,12,3,10,1,8,15,6,13,4,11,2,9],Na=[7,12,17,22,7,12,17,22,7,12,17,22,7,12,17,22,5,9,14,20,5,9,14,20,5,9,14,20,5,9,14,20,4,11,16,23,4,11,16,23,4,11,16,23,4,11,16,23,6,10,15,21,6,10,15,21,6,10,15,21,6,10,15,21],ka=new Array(64);for(var e=0;e<64;++e)ka[e]=Math.floor(4294967296*Math.abs(Math.sin(e+1)));Ra=!0}();var e=null,t=c.util.createBuffer(),r=new Array(16),n={algorithm:"md5",blockLength:64,digestLength:16,messageLength:0,fullMessageLength:null,messageLengthSize:8,start:function(){n.messageLength=0,n.fullMessageLength=n.messageLength64=[];for(var r=n.messageLengthSize/4,a=0;a<r;++a)n.fullMessageLength.push(0);return t=c.util.createBuffer(),e={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878},n}};return n.start(),n.update=function(a,i){"utf8"===i&&(a=c.util.encodeUtf8(a));var s=a.length;n.messageLength+=s,s=[s/4294967296>>>0,s>>>0];for(var o=n.fullMessageLength.length-1;o>=0;--o)n.fullMessageLength[o]+=s[1],s[1]=s[0]+(n.fullMessageLength[o]/4294967296>>>0),n.fullMessageLength[o]=n.fullMessageLength[o]>>>0,s[0]=s[1]/4294967296>>>0;return t.putBytes(a),Ua(e,r,t),(t.read>2048||0===t.length())&&t.compact(),n},n.digest=function(){var a=c.util.createBuffer();a.putBytes(t.bytes());var i=n.fullMessageLength[n.fullMessageLength.length-1]+n.messageLengthSize&n.blockLength-1;a.putBytes(wa.substr(0,n.blockLength-i));for(var s,o=0,u=n.fullMessageLength.length-1;u>=0;--u)o=(s=8*n.fullMessageLength[u]+o)/4294967296>>>0,a.putInt32Le(s>>>0);var l={h0:e.h0,h1:e.h1,h2:e.h2,h3:e.h3};Ua(l,r,a);var f=c.util.createBuffer();return f.putInt32Le(l.h0),f.putInt32Le(l.h1),f.putInt32Le(l.h2),f.putInt32Le(l.h3),f},n};var wa=null,Ba=null,Na=null,ka=null,Ra=!1;function Ua(e,t,r){for(var n,a,i,s,o,u,c,l=r.length();l>=64;){for(a=e.h0,i=e.h1,s=e.h2,o=e.h3,c=0;c<16;++c)t[c]=r.getInt32Le(),n=a+(o^i&(s^o))+ka[c]+t[c],a=o,o=s,s=i,i+=n<<(u=Na[c])|n>>>32-u;for(;c<32;++c)n=a+(s^o&(i^s))+ka[c]+t[Ba[c]],a=o,o=s,s=i,i+=n<<(u=Na[c])|n>>>32-u;for(;c<48;++c)n=a+(i^s^o)+ka[c]+t[Ba[c]],a=o,o=s,s=i,i+=n<<(u=Na[c])|n>>>32-u;for(;c<64;++c)n=a+(s^(i|~o))+ka[c]+t[Ba[c]],a=o,o=s,s=i,i+=n<<(u=Na[c])|n>>>32-u;e.h0=e.h0+a|0,e.h1=e.h1+i|0,e.h2=e.h2+s|0,e.h3=e.h3+o|0,l-=64}}var La={exports:{}};(function(e,t){!function(){"use strict";var r="input is invalid type",n="object"==typeof window,a=n?window:{};a.JS_SHA3_NO_WINDOW&&(n=!1);var i=!n&&"object"==typeof self;!a.JS_SHA3_NO_NODE_JS&&"object"==typeof e&&e.versions&&e.versions.node?a=t:i&&(a=self);var s=!a.JS_SHA3_NO_COMMON_JS&&La.exports,o="function"==typeof define&&define.amd,u=!a.JS_SHA3_NO_ARRAY_BUFFER&&"undefined"!=typeof ArrayBuffer,c="0123456789abcdef".split(""),l=[4,1024,262144,67108864],f=[0,8,16,24],h=[1,0,32898,0,32906,2147483648,2147516416,2147483648,32907,0,2147483649,0,2147516545,2147483648,32777,2147483648,138,0,136,0,2147516425,0,2147483658,0,2147516555,0,139,2147483648,32905,2147483648,32771,2147483648,32770,2147483648,128,2147483648,32778,0,2147483658,2147483648,2147516545,2147483648,32896,2147483648,2147483649,0,2147516424,2147483648],p=[224,256,384,512],d=[128,256],y=["hex","buffer","arrayBuffer","array","digest"],g={128:168,256:136};!a.JS_SHA3_NO_NODE_JS&&Array.isArray||(Array.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)}),!u||!a.JS_SHA3_NO_ARRAY_BUFFER_IS_VIEW&&ArrayBuffer.isView||(ArrayBuffer.isView=function(e){return"object"==typeof e&&e.buffer&&e.buffer.constructor===ArrayBuffer});for(var m=function(e,t,r){return function(n){return new L(e,t,e).update(n)[r]()}},v=function(e,t,r){return function(n,a){return new L(e,t,a).update(n)[r]()}},E=function(e,t,r){return function(t,n,a,i){return I["cshake"+e].update(t,n,a,i)[r]()}},C=function(e,t,r){return function(t,n,a,i){return I["kmac"+e].update(t,n,a,i)[r]()}},b=function(e,t,r,n){for(var a=0;a<y.length;++a){var i=y[a];e[i]=t(r,n,i)}return e},S=function(e,t){var r=m(e,t,"hex");return r.create=function(){return new L(e,t,e)},r.update=function(e){return r.create().update(e)},b(r,m,e,t)},T=[{name:"keccak",padding:[1,256,65536,16777216],bits:p,createMethod:S},{name:"sha3",padding:[6,1536,393216,100663296],bits:p,createMethod:S},{name:"shake",padding:[31,7936,2031616,520093696],bits:d,createMethod:function(e,t){var r=v(e,t,"hex");return r.create=function(r){return new L(e,t,r)},r.update=function(e,t){return r.create(t).update(e)},b(r,v,e,t)}},{name:"cshake",padding:l,bits:d,createMethod:function(e,t){var r=g[e],n=E(e,0,"hex");return n.create=function(n,a,i){return a||i?new L(e,t,n).bytepad([a,i],r):I["shake"+e].create(n)},n.update=function(e,t,r,a){return n.create(t,r,a).update(e)},b(n,E,e,t)}},{name:"kmac",padding:l,bits:d,createMethod:function(e,t){var r=g[e],n=C(e,0,"hex");return n.create=function(n,a,i){return new _(e,t,a).bytepad(["KMAC",i],r).bytepad([n],r)},n.update=function(e,t,r,a){return n.create(e,r,a).update(t)},b(n,C,e,t)}}],I={},A=[],w=0;w<T.length;++w)for(var B=T[w],N=B.bits,k=0;k<N.length;++k){var R=B.name+"_"+N[k];if(A.push(R),I[R]=B.createMethod(N[k],B.padding),"sha3"!==B.name){var U=B.name+N[k];A.push(U),I[U]=I[R]}}function L(e,t,r){this.blocks=[],this.s=[],this.padding=t,this.outputBits=r,this.reset=!0,this.finalized=!1,this.block=0,this.start=0,this.blockCount=1600-(e<<1)>>5,this.byteCount=this.blockCount<<2,this.outputBlocks=r>>5,this.extraBytes=(31&r)>>3;for(var n=0;n<50;++n)this.s[n]=0}function _(e,t,r){L.call(this,e,t,r)}L.prototype.update=function(e){if(this.finalized)throw new Error("finalize already called");var t,n=typeof e;if("string"!==n){if("object"!==n)throw new Error(r);if(null===e)throw new Error(r);if(u&&e.constructor===ArrayBuffer)e=new Uint8Array(e);else if(!(Array.isArray(e)||u&&ArrayBuffer.isView(e)))throw new Error(r);t=!0}for(var a,i,s=this.blocks,o=this.byteCount,c=e.length,l=this.blockCount,h=0,p=this.s;h<c;){if(this.reset)for(this.reset=!1,s[0]=this.block,a=1;a<l+1;++a)s[a]=0;if(t)for(a=this.start;h<c&&a<o;++h)s[a>>2]|=e[h]<<f[3&a++];else for(a=this.start;h<c&&a<o;++h)(i=e.charCodeAt(h))<128?s[a>>2]|=i<<f[3&a++]:i<2048?(s[a>>2]|=(192|i>>6)<<f[3&a++],s[a>>2]|=(128|63&i)<<f[3&a++]):i<55296||i>=57344?(s[a>>2]|=(224|i>>12)<<f[3&a++],s[a>>2]|=(128|i>>6&63)<<f[3&a++],s[a>>2]|=(128|63&i)<<f[3&a++]):(i=65536+((1023&i)<<10|1023&e.charCodeAt(++h)),s[a>>2]|=(240|i>>18)<<f[3&a++],s[a>>2]|=(128|i>>12&63)<<f[3&a++],s[a>>2]|=(128|i>>6&63)<<f[3&a++],s[a>>2]|=(128|63&i)<<f[3&a++]);if(this.lastByteIndex=a,a>=o){for(this.start=a-o,this.block=s[l],a=0;a<l;++a)p[a]^=s[a];P(p),this.reset=!0}else this.start=a}return this},L.prototype.encode=function(e,t){var r=255&e,n=1,a=[r];for(r=255&(e>>=8);r>0;)a.unshift(r),r=255&(e>>=8),++n;return t?a.push(n):a.unshift(n),this.update(a),a.length},L.prototype.encodeString=function(e){var t,n=typeof e;if("string"!==n){if("object"!==n)throw new Error(r);if(null===e)throw new Error(r);if(u&&e.constructor===ArrayBuffer)e=new Uint8Array(e);else if(!(Array.isArray(e)||u&&ArrayBuffer.isView(e)))throw new Error(r);t=!0}var a=0,i=e.length;if(t)a=i;else for(var s=0;s<e.length;++s){var o=e.charCodeAt(s);o<128?a+=1:o<2048?a+=2:o<55296||o>=57344?a+=3:(o=65536+((1023&o)<<10|1023&e.charCodeAt(++s)),a+=4)}return a+=this.encode(8*a),this.update(e),a},L.prototype.bytepad=function(e,t){for(var r=this.encode(t),n=0;n<e.length;++n)r+=this.encodeString(e[n]);var a=t-r%t,i=[];return i.length=a,this.update(i),this},L.prototype.finalize=function(){if(!this.finalized){this.finalized=!0;var e=this.blocks,t=this.lastByteIndex,r=this.blockCount,n=this.s;if(e[t>>2]|=this.padding[3&t],this.lastByteIndex===this.byteCount)for(e[0]=e[r],t=1;t<r+1;++t)e[t]=0;for(e[r-1]|=2147483648,t=0;t<r;++t)n[t]^=e[t];P(n)}},L.prototype.toString=L.prototype.hex=function(){this.finalize();for(var e,t=this.blockCount,r=this.s,n=this.outputBlocks,a=this.extraBytes,i=0,s=0,o="";s<n;){for(i=0;i<t&&s<n;++i,++s)e=r[i],o+=c[e>>4&15]+c[15&e]+c[e>>12&15]+c[e>>8&15]+c[e>>20&15]+c[e>>16&15]+c[e>>28&15]+c[e>>24&15];s%t==0&&(P(r),i=0)}return a&&(e=r[i],o+=c[e>>4&15]+c[15&e],a>1&&(o+=c[e>>12&15]+c[e>>8&15]),a>2&&(o+=c[e>>20&15]+c[e>>16&15])),o},L.prototype.arrayBuffer=function(){this.finalize();var e,t=this.blockCount,r=this.s,n=this.outputBlocks,a=this.extraBytes,i=0,s=0,o=this.outputBits>>3;e=a?new ArrayBuffer(n+1<<2):new ArrayBuffer(o);for(var u=new Uint32Array(e);s<n;){for(i=0;i<t&&s<n;++i,++s)u[s]=r[i];s%t==0&&P(r)}return a&&(u[i]=r[i],e=e.slice(0,o)),e},L.prototype.buffer=L.prototype.arrayBuffer,L.prototype.digest=L.prototype.array=function(){this.finalize();for(var e,t,r=this.blockCount,n=this.s,a=this.outputBlocks,i=this.extraBytes,s=0,o=0,u=[];o<a;){for(s=0;s<r&&o<a;++s,++o)e=o<<2,t=n[s],u[e]=255&t,u[e+1]=t>>8&255,u[e+2]=t>>16&255,u[e+3]=t>>24&255;o%r==0&&P(n)}return i&&(e=o<<2,t=n[s],u[e]=255&t,i>1&&(u[e+1]=t>>8&255),i>2&&(u[e+2]=t>>16&255)),u},_.prototype=new L,_.prototype.finalize=function(){return this.encode(this.outputBits,!0),L.prototype.finalize.call(this)};var P=function(e){var t,r,n,a,i,s,o,u,c,l,f,p,d,y,g,m,v,E,C,b,S,T,I,A,w,B,N,k,R,U,L,_,P,D,O,V,K,x,M,j,F,z,q,G,Q,H,W,X,Y,Z,J,$,ee,te,re,ne,ae,ie,se,oe,ue,ce,le;for(n=0;n<48;n+=2)a=e[0]^e[10]^e[20]^e[30]^e[40],i=e[1]^e[11]^e[21]^e[31]^e[41],s=e[2]^e[12]^e[22]^e[32]^e[42],o=e[3]^e[13]^e[23]^e[33]^e[43],u=e[4]^e[14]^e[24]^e[34]^e[44],c=e[5]^e[15]^e[25]^e[35]^e[45],l=e[6]^e[16]^e[26]^e[36]^e[46],f=e[7]^e[17]^e[27]^e[37]^e[47],t=(p=e[8]^e[18]^e[28]^e[38]^e[48])^(s<<1|o>>>31),r=(d=e[9]^e[19]^e[29]^e[39]^e[49])^(o<<1|s>>>31),e[0]^=t,e[1]^=r,e[10]^=t,e[11]^=r,e[20]^=t,e[21]^=r,e[30]^=t,e[31]^=r,e[40]^=t,e[41]^=r,t=a^(u<<1|c>>>31),r=i^(c<<1|u>>>31),e[2]^=t,e[3]^=r,e[12]^=t,e[13]^=r,e[22]^=t,e[23]^=r,e[32]^=t,e[33]^=r,e[42]^=t,e[43]^=r,t=s^(l<<1|f>>>31),r=o^(f<<1|l>>>31),e[4]^=t,e[5]^=r,e[14]^=t,e[15]^=r,e[24]^=t,e[25]^=r,e[34]^=t,e[35]^=r,e[44]^=t,e[45]^=r,t=u^(p<<1|d>>>31),r=c^(d<<1|p>>>31),e[6]^=t,e[7]^=r,e[16]^=t,e[17]^=r,e[26]^=t,e[27]^=r,e[36]^=t,e[37]^=r,e[46]^=t,e[47]^=r,t=l^(a<<1|i>>>31),r=f^(i<<1|a>>>31),e[8]^=t,e[9]^=r,e[18]^=t,e[19]^=r,e[28]^=t,e[29]^=r,e[38]^=t,e[39]^=r,e[48]^=t,e[49]^=r,y=e[0],g=e[1],H=e[11]<<4|e[10]>>>28,W=e[10]<<4|e[11]>>>28,k=e[20]<<3|e[21]>>>29,R=e[21]<<3|e[20]>>>29,oe=e[31]<<9|e[30]>>>23,ue=e[30]<<9|e[31]>>>23,z=e[40]<<18|e[41]>>>14,q=e[41]<<18|e[40]>>>14,D=e[2]<<1|e[3]>>>31,O=e[3]<<1|e[2]>>>31,m=e[13]<<12|e[12]>>>20,v=e[12]<<12|e[13]>>>20,X=e[22]<<10|e[23]>>>22,Y=e[23]<<10|e[22]>>>22,U=e[33]<<13|e[32]>>>19,L=e[32]<<13|e[33]>>>19,ce=e[42]<<2|e[43]>>>30,le=e[43]<<2|e[42]>>>30,te=e[5]<<30|e[4]>>>2,re=e[4]<<30|e[5]>>>2,V=e[14]<<6|e[15]>>>26,K=e[15]<<6|e[14]>>>26,E=e[25]<<11|e[24]>>>21,C=e[24]<<11|e[25]>>>21,Z=e[34]<<15|e[35]>>>17,J=e[35]<<15|e[34]>>>17,_=e[45]<<29|e[44]>>>3,P=e[44]<<29|e[45]>>>3,A=e[6]<<28|e[7]>>>4,w=e[7]<<28|e[6]>>>4,ne=e[17]<<23|e[16]>>>9,ae=e[16]<<23|e[17]>>>9,x=e[26]<<25|e[27]>>>7,M=e[27]<<25|e[26]>>>7,b=e[36]<<21|e[37]>>>11,S=e[37]<<21|e[36]>>>11,$=e[47]<<24|e[46]>>>8,ee=e[46]<<24|e[47]>>>8,G=e[8]<<27|e[9]>>>5,Q=e[9]<<27|e[8]>>>5,B=e[18]<<20|e[19]>>>12,N=e[19]<<20|e[18]>>>12,ie=e[29]<<7|e[28]>>>25,se=e[28]<<7|e[29]>>>25,j=e[38]<<8|e[39]>>>24,F=e[39]<<8|e[38]>>>24,T=e[48]<<14|e[49]>>>18,I=e[49]<<14|e[48]>>>18,e[0]=y^~m&E,e[1]=g^~v&C,e[10]=A^~B&k,e[11]=w^~N&R,e[20]=D^~V&x,e[21]=O^~K&M,e[30]=G^~H&X,e[31]=Q^~W&Y,e[40]=te^~ne&ie,e[41]=re^~ae&se,e[2]=m^~E&b,e[3]=v^~C&S,e[12]=B^~k&U,e[13]=N^~R&L,e[22]=V^~x&j,e[23]=K^~M&F,e[32]=H^~X&Z,e[33]=W^~Y&J,e[42]=ne^~ie&oe,e[43]=ae^~se&ue,e[4]=E^~b&T,e[5]=C^~S&I,e[14]=k^~U&_,e[15]=R^~L&P,e[24]=x^~j&z,e[25]=M^~F&q,e[34]=X^~Z&$,e[35]=Y^~J&ee,e[44]=ie^~oe&ce,e[45]=se^~ue&le,e[6]=b^~T&y,e[7]=S^~I&g,e[16]=U^~_&A,e[17]=L^~P&w,e[26]=j^~z&D,e[27]=F^~q&O,e[36]=Z^~$&G,e[37]=J^~ee&Q,e[46]=oe^~ce&te,e[47]=ue^~le&re,e[8]=T^~y&m,e[9]=I^~g&v,e[18]=_^~A&B,e[19]=P^~w&N,e[28]=z^~D&V,e[29]=q^~O&K,e[38]=$^~G&H,e[39]=ee^~Q&W,e[48]=ce^~te&ne,e[49]=le^~re&ae,e[0]^=h[n],e[1]^=h[n+1]};if(s)La.exports=I;else{for(w=0;w<A.length;++w)a[A[w]]=I[A[w]];o&&define(function(){return I})}}()}).call(this,d,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{}),La=La.exports;var _a={},Pa=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))(function(a,i){function s(e){try{u(n.next(e))}catch(t){i(t)}}function o(e){try{u(n.throw(e))}catch(t){i(t)}}function u(e){e.done?a(e.value):new r(function(t){t(e.value)}).then(s,o)}u((n=n.apply(e,t||[])).next())})},Da=this&&this.__generator||function(e,t){var r,n,a,i,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:o(0),throw:o(1),return:o(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function o(i){return function(o){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(a=2&i[0]?n.return:i[0]?n.throw||((a=n.return)&&a.call(n),0):n.next)&&!(a=a.call(n,i[1])).done)return a;switch(n=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,n=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(a=(a=s.trys).length>0&&a[a.length-1])&&(6===i[0]||2===i[0])){s=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){s.label=i[1];break}if(6===i[0]&&s.label<a[1]){s.label=a[1],a=i;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(i);break}a[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(o){i=[6,o],n=0}finally{r=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,o])}}},Oa=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t},Va=this;Object.defineProperty(_a,"__esModule",{value:!0});var Ka=Oa(ba),xa=Oa(ne),Ma=Oa(Ia),ja=Oa(B),Fa=n({}),za=a({}),qa=Oa(La);Ka.oids.sha224="2.16.840.1.101.3.4.2.4",Ka.oids["2.16.840.1.101.3.4.2.4"]="sha224",Ka.oids["sha3-224"]="2.16.840.1.101.3.4.2.7",Ka.oids["2.16.840.1.101.3.4.2.7"]="sha3-224",Ka.oids["sha3-256"]="2.16.840.1.101.3.4.2.8",Ka.oids["2.16.840.1.101.3.4.2.8"]="sha3-256",Ka.oids["sha3-384"]="2.16.840.1.101.3.4.2.9",Ka.oids["2.16.840.1.101.3.4.2.9"]="sha3-384",Ka.oids["sha3-512"]="2.16.840.1.101.3.4.2.10",Ka.oids["2.16.840.1.101.3.4.2.10"]="sha3-512",_a.pemToBytes=function(e){return Fa.base64Decode(e.trim().split(/\r\n|\n/).slice(1,-1).join("").trim())};var Ga={rsaPrivateNonEncrypted:"RSA PRIVATE KEY",rsaPublic:"PUBLIC KEY"};_a.bytesToPem=function(e,t){var r="-----BEGIN "+Ga[t]+"-----\n",n="-----END "+Ga[t]+"-----\n",a=Fa.base64Encode(e);a.length%64!=0&&(a+=" ".repeat(64-a.length%64));for(var i=r,s=0;s<a.length/64;s++)i+=a.slice(64*s,64*(s+1))+"\n";return i+n},_a.rsaKeyPairSync=function(e,t){var r=Ka.rsa.generateKeyPair(e,t);return{rsaPrivate:_a.pemToBytes(Ka.privateKeyToPem(r.privateKey)),rsaPublic:_a.pemToBytes(Ka.publicKeyToPem(r.publicKey))}},_a.rsaKeyPair=function(e,t){return Pa(Va,void 0,void 0,function(){return Da(this,function(r){return[2,new Promise(function(r,n){Ka.rsa.generateKeyPair(e,t,function(e,t){e&&n(e),r({rsaPrivate:_a.pemToBytes(Ka.privateKeyToPem(t.privateKey)),rsaPublic:_a.pemToBytes(Ka.publicKeyToPem(t.publicKey))})})})]})})};var Qa=function(){function e(e,t){this.sha3Digest=e,this.algorithm=t}return e.makeCreator=function(t,r){return{create:function(){return new e(t.create(),r)}}},e.prototype.update=function(e,t){return this.sha3Digest.update(za.stringToBytes(e,null==t?"raw":t)),this},e.prototype.digest=function(){var e=Uint8Array.from(this.sha3Digest.digest());return ja.createBuffer(za.bytesToString(e,"raw"))},e}(),Ha={MD5:Ma,SHA1:xa.algorithms.sha1,SHA224:("SHA224",function(){throw new Error("Digest SHA224 is unsupported")}),SHA256:xa.algorithms.sha256,SHA384:xa.algorithms.sha384,SHA512:xa.algorithms.sha512,"SHA3-224":Qa.makeCreator(qa.sha3_224,"sha3-224"),"SHA3-256":Qa.makeCreator(qa.sha3_256,"sha3-256"),"SHA3-384":Qa.makeCreator(qa.sha3_384,"sha3-384"),"SHA3-512":Qa.makeCreator(qa.sha3_512,"sha3-512")};_a.rsaSign=function(e,t,r){void 0===r&&(r="SHA256");var n=_a.bytesToPem(e,"rsaPrivateNonEncrypted"),a=Ka.privateKeyFromPem(n),i=Ha[r].create();return i.update(za.bytesToString(t,"raw")),za.stringToBytes(a.sign(i),"raw")},_a.rsaVerify=function(e,t,r,n){void 0===n&&(n="SHA256");var a=Ka.publicKeyFromPem(_a.bytesToPem(e,"rsaPublic")),i=Ha[n].create();return i.update(za.bytesToString(t),"raw"),a.verify(i.digest().getBytes(),za.bytesToString(r,"raw"))};var Wa={},Xa=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t};Object.defineProperty(Wa,"__esModule",{value:!0});var Ya=a({}),Za=Xa(Ia),Ja=n({});function $a(e,t){for(void 0===t&&(t=5e3);t--;){var r=Ya.stringToBytes(e);e=Ja.base16Encode(Fe.sha256(r))}return e}function ei(e,t,r){void 0===r&&(r=48);for(var n=Ya.bytesToString(Xe.concat(e,t),"raw"),a="",i=a;i.length<r;)i+=a=Za.create().update(a+n).digest().getBytes();return i}Wa.encryptSeed=function(e,t,r){var n=$a(t,r),a=Ce.randomBytes(8),i=ei(Ya.stringToBytes(n,"raw"),a),s=Ya.stringToBytes(i.slice(0,32),"raw"),o=Ya.stringToBytes(i.slice(32),"raw"),u=Mt.aesEncrypt(Ya.stringToBytes(e),s,"CBC",o);return Ja.base64Encode(Xe.concat(Ya.stringToBytes("Salted__"),a,u))},Wa.decryptSeed=function(e,t,r){var n=$a(t,r),a=Ja.base64Decode(e),i=a.slice(8,16),s=ei(Ya.stringToBytes(n,"raw"),i),o=Ya.stringToBytes(s.slice(0,32),"raw"),u=Ya.stringToBytes(s.slice(32),"raw");return Ya.bytesToString(Mt.aesDecrypt(a.slice(16),o,"CBC",u))};var ti={},ri=this&&this.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,a,i=r.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)s.push(n.value)}catch(o){a={error:o}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(a)throw a.error}}return s};Object.defineProperty(ti,"__esModule",{value:!0}),ti.merkleVerify=function(e,t,r){var n=Uint8Array.from([0]),a=Uint8Array.from([1]);if(32!==e.length)throw new Error("Failed to parse merkleProof: Invalid rootHash length");for(var i=Fe.blake2b(Xe.concat(n,r)),s=[],o=t.map(function(e){return e});o.length>0;){var u=0===o[0]?"L":"R",c=o[1];if(c<1)throw new Error("Failed to parse merkleProof: Wrong hash size");var l=o.slice(2,2+c);s.push([u,l]),o=o.slice(2+c)}return s.reduce(function(e,t){var r=ri(t,2),n=r[0],i=r[1];return Fe.blake2b(Xe.concat(a,"R"===n?Xe.concat(i,e):Xe.concat(e,i)))},i).every(function(t,r){return t===e[r]})};var ni={},ai=this&&this.__assign||function(){return(ai=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var a in t=arguments[r])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},ii=this&&this.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,a,i=r.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)s.push(n.value)}catch(o){a={error:o}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(a)throw a.error}}return s},si=this&&this.__spread||function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(ii(arguments[t]));return e};Object.defineProperty(ni,"__esModule",{value:!0});var oi=n({}),ui=a({});ni.crypto=function(e){if(e&&""==e.seed)throw new Error("Empty seed is not allowed.");var t,r=function(e,t){return function(){for(var r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];return e.apply(void 0,si([t],r))}},n=function(t){return function(){for(var r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];var a=t.apply(void 0,si(r));return!e||e&&"Base58"===e.output?oi.base58Encode(a):a}},a=e&&e.seed?e.seed:void 0,i={seedWithNonce:a?r(Xt.seedWithNonce,a):Xt.seedWithNonce,signBytes:n(a?r($t.signBytes,a):$t.signBytes),keyPair:(t=a?r(Xt.keyPair,a):Xt.keyPair,function(){for(var r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];var a=t.apply(void 0,si(r));return!e||e&&"Base58"===e.output?{privateKey:oi.base58Encode(a.privateKey),publicKey:oi.base58Encode(a.publicKey)}:a}),publicKey:n(a?r(Xt.publicKey,a):Xt.publicKey),privateKey:n(a?r(Xt.privateKey,a):Xt.privateKey),address:n(a?r(Xt.address,a):Xt.address)};return ai({},i,{sharedKey:n(Mt.sharedKey),buildAddress:Xt.buildAddress,blake2b:Fe.blake2b,keccak:Fe.keccak,sha256:Fe.sha256,base64Encode:oi.base64Encode,base64Decode:oi.base64Decode,base58Encode:oi.base58Encode,base58Decode:oi.base58Decode,base16Encode:oi.base16Encode,base16Decode:oi.base16Decode,stringToBytes:ui.stringToBytes,bytesToString:ui.bytesToString,random:Ce.random,randomSeed:Ce.randomSeed,randomBytes:Ce.randomBytes,verifySignature:nr.verifySignature,verifyPublicKey:nr.verifyPublicKey,verifyAddress:nr.verifyAddress,messageDecrypt:Mt.messageDecrypt,messageEncrypt:Mt.messageEncrypt,aesDecrypt:Mt.aesDecrypt,aesEncrypt:Mt.aesEncrypt,encryptSeed:Wa.encryptSeed,decryptSeed:Wa.decryptSeed,rsaKeyPair:_a.rsaKeyPair,rsaKeyPairSync:_a.rsaKeyPairSync,rsaSign:_a.rsaSign,rsaVerify:_a.rsaVerify,merkleVerify:ti.merkleVerify,split:Xe.split,concat:Xe.concat})};var ci,li={};Object.defineProperty(li,"__esModule",{value:!0}),li.seedWordsList=s.seedWordsList,li.ChaidId=u.ChaidId,li.Seed=D.Seed,li.isPrivateKey=K.isPrivateKey,li.isPublicKey=K.isPublicKey,li.crypto=ni.crypto,function(e){for(var t in e)li.hasOwnProperty(t)||(li[t]=e[t])}(o),li.signBytes=(ci=ni.crypto({output:"Base58"})).signBytes,li.keyPair=ci.keyPair,li.publicKey=ci.publicKey,li.privateKey=ci.privateKey,li.address=ci.address,li.buildAddress=ci.buildAddress,li.blake2b=ci.blake2b,li.keccak=ci.keccak,li.sha256=ci.sha256,li.sharedKey=ci.sharedKey,li.seedWithNonce=ci.seedWithNonce,li.base64Encode=ci.base64Encode,li.base64Decode=ci.base64Decode,li.base58Encode=ci.base58Encode,li.base58Decode=ci.base58Decode,li.base16Encode=ci.base16Encode,li.base16Decode=ci.base16Decode,li.stringToBytes=ci.stringToBytes,li.bytesToString=ci.bytesToString,li.random=ci.random,li.randomSeed=ci.randomSeed,li.randomBytes=ci.randomBytes,li.verifySignature=ci.verifySignature,li.verifyPublicKey=ci.verifyPublicKey,li.verifyAddress=ci.verifyAddress,li.messageDecrypt=ci.messageDecrypt,li.messageEncrypt=ci.messageEncrypt,li.aesDecrypt=ci.aesDecrypt,li.aesEncrypt=ci.aesEncrypt,li.encryptSeed=ci.encryptSeed,li.decryptSeed=ci.decryptSeed,li.rsaKeyPair=ci.rsaKeyPair,li.rsaKeyPairSync=ci.rsaKeyPairSync,li.rsaSign=ci.rsaSign,li.rsaVerify=ci.rsaVerify,li.merkleVerify=ci.merkleVerify,li.split=ci.split,li.concat=ci.concat;const{address:fi}=li,hi=document.getElementById("myForm");hi.addEventListener("submit",e=>{e.preventDefault();const t=hi.elements[0].value;document.getElementById("data").innerHTML+='<label for="data">Address:</label>'+fi(t)})}();